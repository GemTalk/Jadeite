| package |
package := Package name: 'Rowan UI Base'.
package paxVersion: 1;
	basicComment: 'Jadeite GUI tools built on Jade Smalltalk for Dolphin. '.

package imageStripperBytes: (ByteArray fromBase64String: 'IVNUQiA0IEYPEQAEAAAASmFkZUltYWdlU3RyaXBwZXIAAAAAAAAAAFIAAAAAAAAAmgAAAFIAAAAQ
AAAARG9scGhpbiBNVlAgQmFzZVIAAAAVAAAAUnVudGltZVNlc3Npb25NYW5hZ2Vy778lAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=').

package classNames
	add: #BrowserUpdate;
	add: #JadeFindClassDialog;
	add: #JadeFindDialog;
	add: #JadeiteAdvancedFindDialog;
	add: #JadeiteBasicMethodListPresenter;
	add: #JadeiteBasicRenameClassMethodListPresenter;
	add: #JadeiteBrowser;
	add: #JadeiteBrowserPresenter;
	add: #JadeiteChangesBrowser;
	add: #JadeiteDebugger;
	add: #JadeiteDebuggerMethodSourcePresenter;
	add: #JadeiteDiffBrowser;
	add: #JadeiteFindClassDialog;
	add: #JadeiteFindMethodDialog;
	add: #JadeiteGitLog;
	add: #JadeiteInspector;
	add: #JadeiteLogger;
	add: #JadeiteLoggerPresenter;
	add: #JadeiteLoggerShell;
	add: #JadeiteLoginShell;
	add: #JadeiteMethodHistoryBrowser;
	add: #JadeiteMethodListBrowser;
	add: #JadeiteMethodListPresenter;
	add: #JadeiteMethodSourcePresenter;
	add: #JadeiteMultilinePrompter;
	add: #JadeitePreferences;
	add: #JadeitePreferencesPresenter;
	add: #JadeitePreferencesShell;
	add: #JadeitePreferencesWorkspace;
	add: #JadeiteProjectListBrowser;
	add: #JadeiteProjectListPresenter;
	add: #JadeiteProjectsBrowserPresenter;
	add: #JadeiteProjectsSystemBrowser;
	add: #JadeiteRenameClassMethodListBrowser;
	add: #JadeiteRenameClassMethodListPresenter;
	add: #JadeiteScintillaView;
	add: #JadeiteSearch;
	add: #JadeiteSemaphore;
	add: #JadeiteSmalltalkSearchPresenter;
	add: #JadeiteSmalltalkWorkspace;
	add: #JadeiteTranscript;
	add: #PackageMethodListPresenter;
	add: #Rowan;
	add: #RowanAnsweringService;
	add: #RowanAutoCommitService;
	add: #RowanBrowserService;
	add: #RowanClassCategoryUpdate;
	add: #RowanClassesUpdate;
	add: #RowanClassHierarchyUpdate;
	add: #RowanClassInfoUpdate;
	add: #RowanClassService;
	add: #RowanDebuggerService;
	add: #RowanDebuggerStepPointError;
	add: #RowanDictionaryService;
	add: #RowanDictionaryUpdate;
	add: #RowanFrameService;
	add: #RowanGlobalsUpdate;
	add: #RowanInspectorService;
	add: #RowanKeyValuePrompter;
	add: #RowanLoggingService;
	add: #RowanMethodListBrowser;
	add: #RowanMethodListPresenter;
	add: #RowanMethodSelectionPresenter;
	add: #RowanMethodService;
	add: #RowanMethodSourcePresenter;
	add: #RowanMethodsUpdate;
	add: #RowanMethodUpdate;
	add: #RowanPackagePresenter;
	add: #RowanPackageService;
	add: #RowanPackageShell;
	add: #RowanPackageUpdate;
	add: #RowanPresenter;
	add: #RowanProcessService;
	add: #RowanProjectService;
	add: #RowanProjectsUpdate;
	add: #RowanQueryService;
	add: #RowanSavePackageDialog;
	add: #RowanService;
	add: #RowanShell;
	add: #RowanSuperclassUpdate;
	add: #RowanSystemBrowser;
	add: #RowanSystemBrowserPresenter;
	add: #RowanVariableService;
	add: #TestChoicePrompter;
	yourself.

package methodNames
	add: #CodeSourcePresenter -> #browseSelectedClass;
	add: #CodeSourcePresenter -> #currentSelection;
	add: #CodeSourcePresenter -> #executeSelectionOrLine;
	add: #CodeSourcePresenter -> #inspectorContextObject;
	add: #CodeSourcePresenter -> #jadeInspect;
	add: #CodeSourcePresenter -> #methodMenuBreak:;
	add: #Collection -> #basicPrepareForReplication;
	add: #Collection -> #prepareForReplication;
	add: #DiffBrowser -> #diffsPresenter;
	add: #Float -> #asString;
	add: #GciSession -> #_executeString:fromContextOop:environment:;
	add: #GciSession -> #clientServerVersionRelationship;
	add: #GciSession -> #computeGemHost;
	add: #GciSession -> #computeStoneHost;
	add: #GciSession -> #confirmMessageBox:;
	add: #GciSession -> #executeString:;
	add: #GciSession -> #executeString:fromContext:environment:;
	add: #GciSession -> #gemNRS;
	add: #GciSession -> #hasServer;
	add: #GciSession -> #informMessageBox:;
	add: #GciSession -> #initializeServer;
	add: #GciSession -> #inspectServerObject:;
	add: #GciSession -> #oopTypeFor:;
	add: #GciSession -> #postLoadClientPreferences;
	add: #GciSession -> #postLoadServerPreferences;
	add: #GciSession -> #postLoginAs:useSocket:;
	add: #GciSession -> #preferencesFile;
	add: #GciSession -> #serverPerform:withArguments:;
	add: #GciSession -> #terminate:;
	add: #GciSession -> #titleBarFor:;
	add: #GciSession -> #verifyRowanLoaded;
	add: #GciSession -> #withExplanation:do:;
	add: #GciSession -> #withExplanation:doA:;
	add: #GsError -> #debugError;
	add: #GsMethod -> #className;
	add: #GsMethod -> #meta;
	add: #GsMethod -> #methodService;
	add: #GsProcess -> #oop;
	add: #JadeAutoSystemBrowserPresenter -> #methodMenuBreak:;
	add: #JadeAutoTextPresenter3 -> #defaultMethod;
	add: #JadeAutoTextPresenter3 -> #setDefaultMethod;
	add: #JadeDebugger -> #gsProcess;
	add: #JadeDebugger -> #gsProcess:;
	add: #JadeDebugger -> #initializeProcess:message:terminateOnClose:;
	add: #JadeDebugger -> #onViewClosed;
	add: #JadeDebugger -> #resumeProcess;
	add: #JadeDebugger -> #selectedFrameWithErrorHandling;
	add: #JadeDebugger -> #selectedProcess;
	add: #JadeDebugger -> #stack:;
	add: #JadeDebugger -> #update;
	add: #JadeDebugger -> #updateCaption;
	add: #JadeErrorShell -> #doCopy;
	add: #JadeErrorShell -> #onViewOpened;
	add: #JadeFileIn -> #defineMethod:inClassNamed:inPackageNamed:inCategory:;
	add: #JadeImageStripper -> #closeLoginShells;
	add: #JadeImageStripper -> #createVersionResource;
	add: #JadeImageStripper -> #requiredClasses;
	add: #JadeImageStripper -> #requiredPackageNames;
	add: #JadeInspector -> #displayError:;
	add: #JadeInspector -> #displayInstVarError:instVar:;
	add: #JadeInspector -> #displaySpecials;
	add: #JadeInspector -> #displayUndisplayableCharacter;
	add: #JadeInspector -> #onViewClosed;
	add: #JadeInspector -> #onViewOpened;
	add: #JadeInspector -> #printInstVar;
	add: #JadeInspector -> #saveDocument;
	add: #JadeInspector -> #selectedInstVar;
	add: #JadeInspector -> #setDocumentPresenterLabel;
	add: #JadeInspector -> #setLastGsShape:;
	add: #JadeInspector -> #shellName;
	add: #JadeInspector -> #shellNameExtraInfo;
	add: #JadeInspector -> #updateCaption;
	add: #JadeiteSUnitAbstractPresenter -> #methodListPresenter;
	add: #JadeiteSUnitAbstractPresenter -> #methodListPresenter:;
	add: #JadeiteSUnitInClassPresenter -> #registerPresentersForUpdates;
	add: #JadeiteSUnitInClassPresenter -> #testClassService;
	add: #JadeiteSUnitInClassPresenter -> #testClassService:;
	add: #JadeiteSUnitPresenter -> #browseClass;
	add: #JadeiteSUnitPresenter -> #browseMethods;
	add: #JadeiteSUnitPresenter -> #classListPresenter;
	add: #JadeiteSUnitPresenter -> #methodListPresenter;
	add: #JadeiteSUnitPresenter -> #onViewClosed;
	add: #JadeiteSUnitPresenter -> #onViewOpened;
	add: #JadeiteSUnitPresenter -> #packageListPresenter;
	add: #JadeiteSUnitPresenter -> #queryCommand:;
	add: #JadeiteSUnitPresenter -> #refresh;
	add: #JadeiteSUnitPresenter -> #registerPresentersForUpdates;
	add: #JadeiteSUnitPresenter -> #update:orRemove:;
	add: #JadeiteSUnitPresenter -> #updateClasses;
	add: #JadeiteSUnitPresenter -> #updateMethods;
	add: #JadeiteSUnitPresenter -> #updateMethodsFrom:;
	add: #JadeiteSUnitPresenter -> #updatePackages;
	add: #JadeLoginShell -> #aboutJadeite;
	add: #JadeMethodListPresenter -> #newProjectsBrowser;
	add: #JadeMethodListPresenter -> #newWorkspace;
	add: #JadeMethodListPresenter -> #searchForAnyTextMatching:;
	add: #JadeNavigationInspector -> #browseClass;
	add: #JadeNavigationInspector -> #setNewInspectedObject;
	add: #JadePresenter -> #abortTransaction;
	add: #JadePresenter -> #autoCommitExecutionString;
	add: #JadePresenter -> #basicCloneProject:root:;
	add: #JadePresenter -> #browseBreakpoints;
	add: #JadePresenter -> #browseClassReferences:;
	add: #JadePresenter -> #browseHierarchyImplementorsOf:className:;
	add: #JadePresenter -> #browseHierarchySendersOf:className:;
	add: #JadePresenter -> #browseImplementorsOf;
	add: #JadePresenter -> #browseImplementorsOf:;
	add: #JadePresenter -> #browseLiteralReferences;
	add: #JadePresenter -> #browseMethodsContaining;
	add: #JadePresenter -> #browseSelectedClassIn:newTab:;
	add: #JadePresenter -> #browseSendersOf;
	add: #JadePresenter -> #browseSendersOf:;
	add: #JadePresenter -> #clearAllBreaks;
	add: #JadePresenter -> #clearMethodBreakpoints:;
	add: #JadePresenter -> #compilationWarningFrom:;
	add: #JadePresenter -> #currentMethodSourceFrom:;
	add: #JadePresenter -> #currentSelectionOrLine;
	add: #JadePresenter -> #displayNoMods:;
	add: #JadePresenter -> #displayUncompilableSourceIn:;
	add: #JadePresenter -> #editSaveMethod:in:category:;
	add: #JadePresenter -> #executeSelectionOrLine:;
	add: #JadePresenter -> #flipAutoCommit;
	add: #JadePresenter -> #insertCompileErrorText:into:;
	add: #JadePresenter -> #issueCommand:;
	add: #JadePresenter -> #openBrowserInNewTab:on:;
	add: #JadePresenter -> #openProjectBrowserOn:selector:;
	add: #JadePresenter -> #raiseConsole;
	add: #JadePresenter -> #refreshGlobalSelections;
	add: #JadePresenter -> #remoteAutoCommit;
	add: #JadePresenter -> #reportCompileError:in:;
	add: #JadePresenter -> #selectionRangeFrom:source:;
	add: #JadePresenter -> #serviceFromSelection:;
	add: #JadePresenter -> #setCompileErrorColor;
	add: #JadePresenter -> #setCompileWarningColor;
	add: #JadePresenter -> #update:afterStonReplication:;
	add: #JadePresenter -> #updateServices:;
	add: #JadePresenterA -> #clearBreakPointAt:in:;
	add: #JadePresenterA -> #cloneProject;
	add: #JadePresenterA -> #confirmReloadProjects:;
	add: #JadePresenterA -> #isOkayToChangeSource:;
	add: #JadePresenterA -> #loadProjectsFrom:;
	add: #JadePresenterA -> #methodListSelection;
	add: #JadePresenterA -> #openMethodListOn:selecting:;
	add: #JadePresenterA -> #openMethodListOn:selectingAnyMatch:;
	add: #JadePresenterA -> #queryCommand:;
	add: #JadePresenterA -> #refreshBreakPointsIn:;
	add: #JadePresenterA -> #removeSelectorsString:;
	add: #JadePresenterA -> #setBreakPointAt:in:;
	add: #JadePresenterA -> #updateMethodReferences:;
	add: #JadeProcessBrowser -> #debugProcess;
	add: #JadeServer -> #_describeMethod:;
	add: #JadeServer -> #sbAddPackage:;
	add: #JadeServer -> #sbChangesInPackage:;
	add: #JadeServer -> #sbClassTemplate;
	add: #JadeServer -> #sbRemoveClasses;
	add: #JadeServer -> #sbRemoveMethods:;
	add: #JadeServer -> #sbUnloadPackage:;
	add: #JadeServer -> #sbUpdateClassCategories;
	add: #JadeServer -> #sbUpdateClassHierarchy;
	add: #JadeServer -> #sbUpdateClassInfo;
	add: #JadeServer -> #sbUpdateClassList;
	add: #JadeServer -> #sbUpdateDictionaries;
	add: #JadeServer -> #sbUpdateMethodCategories;
	add: #JadeServer -> #sbUpdateMethods;
	add: #JadeServer -> #sbUpdateMethodVariables;
	add: #JadeServer -> #sbUpdatePackages;
	add: #JadeServer -> #sbUpdateSuperclass;
	add: #JadeServer -> #systemBrowserSTONA:;
	add: #JadeServer64bit -> #recompile:withSource:;
	add: #JadeServer64bit -> #systemBrowserSTON:;
	add: #JadeServer64bit3x -> #compileMethod:behavior:symbolList:inCategory:;
	add: #JadeServer64bit3x -> #sbClassComment:;
	add: #JadeServer64bit3x -> #sbUpdateMethodPragmas;
	add: #JadeShell -> #updateCaptionFromSearchString:;
	add: #JadeSystemBrowserPresenter -> #basicAddMethodCategory:;
	add: #JadeSystemBrowserPresenter -> #basicRemoveMethods;
	add: #JadeSystemBrowserPresenter -> #browseMethodsAndSelect:;
	add: #JadeSystemBrowserPresenter -> #browseMethodsAndSelect:type:;
	add: #JadeSystemBrowserPresenter -> #createSchematicWiring;
	add: #JadeSystemBrowserPresenter -> #createSchematicWiringForClassHierarchyTabs;
	add: #JadeSystemBrowserPresenter -> #currentMethodSource;
	add: #JadeSystemBrowserPresenter -> #editSaveClass;
	add: #JadeSystemBrowserPresenter -> #findClass;
	add: #JadeSystemBrowserPresenter -> #handleClassCompileError:;
	add: #JadeSystemBrowserPresenter -> #instanceClassTabs;
	add: #JadeSystemBrowserPresenter -> #instanceClassTabs:;
	add: #JadeSystemBrowserPresenter -> #methodsMenuStrings;
	add: #JadeSystemBrowserPresenter -> #methodSourceEqual;
	add: #JadeSystemBrowserPresenter -> #onViewOpened;
	add: #JadeSystemBrowserPresenter -> #packageTabName;
	add: #JadeSystemBrowserPresenter -> #postOkToChangeEvent;
	add: #JadeSystemBrowserPresenter -> #preRemoveMethods;
	add: #JadeSystemBrowserPresenter -> #queryCommand:;
	add: #JadeSystemBrowserPresenter -> #removeMethods;
	add: #JadeSystemBrowserPresenter -> #runClassTests;
	add: #JadeSystemBrowserPresenter -> #savePackage;
	add: #JadeSystemBrowserPresenter -> #selectorsString;
	add: #JadeSystemBrowserPresenter -> #updateClassHierarchy;
	add: #JadeSystemBrowserPresenter -> #updateClassList;
	add: #JadeSystemBrowserPresenter -> #updateMethod;
	add: #JadeSystemBrowserPresenter -> #updateSelector;
	add: #JadeSystemBrowserPresenter -> #verifyValidCategory:;
	add: #JadeTextDocument -> #aboutJadeite;
	add: #JadeTextDocument -> #executeSelectionOrLine:;
	add: #JadeTextDocument -> #issueCommand:;
	add: #JadeTextDocument -> #jadeExecuteAndDisplay:;
	add: #JadeTextDocument -> #onPromptToSaveChanges:;
	add: #JadeTextDocument -> #openDictionaryBrowser;
	add: #JadeTextDocument -> #openProjectsBrowser;
	add: #JadeTextDocument -> #raiseConsole;
	add: #JadeTextDocument -> #registerWindow:rootObject:;
	add: #JadeTextDocument -> #update:afterStonReplication:;
	add: #JadeTextDocument -> #updateServices:;
	add: #JadeToolsToolBarPresenter -> #browseClasses;
	add: #JadeToolsToolBarPresenter -> #jadePreferences;
	add: #JadeTranscript -> #methodsChanged24;
	add: #JadeTranscript -> #methodsChangedDays;
	add: #JadeTranscript -> #openRowanProjectList;
	add: #JadeTranscript -> #updateCaption;
	add: #JadeTreeMethodListPresenter -> #browseMethodsFromString:;
	add: #JadeTreeMethodListPresenter -> #browseMethodsFromString:methodName:;
	add: #JadeTreeMethodListPresenter -> #browseMethodsFromString:methodName:type:;
	add: #JadeTreeMethodListPresenter -> #onDropMethodsTree:;
	add: #JadeWorkspace -> #onViewClosed;
	add: #JadeWorkspace -> #onViewOpened;
	add: #ListModel -> #removeAtIndexWithoutNotification:;
	add: #ListPresenter -> #selectServiceStartingWith:;
	add: #MCAddition -> #revert:;
	add: #MCClassDefinition -> #initialize:;
	add: #MCDefinition -> #isMethodAddition;
	add: #MCDefinition -> #isMethodModification;
	add: #MCDefinition -> #isMethodRemoval;
	add: #MCDefinition -> #revert:;
	add: #MCMethodDefinition -> #basicClassName;
	add: #MCMethodDefinition -> #isMethodAddition;
	add: #MCMethodDefinition -> #isMethodModification;
	add: #MCMethodDefinition -> #isMethodRemoval;
	add: #MCMethodDefinition -> #revert:;
	add: #MCMethodDefinition -> #selector:;
	add: #MCModification -> #clearObsoletionMemo;
	add: #MCModification -> #isMethodModification;
	add: #MCModification -> #revert:;
	add: #MCPatchBrowser -> #browseChangedThing;
	add: #MCPatchBrowser -> #browseImplementors;
	add: #MCPatchBrowser -> #browseSenders;
	add: #MCPatchBrowser -> #operationSelected;
	add: #MCPatchOperation -> #canBeReverted;
	add: #MCPatchOperation -> #clearObsoletionMemo;
	add: #MCPatchOperation -> #isMethodAddition;
	add: #MCPatchOperation -> #isMethodModification;
	add: #MCPatchOperation -> #isMethodRemoval;
	add: #MCPatchOperation -> #revert:;
	add: #MCRemoval -> #isMethodRemoval;
	add: #MCRemoval -> #revert:;
	add: #MethodListPresenter -> #browseClass;
	add: #MethodListPresenter -> #selectedMethodsAreTestCases;
	add: #MethodSourcePresenter -> #editMenuStrings;
	add: #MethodSourcePresenter -> #editSaveMethod;
	add: #MethodSourcePresenter -> #fileSave;
	add: #MethodSourcePresenter -> #isOkayToChange;
	add: #MethodSourcePresenter -> #methodMenuBreak:;
	add: #MethodSourcePresenter -> #updateMethodSource;
	add: #MethodSourcePresenter -> #updateMethodStepPoints;
	add: #MultipleSelectionListBox -> #wmRButtonDown:wParam:lParam:;
	add: #Object -> #basicPrepareForReplication;
	add: #Object -> #isClassService;
	add: #Object -> #isMethodService;
	add: #Object -> #isPackageService;
	add: #Object -> #isProjectService;
	add: #Object -> #isUpdatableService;
	add: #Object -> #prepareForReplication;
	add: #Object -> #rowanFixMe;
	add: #ObjectLogBrowser -> #debug:;
	add: #Presenter -> #redrawAllViews;
	add: #Presenter -> #update:withSelector:;
	add: #Presenter -> #update:withSelector:browser:;
	add: #Presenter -> #updateReady:;
	add: #Presenter -> #updateSelectionsFor:;
	add: #Presenter -> #updateSelectionsForUpdate:;
	add: #ProcessorScheduler -> #userBreak:;
	add: #RowanCommandResult -> #autoCommitUpdate:;
	add: #RowanCommandResult -> #basicPrepareForReplication;
	add: #RowanCommandResult -> #classCategoryUpdate:;
	add: #RowanCommandResult -> #classCommentUpdate:;
	add: #RowanCommandResult -> #classDefinitionUpdate:;
	add: #RowanCommandResult -> #classesHierarchyUpdate:;
	add: #RowanCommandResult -> #classesUpdate:browser:;
	add: #RowanCommandResult -> #classHierarchyUpdate:;
	add: #RowanCommandResult -> #classHierarchyUpdate:browser:;
	add: #RowanCommandResult -> #classMethodsUpdate:browser:;
	add: #RowanCommandResult -> #classUpdate:;
	add: #RowanCommandResult -> #dictionaryListUpdate:;
	add: #RowanCommandResult -> #dictionaryUpdate:;
	add: #RowanCommandResult -> #filterUpdate:browser:;
	add: #RowanCommandResult -> #globalsUpdate:;
	add: #RowanCommandResult -> #methodFilterUpdate:;
	add: #RowanCommandResult -> #methodSourceUpdate:browser:;
	add: #RowanCommandResult -> #methodsUpdate:;
	add: #RowanCommandResult -> #methodUpdate:;
	add: #RowanCommandResult -> #packagesUpdate:;
	add: #RowanCommandResult -> #packageUpdate:;
	add: #RowanCommandResult -> #projectPackagesUpdate:browser:;
	add: #RowanCommandResult -> #projectSelectionUpdate:;
	add: #RowanCommandResult -> #projectsUpdate:;
	add: #RowanCommandResult -> #projectsUpdate:browser:;
	add: #RowanCommandResult -> #removed:;
	add: #RowanCommandResult -> #removedClass:;
	add: #RowanCommandResult -> #removedProject:;
	add: #RowanCommandResult -> #superclassListUpdate:;
	add: #RowanCommandResult -> #testClasses:;
	add: #RowanCommandResult -> #testPackages:;
	add: #RowanCommandResult -> #updateClassCategorySelectionsFor:;
	add: #RowanCommandResult -> #updateClassHierarchySelectionFor:;
	add: #RowanCommandResult -> #updateClassSelectionFor:;
	add: #RowanCommandResult -> #updatedClass:browser:;
	add: #RowanCommandResult -> #updatedClassDefinition:browser:;
	add: #RowanCommandResult -> #updatedClassInHierarchy:browser:;
	add: #RowanCommandResult -> #updateDictionarySelectionsFor:;
	add: #RowanCommandResult -> #updateMethodFilterSelectionFor:;
	add: #RowanCommandResult -> #updateMethodSelectionFor:;
	add: #RowanCommandResult -> #updatePackageSelectionsFor:;
	add: #RowanCommandResult -> #updateSelectorFor:;
	add: #RowanCommandResult -> #updateSuperclassSelectionFor:;
	add: #RowanCommandResult -> #updateType;
	add: #RowanGsMethod -> #printOn:;
	add: #RowanMethodDefinition -> #methodService;
	add: #RowanPatch -> #operations:;
	add: #RowanPatch -> #session:;
	add: #SequencedGrowableCollection -> #removeAtIndexWithoutNotification:;
	add: #SequencedGrowableCollection -> #removeWithoutNotification:ifAbsent:;
	add: #TranscriptPresenter -> #clearTranscript;
	add: #TreeModel -> #removeWithoutNotification:ifAbsent:;
	add: 'CodeSourcePresenter class' -> #resource_Default_view;
	add: 'DiffBrowser class' -> #defaultModel;
	add: 'JadeDebugger class' -> #resource_Default_view;
	add: 'JadeInspector class' -> #defaultInspectorClass;
	add: 'JadeInspector class' -> #resource_Default_view;
	add: 'JadeInspector class' -> #resource_Special_view;
	add: 'JadeInspector class' -> #setNavigationInspector;
	add: 'JadeInspector class' -> #showOn:session:;
	add: 'JadeNavigationInspector class' -> #resource_Default_view;
	add: 'JadePresenter class' -> #allClassesIn:;
	add: 'JadePresenter class' -> #basicBrowseClassReferences:session:;
	add: 'JadePresenter class' -> #basicBrowseMethod:presenter:;
	add: 'JadePresenter class' -> #browseBreakpointsIn:;
	add: 'JadePresenter class' -> #browseClassIn:;
	add: 'JadePresenter class' -> #browseClassReferences:session:;
	add: 'JadePresenter class' -> #browseClassReferencesInSession:;
	add: 'JadePresenter class' -> #browseHierarchyImplementorsOf:className:session:;
	add: 'JadePresenter class' -> #browseHierarchySendersOf:className:session:;
	add: 'JadePresenter class' -> #browseImplementorsIn:;
	add: 'JadePresenter class' -> #browseImplementorsOf:session:;
	add: 'JadePresenter class' -> #browseInstVarReaders:in:session:;
	add: 'JadePresenter class' -> #browseInstVarWriters:in:session:;
	add: 'JadePresenter class' -> #browseLiteralReferences:;
	add: 'JadePresenter class' -> #browseLiteralReferences:initialSuggestion:;
	add: 'JadePresenter class' -> #browseLiteralReferences:session:;
	add: 'JadePresenter class' -> #browseMethodsContaining:;
	add: 'JadePresenter class' -> #browseMethodsContaining:session:;
	add: 'JadePresenter class' -> #browseSendersIn:;
	add: 'JadePresenter class' -> #browseSendersOf:session:;
	add: 'JadePresenter class' -> #browseSymbolReferencesTo:session:;
	add: 'JadePresenter class' -> #clearAllBreaksIn:;
	add: 'JadePresenter class' -> #clearMethodBreakpoints:in:;
	add: 'JadePresenter class' -> #convertToPattern:;
	add: 'JadePresenter class' -> #findMethodIn:class:presenter:;
	add: 'JadePresenter class' -> #issueCommands:session:;
	add: 'JadePresenter class' -> #openGitHubJadeiteProject;
	add: 'JadePresenter class' -> #openGitHubRowanProject;
	add: 'JadePresenter class' -> #openMethodListOn:selecting:session:;
	add: 'JadePresenter class' -> #openMethodListOn:selectingAnyMatch:session:;
	add: 'JadePresenter class' -> #promptFor:withCaption:;
	add: 'JadePresenter class' -> #promptForMatchingSymbolsIn:actionBlock:promptCaption:searchType:;
	add: 'JadePresenter class' -> #runMethodTests:in:;
	add: 'JadeServer class' -> #gsString;
	add: 'JadeServer64bit32 class' -> #gsClassDefinitionStringFor:;
	add: 'JadeSessionManager class' -> #getUrl;
	add: 'JadeSessionManager class' -> #mainShellClass;
	add: 'JadeSessionManager class' -> #setVersion;
	add: 'TranscriptPresenter class' -> #resource_Default_view;
	yourself.

package binaryGlobalNames: (Set new
	yourself).

package globalAliases: (Set new
	yourself).

package setPrerequisites: (IdentitySet new
	add: '..\Core\Object Arts\Dolphin\IDE\Base\Development System';
	add: '..\Core\Object Arts\Dolphin\Base\Dolphin';
	add: '..\Core\Object Arts\Dolphin\MVP\Views\Cards\Dolphin Card Containers';
	add: '..\Core\Object Arts\Dolphin\MVP\Presenters\Prompters\Dolphin Choice Prompter';
	add: '..\Core\Object Arts\Dolphin\MVP\Views\Common Controls\Dolphin Common Controls';
	add: '..\Core\Object Arts\Dolphin\MVP\Dialogs\Common\Dolphin Common Dialogs';
	add: '..\Core\Object Arts\Dolphin\MVP\Views\Control Bars\Dolphin Control Bars';
	add: '..\Core\Object Arts\Dolphin\MVP\Presenters\Difference\Dolphin Differences Presenter';
	add: '..\Core\Object Arts\Dolphin\MVP\Dialogs\Find\Dolphin Find Dialog';
	add: '..\Core\Object Arts\Dolphin\MVP\Presenters\Font\Dolphin Font Presenter';
	add: '..\Core\Object Arts\Dolphin\MVP\Presenters\Prompters\Dolphin Key-Value Prompter';
	add: '..\Core\Object Arts\Dolphin\MVP\Models\List\Dolphin List Models';
	add: '..\Core\Object Arts\Dolphin\MVP\Presenters\List\Dolphin List Presenter';
	add: '..\Core\Object Arts\Dolphin\MVP\Deprecated\Dolphin MVP (Deprecated)';
	add: '..\Core\Object Arts\Dolphin\MVP\Base\Dolphin MVP Base';
	add: '..\Core\Object Arts\Dolphin\MVP\Presenters\Number\Dolphin Number Presenter';
	add: '..\Core\Object Arts\Dolphin\MVP\Presenters\Prompters\Dolphin Prompter';
	add: '..\Core\Object Arts\Dolphin\MVP\Presenters\Radio\Dolphin Radio Buttons';
	add: '..\Core\Object Arts\Dolphin\MVP\Presenters\Text\Dolphin Rich Text Presenter';
	add: '..\Core\Object Arts\Dolphin\MVP\Views\Scintilla\Dolphin Scintilla View';
	add: '..\Core\Object Arts\Dolphin\MVP\Views\Slider\Dolphin Slider Control';
	add: '..\Core\Object Arts\Dolphin\MVP\Views\Sliding Tray\Dolphin Slidey-Inney-Outey Thing';
	add: '..\Core\Object Arts\Dolphin\MVP\Presenters\Text\Dolphin Text Presenter';
	add: '..\Core\Object Arts\Dolphin\MVP\Models\Tree\Dolphin Tree Models';
	add: '..\Core\Object Arts\Dolphin\MVP\Presenters\Tree\Dolphin Tree Presenter';
	add: '..\Core\Object Arts\Dolphin\MVP\Type Converters\Dolphin Type Converters';
	add: '..\Core\Object Arts\Dolphin\MVP\Models\Value\Dolphin Value Models';
	add: '..\Core\Contributions\Burning River\ExternalProcess\ExternalProcess';
	add: 'GemStone C Interface';
	add: 'GemStone Objects';
	add: 'GemStone Services';
	add: 'GemStone Session';
	add: '..\Core\Contributions\IDB\IDB Method History';
	add: 'Jade Autocompletation';
	add: 'Jade Deployment';
	add: 'Jade Inspector';
	add: 'Jade Login';
	add: 'Jade Method Browser';
	add: 'Jade Process Browser';
	add: 'Jade System Browser';
	add: 'Jade Test Browser';
	add: 'Jade Transcript';
	add: 'Jade UI';
	add: 'Jade UI Base';
	add: 'Monticello';
	add: 'Object Log Browser';
	add: 'Rowan STON';
	add: 'Rowan UI Base PreInstall';
	add: '..\Core\Object Arts\Dolphin\System\Compiler\Smalltalk Parser';
	add: '..\Core\Contributions\ITC Gorisek\Source Tracking System';
	add: '..\Core\Contributions\Solutions Software\SSW EditableListView';
	add: '..\Core\Contributions\Camp Smalltalk\SUnit\SUnit';
	add: '..\Core\Object Arts\Dolphin\ActiveX\Components\VBScript\VBScript Regular Expressions';
	add: '..\Core\Object Arts\Dolphin\ActiveX\Shell\Windows Shell';
	yourself).

package setManualPrerequisites: #(
	'Rowan UI Base PreInstall').

package!

"Class Definitions"!

Object subclass: #JadeitePreferences
	instanceVariableNames: 'session lastWindowPosition'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
Object subclass: #JadeiteSearch
	instanceVariableNames: 'view session stop start'
	classVariableNames: 'AllClassNames AllSelectors AutoCompleteEnabled'
	poolDictionaries: 'ScintillaConstants'
	classInstanceVariableNames: ''!
Object subclass: #Rowan
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
Semaphore subclass: #JadeiteSemaphore
	instanceVariableNames: 'lockingProcess'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
Error subclass: #RowanDebuggerStepPointError
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
Model subclass: #BrowserUpdate
	instanceVariableNames: 'updates debug inUpdate logger applyingUpdates breakpointsEnabled'
	classVariableNames: 'Current'
	poolDictionaries: ''
	classInstanceVariableNames: ''!
Model subclass: #JadeiteLogger
	instanceVariableNames: 'loggingService isLogging nextGroupId logFileName shouldGetNewLoggerGroup'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
Model subclass: #RowanService
	instanceVariableNames: 'remoteService name isDirty command commandArgs updateType'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanCommandResult subclass: #RowanClassCategoryUpdate
	instanceVariableNames: 'categories selection treeModel'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanCommandResult subclass: #RowanClassesUpdate
	instanceVariableNames: 'classNames selectionNames'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanCommandResult subclass: #RowanClassInfoUpdate
	instanceVariableNames: 'oop template category comment'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanCommandResult subclass: #RowanDictionaryUpdate
	instanceVariableNames: 'dictionaries selections'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanCommandResult subclass: #RowanGlobalsUpdate
	instanceVariableNames: 'globals'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanCommandResult subclass: #RowanMethodUpdate
	instanceVariableNames: 'classOop className methodOop selector category editable source firstSendOffsets stepPoints breakPoints originalMethodSource compilationWarnings isTestClass isOverride gsMethod selected'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanCommandResult subclass: #RowanPackageUpdate
	instanceVariableNames: 'packages modifiedPackages selections'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanCommandResult subclass: #RowanProjectsUpdate
	instanceVariableNames: 'projects modifiedProjects selection'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanClassesUpdate subclass: #RowanClassHierarchyUpdate
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanClassesUpdate subclass: #RowanMethodsUpdate
	instanceVariableNames: 'methods methodFilters selectors selectedClass selectedSelectors inheritedClasses inheritedClass type'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanClassesUpdate subclass: #RowanSuperclassUpdate
	instanceVariableNames: 'tabName'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanService subclass: #RowanAnsweringService
	instanceVariableNames: 'answer'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanService subclass: #RowanAutoCommitService
	instanceVariableNames: 'autoCommit'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanService subclass: #RowanBrowserService
	instanceVariableNames: 'projects removedMethods allClasses hierarchyServices testPackages testCount dictionaries selectedClass newCachedSelectors newCachedClasses'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanService subclass: #RowanClassService
	instanceVariableNames: 'comment instVarNames classVarNames classInstVarNames superclassName subclassType poolDictionaryNames classType meta isExtension version versions template oop filters filterType methods packageName definedPackageName selectedPackageServices selectedMethods projectName hierarchyServices variables categories isTestCase expand visibleTests isNewClass updateAfterCommand isInSymbolList dictionaryName wasRemoved renamedName'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanService subclass: #RowanDebuggerService
	instanceVariableNames: 'initialProcessOop processes'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanService subclass: #RowanDictionaryService
	instanceVariableNames: 'classes hierarchyServices globals defaultTemplate'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanService subclass: #RowanFrameService
	instanceVariableNames: 'label method stepPoint vars oop homeMethodSelector homeMethodClassName'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanService subclass: #RowanInspectorService
	instanceVariableNames: 'oop objects myself className indexedSize visibleIndices nextIndices maxIndexedVars compileErrorArray isOop instVarNames instVarsAreRemovable isDictionary isVariable selectionOop isUnordered'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanService subclass: #RowanLoggingService
	instanceVariableNames: 'fileName id groupId date time comment services mode location isLogging'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanService subclass: #RowanMethodService
	instanceVariableNames: 'source selector methodDefinitions category packageName projectName className meta user hasSupers hasSubs isExtension inSelectedPackage references stepPoints selectedPackageServices superDisplayString accessedInstVars breakPoints oop compilationWarnings testResult definedPackage isTestMethod testRunClassName failedCompile comparisonSource firstReference renamedName isMethodForBlock homeMethodOop hasMethodHistory'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanService subclass: #RowanPackageService
	instanceVariableNames: 'classes defaultTemplate projectName classCompilationFailures testClasses hierarchyServices selectedClass'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanService subclass: #RowanProcessService
	instanceVariableNames: 'frames oop status'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanService subclass: #RowanProjectService
	instanceVariableNames: 'sha branch isSkew packages changes existsOnDisk isLoaded projectUrl rowanProjectsHome'
	classVariableNames: 'DefaultProjectName'
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanService subclass: #RowanQueryService
	instanceVariableNames: 'queryResults'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanService subclass: #RowanVariableService
	instanceVariableNames: 'oop key value className'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadePresenter subclass: #JadeiteLoggerPresenter
	instanceVariableNames: 'logListPresenter clientFilename serverFilename'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadePresenterA subclass: #RowanPresenter
	instanceVariableNames: 'projectToolsOop'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
MethodSourcePresenter subclass: #JadeiteDebuggerMethodSourcePresenter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
MethodSourcePresenter subclass: #RowanMethodSourcePresenter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanMethodSourcePresenter subclass: #JadeiteMethodSourcePresenter
	instanceVariableNames: 'methodService'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeMethodListPresenter subclass: #RowanMethodListPresenter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanMethodListPresenter subclass: #JadeiteMethodListPresenter
	instanceVariableNames: 'textAreaTabs comparisonTab comparisonPresenter autoCommit search'
	classVariableNames: ''
	poolDictionaries: 'ScintillaConstants'
	classInstanceVariableNames: ''!
JadeiteMethodListPresenter subclass: #JadeiteRenameClassMethodListPresenter
	instanceVariableNames: 'findString newClassName'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeAutoSystemBrowserPresenter subclass: #RowanSystemBrowserPresenter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanSystemBrowserPresenter subclass: #JadeiteProjectsBrowserPresenter
	instanceVariableNames: 'projectListPresenter stonCritical projectInfoTab projectLabel projectDictionaryTabs comparisonPresenter comparisonTab definedClassPackageText definedMethodPackageText methodCategoryText autoCommit statusBarText'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeiteProjectsBrowserPresenter subclass: #JadeiteBrowserPresenter
	instanceVariableNames: 'dictionaryPresenter packageDictionaryCards globalsTab autoCommitButton search'
	classVariableNames: ''
	poolDictionaries: 'ScintillaConstants'
	classInstanceVariableNames: ''!
JadePreferencesPresenter subclass: #JadeitePreferencesPresenter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
MethodListPresenter subclass: #PackageMethodListPresenter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
PackageMethodListPresenter subclass: #JadeiteBasicMethodListPresenter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeiteBasicMethodListPresenter subclass: #JadeiteBasicRenameClassMethodListPresenter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanPresenter subclass: #JadeiteProjectListPresenter
	instanceVariableNames: 'projectListPresenter'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanPresenter subclass: #RowanMethodSelectionPresenter
	instanceVariableNames: 'methodListPresenter methodSourcePresenter'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanPresenter subclass: #RowanPackagePresenter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
AdvancedFindDialog subclass: #JadeiteAdvancedFindDialog
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
KeyValuePrompter subclass: #RowanKeyValuePrompter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
MCVersionDialog subclass: #RowanSavePackageDialog
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
ChoicePrompter subclass: #TestChoicePrompter
	instanceVariableNames: ''
	classVariableNames: 'PlannedResult'
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeValueDialog subclass: #JadeFindDialog
	instanceVariableNames: 'nameEntryPresenter'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeFindDialog subclass: #JadeFindClassDialog
	instanceVariableNames: 'classListPresenter availableClasses'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeFindDialog subclass: #JadeiteFindMethodDialog
	instanceVariableNames: 'listPresenter available'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeFindClassDialog subclass: #JadeiteFindClassDialog
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
StsMultilinePrompter subclass: #JadeiteMultilinePrompter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeLoginShell subclass: #JadeiteLoginShell
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeDebugger subclass: #JadeiteDebugger
	instanceVariableNames: 'statusTextPresenter idleProcess idleProcessSemaphore search debuggerService'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: 'debuggerClass semaphore lastPosition'!
JadeNavigationInspector subclass: #JadeiteInspector
	instanceVariableNames: 'statusTextPresenter'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeWorkspace subclass: #JadeiteGitLog
	instanceVariableNames: 'projectService'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeWorkspace subclass: #JadeitePreferencesWorkspace
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeTranscript subclass: #JadeiteTranscript
	instanceVariableNames: 'projectListPresenter isTranscriptInstalled autoCommit areBreakpointsEnabled autoCompleteEnabled'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeShell subclass: #JadeiteLoggerShell
	instanceVariableNames: 'clientFilenameText serverFilenameText'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeShell subclass: #RowanShell
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeMethodListBrowser subclass: #RowanMethodListBrowser
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanMethodListBrowser subclass: #JadeiteMethodListBrowser
	instanceVariableNames: 'firstReferenceString'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeiteMethodListBrowser subclass: #JadeiteRenameClassMethodListBrowser
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadePreferencesShell subclass: #JadeitePreferencesShell
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeSystemBrowser subclass: #RowanSystemBrowser
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanSystemBrowser subclass: #JadeiteProjectsSystemBrowser
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
JadeiteProjectsSystemBrowser subclass: #JadeiteBrowser
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
MCPatchBrowser subclass: #JadeiteChangesBrowser
	instanceVariableNames: 'name diffsPresenter session'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanShell subclass: #JadeiteProjectListBrowser
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
RowanShell subclass: #RowanPackageShell
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
DiffBrowser subclass: #JadeiteDiffBrowser
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
MethodHistoryBrowser subclass: #JadeiteMethodHistoryBrowser
	instanceVariableNames: 'session'
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
SmalltalkSearchPresenter subclass: #JadeiteSmalltalkSearchPresenter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
SmalltalkWorkspace subclass: #JadeiteSmalltalkWorkspace
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!
ScintillaView subclass: #JadeiteScintillaView
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	classInstanceVariableNames: ''!

"Global Aliases"!


"Loose Methods"!

!CodeSourcePresenter methodsFor!

browseSelectedClass
	^self browseSelectedClassIn: documentPresenter newTab: false!

currentSelection
	| selection |
	selection := documentPresenter view selection trimBlanks.
	selection isEmpty ifTrue: [^selection].
	selection first = $# ifTrue: [selection := selection copyFrom: 2 to: selection size].
	selection isEmpty ifTrue: [^selection].
	(selection first = $' and: [selection last = $'])
		ifTrue: 
			[selection := selection copyFrom: 2 to: selection size.
			selection isEmpty ifTrue: [^selection].
			selection := selection copyFrom: 1 to: selection size - 1].
	^RowanAnsweringService new expressionSelector: selection session: self gciSession!

executeSelectionOrLine
	^self executeSelectionOrLine: self parentPresenter contextObject !

inspectorContextObject
	^gciSession oopNil value!

jadeInspect
	| inspector |
	inspector := JadeiteInspector new gciSession: gciSession.
	^inspector evaluateSelectedTextIn: self thenInspectInContext: self inspectorContextObject!

methodMenuBreak: menu
	| currentSelection implementorsCommand sendersCommand browseClassMenuItem menuPosition implementorsItem sendersItem currentSelectionMenuItemName |
	currentSelection := self currentSelection.
	currentSelection := currentSelection copyWithout: Character space.
	currentSelectionMenuItemName := currentSelection size > 50
				ifTrue: [(currentSelection copyFrom: 1 to: 50) , ' ...']
				ifFalse: [currentSelection].
	menu items copy do: 
			[:item |
			item isDivider
				ifFalse: 
					[item command asSymbol == #browseImplementorsOf: ifTrue: [menu removeItem: item].
					item command asSymbol == #browseSendersOf: ifTrue: [menu removeItem: item]]].
	currentSelection isEmpty ifTrue: [^self].
	browseClassMenuItem := menu items
				detect: [:item | item isDivider not and: [item command asSymbol = #browseSelectedClass]]
				ifNone: [^self].
	menuPosition := menu items indexOf: browseClassMenuItem.
	implementorsCommand := MessageSend
				receiver: self
				selector: #browseImplementorsOf:
				argument: currentSelection.
	implementorsItem := CommandMenuItem command: implementorsCommand
				description: 'Browse Implementors of #' , currentSelectionMenuItemName.
	menu insertItem: implementorsItem at: menuPosition + 1.
	menuPosition := menu items indexOf: implementorsItem.
	sendersCommand := MessageSend
				receiver: self
				selector: #browseSendersOf:
				argument: currentSelection.
	sendersItem := CommandMenuItem command: sendersCommand
				description: 'Browse Senders of #' , currentSelectionMenuItemName.
	menu insertItem: sendersItem at: menuPosition + 1! !
!CodeSourcePresenter categoriesFor: #browseSelectedClass!Jade!public! !
!CodeSourcePresenter categoriesFor: #currentSelection!public! !
!CodeSourcePresenter categoriesFor: #executeSelectionOrLine!Jade!private! !
!CodeSourcePresenter categoriesFor: #inspectorContextObject!Jade!private! !
!CodeSourcePresenter categoriesFor: #jadeInspect!Jade!private! !
!CodeSourcePresenter categoriesFor: #methodMenuBreak:!menus!public! !

!CodeSourcePresenter class methodsFor!

resource_Default_view
	"Answer the literal data from which the 'Default view' resource can be reconstituted.
	DO NOT EDIT OR RECATEGORIZE THIS METHOD.

	If you wish to modify this resource evaluate:
	ViewComposer openOn: (ResourceIdentifier class: self selector: #resource_Default_view)
	"

	^#(#'!!STL' 4 788558 10 ##(Smalltalk.STBViewProxy) ##(Smalltalk.ContainerView) 34 15 nil nil 34 2 8 1409286144 131073 416 nil nil nil 1029 nil nil nil 416 852230 ##(Smalltalk.FramingLayout) 170 176 34 4 410 ##(Smalltalk.JadeiteScintillaView) 34 50 nil 416 34 2 8 1445007428 1025 544 721990 2 ##(Smalltalk.ValueHolder) nil false 1310726 ##(Smalltalk.EqualitySearchPolicy) nil 524550 ##(Smalltalk.ColorRef) 8 4278190080 nil 5 265030 4 ##(Smalltalk.Menu) nil true 34 26 984134 2 ##(Smalltalk.CommandMenuItem) 1 1180998 4 ##(Smalltalk.CommandDescription) #fileSave 8 '&Save' 9383 1 nil nil nil 983366 1 ##(Smalltalk.DividerMenuItem) 4097 770 1 802 #undo 8 '&Undo' 9397 1 nil nil nil 770 1 802 #redo 8 'R&edo' 9395 1 nil nil nil 850 4097 770 1 802 #editCut 8 'Cu&t' 9393 1 nil nil nil 770 1 802 #editCopy 8 '&Copy' 9351 1 nil nil nil 770 1 802 #editPaste 8 '&Paste' 9389 1 nil nil nil 770 1 802 #editDelete 8 'De&lete' 1629 1 nil nil nil 770 1 802 #editSelectAll 8 'Select &All' 9347 1 nil nil nil 850 4097 770 1 802 #editFind 8 '&Find...' 9357 1 nil nil nil 770 1 802 #editFindNext 8 'Find &Next' 9359 1 nil nil nil 770 1 802 #editReplace 8 '&Replace...' 9361 1 nil nil nil 850 4097 770 1 802 #jadeInspect 8 '&Inspect' 9379 1 nil nil nil 770 1 802 #jadeDisplay 8 '&Display' 9353 1 nil nil nil 770 1 802 #jadeExecute 8 'Execute' 9355 1 nil nil nil 770 1 802 #jadeDebug 8 'De&bug' 9349 1 nil nil nil 850 4097 770 1 802 #addQuotesToSelection 8 'Add &Quotes' 1 1 nil nil nil 770 1 802 #removeQuotesFromSelection 8 'Re&move Quotes' 1 1 nil nil nil 850 4097 770 1 802 #browseSelectedClass 8 'Browse Class' 1 1 nil nil nil 850 4097 770 1 802 #fileIn 8 'File In' 1 1 nil nil nil 8 '' nil 1 nil nil nil nil nil 263174 ##(Smalltalk.Font) nil true 459014 ##(Smalltalk.LOGFONT) 8 #[243 255 255 255 0 0 0 0 0 0 0 0 0 0 0 0 144 1 0 0 0 0 0 0 3 2 1 34 86 101 114 100 97 110 97 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] 328198 ##(Smalltalk.Point) 193 193 nil 544 nil 8 4294907023 852486 ##(Smalltalk.NullConverter) nil nil 9 nil 170 192 34 4 #callTip 1182790 1 ##(Smalltalk.ScintillaTextStyle) 77 786694 ##(Smalltalk.IndexedColor) 33554457 2082 33554471 1 nil nil nil nil #callTip nil nil nil #normal 2050 1 nil nil 1 nil nil nil nil #normal nil nil nil 34 256 2128 nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil 2064 nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil 1639686 ##(Smalltalk.SmalltalkExpressionStyler) 1 nil nil false 138 144 8 #() 170 192 34 2 #default 1641542 1 ##(Smalltalk.ScintillaMarkerDefinition) 1 nil nil nil 544 #circle nil nil nil nil nil nil 138 ##(Smalltalk.IdentitySet) 2208 nil 170 176 2208 9215 nil nil nil nil 2082 33554447 nil nil 65 nil nil 170 192 34 6 #literalBytes 8 '[]' #specialCharacter 8 '()[]<>' #literalArray 8 '()' 8 '' 3 170 192 34 2 #container 170 192 34 4 #callTip 2064 #normal 2128 nil nil nil nil 1 nil 170 192 34 12 1 1510470 2 ##(Smalltalk.ScintillaIndicatorStyle) 1 544 65025 3 false 1 nil nil nil nil nil nil 3 2530 3 544 33423361 5 false 3 nil nil nil nil nil nil 5 2530 5 544 511 1 false 5 nil nil nil nil nil nil 8 'indicator10' 2530 21 544 33554459 3 nil nil nil nil nil nil nil nil 8 'indicator9' 2530 19 544 33554459 13 nil nil nil nil nil nil nil nil 8 'indicator8' 2530 17 544 33554447 1 nil nil nil nil nil nil nil nil nil nil 170 192 34 6 #Notification 2050 1029 nil 196934 1 ##(Smalltalk.RGB) 31185883 1 nil nil nil nil #Notification nil nil nil #Warning 2050 1027 2738 60239 2738 31326207 1 nil nil nil nil #Warning nil nil nil #Error 2050 1031 2738 335 2738 31317503 1 nil nil nil nil #Error nil nil nil nil 983302 ##(Smalltalk.MessageSequence) 138 144 34 9 721670 ##(Smalltalk.MessageSend) #createAt:extent: 34 2 1938 1 51 1938 1001 551 544 2930 #contextMenu: 34 1 736 544 2930 #modificationEventMask: 8 #(4607) 544 2930 #hoverTime: 8 #(200) 544 2930 #caretPeriod: 8 #(530) 544 2930 #wordWrap: 8 #(true) 544 2930 #margins: 34 1 34 3 985158 2 ##(Smalltalk.ScintillaMargin) 1 544 61 3 nil nil nil nil 3218 3 544 1 nil 3 67108863 nil nil 3218 5 544 1 nil 3 -67108863 nil nil 544 2930 #tabWidth: 8 #(4) 544 2930 #maxCompletionListHeight: 8 #(9) 544 983302 ##(Smalltalk.WINDOWPLACEMENT) 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 25 0 0 0 244 1 0 0 44 1 0 0] 8 #() 1938 193 193 nil 29 1181766 2 ##(Smalltalk.FramingConstraints) 1180678 ##(Smalltalk.FramingCalculation) #fixedParentLeft 1 3458 #fixedParentRight 1 3458 #fixedPreviousBottom 1 3458 #fixedParentBottom 1 410 ##(Smalltalk.Toolbar) 34 25 nil 416 34 2 8 1140851500 131137 3536 nil 674 8 4278190080 nil 517 nil 1858 nil true 1890 8 #[243 255 255 255 0 0 0 0 0 0 0 0 0 0 0 0 144 1 0 0 0 0 0 0 3 2 1 34 65 114 105 97 108 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] 1938 193 193 nil 3536 674 3616 8 4294906465 170 192 2208 170 192 34 24 11333 853766 ##(Smalltalk.ToolbarButton) 11333 nil 3536 1 802 #jadeDisplay 8 'Display' 1 1 nil 395334 3 ##(Smalltalk.Bitmap) nil true 1572870 ##(Smalltalk.ImageRelativeFileLocator) 8 'Tools.bmp' 2032142 ##(Smalltalk.STBExternalResourceLibraryProxy) 8 'dolphindr7.dll' nil nil 7 1938 1857 33 55 11335 3778 11335 nil 3536 1 802 #jadeExecute 8 'Execute' 1 1 nil 3856 57 11337 3778 11337 nil 3536 1 802 #jadeInspect 8 'Inspect' 1 1 nil 3856 59 11339 1246982 ##(Smalltalk.ToolbarSystemButton) 11339 nil 3536 1 802 #fileSave 8 'Save' 1 1 nil 1 17 11341 4082 11341 nil 3536 1 802 #editCut 8 'Cut' 1 1 nil 1 1 11343 4082 11343 nil 3536 1 802 #copySelection 8 'Copy' 1 1 nil 1 3 11345 4082 11345 nil 3536 1 802 #editPaste 8 'Paste' 1 1 nil 1 5 11347 4082 11347 nil 3536 1 802 #editDelete 8 'Delete' 1 1 nil 1 11 11349 4082 11349 nil 3536 1 802 #undo 8 'Undo' 1 1 nil 1 7 11351 4082 11351 nil 3536 1 802 #redo 8 'Redo' 1 1 nil 1 9 11353 4082 11353 nil 3536 1 802 #editFind 8 'Find' 1 1 nil 1 25 11355 4082 11355 nil 3536 1 802 #editReplace 8 'Replace' 1 1 nil 1 27 34 15 3792 3984 4032 1050118 ##(Smalltalk.ToolbarSeparator) nil nil 3536 3 nil 1 4096 4546 nil nil 3536 3 nil 1 4144 4192 4240 4288 4336 4384 4546 nil nil 3536 3 nil 1 4432 4480 170 176 34 4 1 117 3856 1 nil 1 nil 1938 33 33 1938 45 45 nil nil 2866 138 144 34 2 2930 #createAt:extent: 34 2 1938 1 1 1938 1001 51 3536 2930 #updateSizePosted 2208 3536 3346 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 0 0 0 0 244 1 0 0 25 0 0 0] 8 #() 3408 nil 27 3426 3472 1 3488 1 3458 #fixedParentTop 1 3458 #fixedViewTop 51 170 192 34 2 544 8 'document' nil 2866 138 144 34 1 2930 #createAt:extent: 34 2 1938 7679 21 1938 1001 601 416 3346 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 14 0 0 10 0 0 0 243 16 0 0 54 1 0 0] 34 2 3536 544 3408 nil 27 )! !
!CodeSourcePresenter class categoriesFor: #resource_Default_view!public!resources-views! !

!Collection methodsFor!

basicPrepareForReplication
	self do: [:element | element basicPrepareForReplication]!

prepareForReplication
	self do: [:element | element prepareForReplication]! !
!Collection categoriesFor: #basicPrepareForReplication!Jadeite!public! !
!Collection categoriesFor: #prepareForReplication!Jadeite!public! !

!DiffBrowser methodsFor!

diffsPresenter

	^diffsPresenter! !
!DiffBrowser categoriesFor: #diffsPresenter!public! !

!DiffBrowser class methodsFor!

defaultModel
	"in runtime environment, the superclass
	implementation of #defaultModel tries to 
	initialize a system which is not present"

	^nil! !
!DiffBrowser class categoriesFor: #defaultModel!public! !

!Float methodsFor!

asString

	^self printString! !
!Float categoriesFor: #asString!converting!public! !

!GciSession methodsFor!

_executeString: aString fromContextOop: anOopType environment: anInteger
	^library
		session: gciSessionId
		execute: (aString copyWithout: Character cr)
		context: anOopType
		environment: anInteger!

clientServerVersionRelationship
	^self
		executeString: ' 
	(Rowan class canUnderstand: #answeringServiceClass) 
		ifFalse:[^''Client is more recent than server''].
	(Rowan answeringServiceClass value canUnderstand: #doClientAndServerVersionsMatch:)
	ifTrue:[
		Rowan answeringServiceClass value new doClientAndServerVersionsMatch: '
				, RowanService version printString , ']
	ifFalse:[
		^''Client is more recent than server'']'!

computeGemHost
	| list |
	list := gemNRS subStrings: $#.
	netPort := ((list at: 2) subStrings: $:) at: 2.
	netTask := ((list at: 3) subStrings: $!!) at: 2.
	gemHost := ((list at: 1) subStrings: $@) at: 2!

computeStoneHost
	| list |
	list := stoneNRS subStrings: $!!.
	stoneName := list at: 3.
	list := (list at: 2) subStrings: $#.
	list := (list at: 1) subStrings: $@.
	stoneHost := list at: 2.!

confirmMessageBox: prompt
	"send string back to the server and let it unpack it"

	^self oopForString: (MessageBox confirm: prompt caption: 'Rowan Confirmation') printString!

executeString: aString
	^self
		executeString: aString
		fromContext: nil
		environment: 0!

executeString: aString fromContext: anObject environment: anInteger
	| oopType |
	BrowserUpdate current logComment: 'GciSession executeString: ' , aString.
	oopType := self oopTypeFor: anObject.
	^self withExplanation: aString
		do: 
			[self
				_executeString: aString
				fromContextOop: oopType
				environment: anInteger]!

gemNRS

	^gemNRS!

hasServer

	^server notNil.
!

informMessageBox: prompt
	"send string back to the server and let it unpack it"
	^self oopForString: (MessageBox notify: prompt caption: 'Rowan Notification') printString!

initializeServer
"
	GciSession allInstances first initializeServer.
"
	library ifNil: [^self].
	[
		server := self executeString: library jadeServerClass gsString.
	] on: GsRuntimeError do: [:ex | 
		| number notes |
		number := ex errorReport number.
		notes := ''.
		number = 2151 ifTrue: [notes := ' (code modification?)'].
		MessageBox warning: ex description , notes , '
Server initialization failed. Most functionality will be broken!!'.
		SessionManager current pause.
		ex return: nil.
	].

	(server isKindOf: String) ifTrue: [
		self logout.
		GciLoginFailed
			signal: 'JadeServer compile error:
' , server
			with: self.
	].
	self commit.

	1 ~~ 1 ifTrue: [		"messasges that are sent by a ClientForwarderSend should not be stripped"
		self 
			signalConfirmationRequestUsing: nil;
			signalTextRequestUsing: nil;
			yourself.
	].
!

inspectServerObject: oop
	"send string back to the server and let it unpack it"

	| oopType |
	oopType := OopType64 fromInteger: oop.
	JadeInspector showOn: oopType session: self.
	^oopType!

oopTypeFor: anObject 

	anObject isNil 					ifTrue: [^library oopNil].
	(anObject isKindOf: ExternalInteger) 	ifTrue: [^anObject].
	(anObject isKindOf: Boolean) 		ifTrue: [^anObject ifTrue: [library oopTrue] ifFalse: [library oopFalse]].
	(anObject isKindOf: SmallInteger) 	ifTrue: [^library session: gciSessionId oopForInteger: anObject].
	(anObject isKindOf: GsObject) 		ifTrue: [^anObject oopType].
	self error: 'Sorry, we are not yet prepared to convert ' , anObject printString , ' to an OOP!!'.
	SessionManager current pause.
!

postLoadClientPreferences
	| path file stream nextLine prefs |
	path := SessionManager current imageBase , self preferencesFile.
	(File exists: path) ifFalse: [^self].
	prefs := JadeitePreferences onSession: self.
	file := File open: path mode: #read.
	
	[stream := file readWriteStream.
	[stream atEnd] whileFalse: 
			[nextLine := stream nextLine.
			prefs applyPreference: nextLine]]
			ensure: [^file close]!

postLoadServerPreferences
	self
		executeString: '
		[| block |
		block := UserGlobals at: #JadeitePreferences ifAbsent:[^self].
		(block class canUnderstand: #value) ifTrue:[
			block value]] 
		on: Error 
		do:[:ex | "do not break the login"]'!

postLoginAs: aString useSocket: aBoolean
	| answer |
	self verifyRowanLoaded
		ifFalse: 
			[^MessageBox notify: 'Rowan not loaded or $ROWAN_PROJECTS_HOME not set. Logging out.'	"log out in RowinLoginShell>>postLogin:"].
	server := self
				executeString: '(Rowan jadeServerClassNamed: #JadeServer) theJadeiteServer installTranscript; yourself'.
	aBoolean ifTrue: [self attemptSocket].
	self setInitials: aString.	"This gets back the session and serial number"
	answer := self clientServerVersionRelationship.
	answer == true
		ifFalse: 
			[BrowserUpdate current logComment: 'login warning. version mismatch'.
			MessageBox notify: 'Version mismatch. ' , answer caption: 'Login warning'].
	GciSession current: self.
	JadeiteSearch autoCompleteEnabled ifTrue: [JadeiteSearch initializeAutocompleteSymbolsIn: self].
	self postLoadClientPreferences.
	self postLoadServerPreferences!

preferencesFile

	^'Jadeite.prefs'!

serverPerform: aSymbol withArguments: anArray
	| answer |
	server isNil
		ifTrue: 
			[MessageBox notify: 'Unable to perform action due to server initialization failure.'.
			^self].
	answer := self
				send: aSymbol
				to: server
				withAll: anArray.
	^answer!

terminate: anOopType
	[self serverPerform: #terminate: with: anOopType] on: Error
		do: 
			[:ex |
			"ignore termination errors"
			].
	TerminateProcess signal!

titleBarFor: windowName
	| stream |
	self computeStoneHost.
	stream := WriteStream on: String new.
	stream
		nextPutAll: windowName;
		nextPutAll: ' for ';
		nextPutAll: userID asString;
		nextPutAll: ' on ';
		nextPutAll: stoneName asString;
		nextPutAll: ' [';
		print: gciSessionId;
		nextPutAll: ']'.
	self isRemoteGem
		ifTrue: 
			[self computeGemHost.
			stream
				nextPutAll: ' with remote gem on ';
				nextPutAll: gemHost asString]
		ifFalse: [stream nextPutAll: ' with linked gem'].
	^stream contents!

verifyRowanLoaded
	"The global Rowan indicates the Rowan packages are loaded. 
	The ROWAN_PROJECTS_HOME gem environment variable is also required"

	^self
		executeString: '(System myUserProfile objectNamed: ''Rowan'') notNil and:[(System gemEnvironmentVariable: ''ROWAN_PROJECTS_HOME'') notNil] '!

withExplanation: aString do: aBlock
	"Here we make the call and handle any error."

	| result error |
	BrowserUpdate current inUpdateWhile: 
			[
			[(Delay forMilliseconds: 10) wait.
			self isCallInProgress] whileTrue: [].
			result := self withExplanation: aString doA: aBlock.
			self incrementEventCount.
			(result isKindOf: GsError) ifFalse: [^result].
			error := result.
			[result := error signal] ensure: [self releaseAllOops].
			result = #resume ifFalse: [self error: 'Unrecognized response of ' , result printString]].
	"other work may need to be done by, say, the debugger. Give those processes a chance to run 
	before continuing"
	
	[(Delay forMilliseconds: 10) wait.
	self isCallInProgress] whileTrue: [].
	^self withExplanation: aString
		do: [library session: gciSessionId continue: error errorReport contextOop]!

withExplanation: aString doA: aBlock
	"We've (temporarily) eliminated the complicated monitoring loop
	to eventually bring something that is less intrusive. Another 
	problem was that if server events got 'stacked up' the inputState
	loopWhile: block would pick those up and run them in this thread
	which is blocked. This caused many problems

	See https://github.com/jgfoster/Jade/blob/master/sources/GciSession.cls
	for the original implementation when we're ready to implement
	an improved monitoring solution"

	^self handlingClientForwarderSendDo: aBlock! !
!GciSession categoriesFor: #_executeString:fromContextOop:environment:!private! !
!GciSession categoriesFor: #clientServerVersionRelationship!private! !
!GciSession categoriesFor: #computeGemHost!public!title bar! !
!GciSession categoriesFor: #computeStoneHost!public!title bar! !
!GciSession categoriesFor: #confirmMessageBox:!must not strip!public!server interactions! !
!GciSession categoriesFor: #executeString:!Jade convenience!public! !
!GciSession categoriesFor: #executeString:fromContext:environment:!long running!public! !
!GciSession categoriesFor: #gemNRS!public!title bar! !
!GciSession categoriesFor: #hasServer!public! !
!GciSession categoriesFor: #informMessageBox:!must not strip!public!server interactions! !
!GciSession categoriesFor: #initializeServer!private! !
!GciSession categoriesFor: #inspectServerObject:!must not strip!public!server interactions! !
!GciSession categoriesFor: #oopTypeFor:!public! !
!GciSession categoriesFor: #postLoadClientPreferences!private! !
!GciSession categoriesFor: #postLoadServerPreferences!private! !
!GciSession categoriesFor: #postLoginAs:useSocket:!private! !
!GciSession categoriesFor: #preferencesFile!constants!private! !
!GciSession categoriesFor: #serverPerform:withArguments:!Jade convenience!public! !
!GciSession categoriesFor: #terminate:!public! !
!GciSession categoriesFor: #titleBarFor:!public!title bar! !
!GciSession categoriesFor: #verifyRowanLoaded!private! !
!GciSession categoriesFor: #withExplanation:do:!long running!private! !
!GciSession categoriesFor: #withExplanation:doA:!long running!private! !

!GsError methodsFor!

debugError
	^JadeiteDebugger debuggerClass reportError: self! !
!GsError categoriesFor: #debugError!public! !

!GsMethod methodsFor!

className
	^behaviorName!

meta
	"no op. We'll figure this out on the server during a debugger method save"

	^nil!

methodService
	^RowanMethodService new! !
!GsMethod categoriesFor: #className!public! !
!GsMethod categoriesFor: #meta!accessing!public! !
!GsMethod categoriesFor: #methodService!public!rowan! !

!GsProcess methodsFor!

oop 

	^oopType value
	! !
!GsProcess categoriesFor: #oop!accessing!public! !

!JadeAutoSystemBrowserPresenter methodsFor!

methodMenuBreak: aMenu
	| selection service selectedClass |
	methodSourcePresenter view isModified ifTrue: [^self].
	selection := methodListPresenter selectionOrNil.
	selectedClass := classListPresenter selectionOrNil ifNil: [classHierarchyPresenter selectionOrNil last].
	selection ifNil: [^self].
	service := RowanMethodService new
				selector: selection first asSymbol;
				className: selectedClass asSymbol;
				meta: self isClassSideSelected.
	self updateService: service.
	service appendToSourceMenu: aMenu presenter: methodSourcePresenter! !
!JadeAutoSystemBrowserPresenter categoriesFor: #methodMenuBreak:!menus!public! !

!JadeAutoTextPresenter3 methodsFor!

defaultMethod

^'methodSelector
	"method comment"

	| temps |
	^self yourself.
'.
!

setDefaultMethod

	view 
		value: self defaultMethod;
		isModified: false;
		isReadOnly: false;
		yourself.! !
!JadeAutoTextPresenter3 categoriesFor: #defaultMethod!public! !
!JadeAutoTextPresenter3 categoriesFor: #setDefaultMethod!public! !

!JadeDebugger methodsFor!

gsProcess
	^gsProcess!

gsProcess: anObject
	gsProcess := anObject.!

initializeProcess: aProcess message: aString terminateOnClose: aBoolean
	self registerWindow: self view handle rootObject: aProcess oopType.
	gsProcess := aProcess.
	errorMessagePresenter value: aString.
	terminateOnClose := aBoolean.
	[self getProcessList] on: GsError
		do: 
			[:ex | 
			ex debugger: self.
			ex pass].
	self class debuggers at: gsProcess oopType asInteger put: self.
	BrowserUpdate current logComment: 'About to update debugger service'.
	self update!

onViewClosed
	BrowserUpdate current logComment: 'Releasing debugger'. 
	self gciSession isValidSession
		ifTrue: [RowanBrowserService new releaseWindow: self view handle value session: self gciSession].
	BrowserUpdate current logComment: 'Releasing debugger complete'. 
	(processList notNil and: [processList notEmpty])
		ifTrue: 
			[gsProcess := processList first.
			self class debuggers removeKey: gsProcess oopType asInteger ifAbsent: [].
			(terminateOnClose and: [answer isNil])
				ifTrue: 
					[gsProcess terminate.
					self error: 'We should never get here!!']]!

resumeProcess
	answer := #resume.
	self view close!

selectedFrameWithErrorHandling
	BrowserUpdate current logComment: 'About to select frame with error handling'.
	[self selectedFrame] on: RowanDebuggerStepPointError
		do: 
			[:ex |
			BrowserUpdate current logComment: 'Error selecting frame: ' , ex printString.
			BrowserUpdate current logComment: 'isNested: ' , ex isNested printString.
			ex isNested ifTrue: [ex pass] ifFalse: [ex resume]]!

selectedProcess
	processListPresenter selectionOrNil ifNil: [^self].
	self clearUI.
	gsProcess := processListPresenter selectionOrNil.
	BrowserUpdate current logComment: '#selectedProcess - about to send #stack:'. 
	self stack: gsProcess stack!

stack: aList
	| index |
	index := self stackInitialSelection.
	frameListOffset := 0.
	BrowserUpdate current logComment: 'About to give the frameListPresenter a list'.
	frameListPresenter list: aList.
	BrowserUpdate current logComment: 'Finished giving the frameListPresenter a list'.
	aList notEmpty ifTrue: [frameListPresenter selectionByIndex: index].
	BrowserUpdate current logComment: 'Selected index ', index printString.
	SessionManager inputState prod!

update
	| stack |
	((stack := gsProcess stack) isEmpty or: [stack = #('' '')])
		ifTrue: 
			[MessageBox warning: 'We appear to have finished this process!!'.
			self view close.
			^self].
	BrowserUpdate current logComment: 'About to update process list'.
	BrowserUpdate current logComment: 'processList: ' , processList printString.
	(2 <= processList size and: [processListPresenter selectionOrNil ~~ processList first])
		ifTrue: 
			[processListPresenter
				list: processList;
				selectionByIndex: 1	"This triggers a selection changed message that clears the current selection"]
		ifFalse: 
			[BrowserUpdate current logComment: '#update - about to send #stack:'.
			self stack: stack.
			BrowserUpdate current logComment: '#update - finished #stack:']!

updateCaption
	self caption: (gciSession titleBarFor: 'Debugger')! !
!JadeDebugger categoriesFor: #gsProcess!accessing!private! !
!JadeDebugger categoriesFor: #gsProcess:!accessing!private! !
!JadeDebugger categoriesFor: #initializeProcess:message:terminateOnClose:!public! !
!JadeDebugger categoriesFor: #onViewClosed!event handlers!public! !
!JadeDebugger categoriesFor: #resumeProcess!menu handlers!private! !
!JadeDebugger categoriesFor: #selectedFrameWithErrorHandling!public! !
!JadeDebugger categoriesFor: #selectedProcess!public! !
!JadeDebugger categoriesFor: #stack:!public! !
!JadeDebugger categoriesFor: #update!public! !
!JadeDebugger categoriesFor: #updateCaption!public! !

!JadeDebugger class methodsFor!

resource_Default_view
	"Answer the literal data from which the 'Default view' resource can be reconstituted.
	DO NOT EDIT OR RECATEGORIZE THIS METHOD.

	If you wish to modify this resource evaluate:
	ViewComposer openOn: (ResourceIdentifier class: self selector: #resource_Default_view)
	"

	^#(#'!!STL' 4 788558 10 ##(Smalltalk.STBViewProxy) ##(Smalltalk.ShellView) 34 27 nil nil 8 #(13565952 65536) 416 nil 524550 ##(Smalltalk.ColorRef) 8 4278190080 328198 ##(Smalltalk.Point) 1601 1201 551 nil nil nil 416 852230 ##(Smalltalk.FramingLayout) 170 176 34 6 410 ##(Smalltalk.ToolbarA) 34 25 nil 416 34 2 8 1140853580 131137 608 nil 466 8 4278190080 nil 519 nil nil nil 608 466 8 4278190080 8 4294906995 nil 170 192 34 12 16501 1115910 ##(Smalltalk.ToolbarIconButton) 16501 nil 608 1 1180998 4 ##(Smalltalk.CommandDescription) #showNextStatement 8 'Show Next Statement' 1 1 263494 3 ##(Smalltalk.Icon) nil true 1572870 ##(Smalltalk.ImageRelativeFileLocator) 8 'ShowNextStatement.ico' 2032142 ##(Smalltalk.STBExternalResourceLibraryProxy) 8 'dolphindr7.dll' nil 395334 3 ##(Smalltalk.Bitmap) nil true nil nil nil nil 3 514 33 33 1 16503 786 16503 nil 608 1 818 #stepInto 8 'Step Into' 1 1 866 nil true 912 8 'StepInto.ico' 960 994 nil true nil nil nil nil 3 514 33 33 1 16505 786 16505 nil 608 1 818 #stepOver 8 'Step Over' 1 1 866 nil true 912 8 'StepOver.ico' 960 994 nil true nil nil nil nil 3 514 33 33 1 16507 786 16507 nil 608 1 818 #stepOut 8 'Step Out' 1 1 866 nil true 912 8 'StepOut.ico' 960 994 nil true nil nil nil nil 3 514 33 33 1 16509 786 16509 nil 608 1 818 #runToCursor 8 'Run to Cursor' 1 1 866 nil true 912 8 'RunToCursor.ico' 960 994 nil true nil nil nil nil 3 514 33 33 1 16511 786 16511 nil 608 1 818 #resumeProcess 8 'Go' 1 1 866 nil true 912 8 'Run.ico' 960 994 nil true nil nil nil nil 3 514 33 33 1 34 7 800 1040 1152 1264 1376 1488 1050118 ##(Smalltalk.ToolbarSeparator) nil nil 608 3 nil 1 170 176 34 12 1120 3 1232 5 1344 7 1008 1 1456 9 1568 11 nil 1 nil 514 33 33 514 45 45 nil nil 983302 ##(Smalltalk.MessageSequence) 138 144 34 2 721670 ##(Smalltalk.MessageSend) #createAt:extent: 34 2 514 1 1 514 291 51 608 1778 #updateSizePosted 8 #() 608 983302 ##(Smalltalk.WINDOWPLACEMENT) 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 0 0 0 0 145 0 0 0 25 0 0 0] 8 #() 514 193 193 nil 27 1181766 2 ##(Smalltalk.FramingConstraints) 1180678 ##(Smalltalk.FramingCalculation) #fixedParentLeft 1 2002 #fixedViewLeft 291 2002 #fixedParentTop 1 2002 #fixedViewTop 51 410 ##(Smalltalk.ContainerView) 34 15 nil 416 34 2 8 1140850688 131073 2080 nil nil nil 7 nil nil nil 2080 1180166 ##(Smalltalk.ProportionalLayout) 170 176 1872 true 170 192 34 2 410 ##(Smalltalk.ReferenceView) 34 14 nil 2080 34 2 8 1140850688 131073 2224 nil 466 8 4278190080 nil 7 nil nil nil 2224 1180166 ##(Smalltalk.ResourceIdentifier) ##(Smalltalk.MethodSourcePresenter) #resource_Default_view nil 1714 138 144 34 1 1778 #createAt:extent: 34 2 514 1 521 514 1569 513 2224 1890 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 4 1 0 0 16 3 0 0 4 2 0 0] 1872 1952 nil 27 8 'codePane' nil 1714 138 144 34 1 1778 #createAt:extent: 34 2 514 1 51 514 1569 1033 2080 1890 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 25 0 0 0 16 3 0 0 29 2 0 0] 34 3 410 ##(Smalltalk.ContainerView) 34 15 nil 2080 34 2 8 1140850688 131073 2672 nil 466 496 nil 7 nil nil nil 2672 2146 170 176 34 4 410 ##(Smalltalk.ContainerView) 34 15 nil 2672 34 2 8 1140850688 131073 2800 nil nil nil 7 nil nil nil 2800 546 170 176 34 6 410 ##(Smalltalk.ListBox) 34 17 nil 2800 34 2 8 1144062209 1025 2912 590662 2 ##(Smalltalk.ListModel) 138 144 1872 nil 1310726 ##(Smalltalk.IdentitySearchPolicy) 466 496 nil 7 265030 4 ##(Smalltalk.Menu) nil true 34 3 984134 2 ##(Smalltalk.CommandMenuItem) 1 818 #browseFrameMethod 8 '&Browse Frame Method' 1 1 nil nil nil 3122 1 818 #browseImplementors 8 'Browse &Implementors' 1 1 nil nil nil 3122 1 818 #browseSenders 8 'Browse &Senders' 1 1 nil nil nil 8 '' nil 134217729 nil nil nil nil nil nil nil 2912 nil 8 4294905715 ##(Smalltalk.BasicListAbstract) 1872 false 1714 138 144 34 3 1778 #createAt:extent: 34 2 514 1 51 514 859 461 2912 1778 #contextMenu: 34 1 3088 2912 1778 #horizontalExtent: 8 #(0) 2912 1890 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 25 0 0 0 173 1 0 0 255 0 0 0] 8 #() 1952 nil 27 1970 2016 1 2002 #fixedParentRight 1 2002 #fixedPreviousBottom 1 2002 #fixedParentBottom 1 410 ##(Smalltalk.PushButton) 34 20 nil 2800 34 2 8 1140924416 1 3600 nil nil nil 7 nil nil nil 3600 nil 8 4294906643 818 #terminateProcess 8 'Terminate' 1 1 nil nil false nil nil nil 1714 138 144 34 3 1778 #createAt:extent: 34 2 514 719 1 514 141 51 3600 1778 #isEnabled: 8 #(false) 3600 1778 #text: 34 1 8 'Terminate' 3600 1890 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 103 1 0 0 0 0 0 0 173 1 0 0 25 0 0 0] 8 #() 1952 nil 29 1970 2002 #fixedPreviousRight 1 3552 1 2048 1 2064 51 410 ##(Smalltalk.ComboBox) 34 17 nil 2800 34 2 8 1412498947 1025 3984 2978 138 144 1872 nil 3040 466 8 4278190080 nil 7 nil nil nil 3984 nil 8 4294904591 787814 3 ##(Smalltalk.BlockClosure) 0 nil 1180966 ##(Smalltalk.CompiledExpression) 2 1 ##(Smalltalk.UndefinedObject) 8 'doIt' 8 '[:each | each printString]' 8 #[30 105 226 0 106] #printString 4144 7 257 nil 1872 401 1714 138 144 34 1 1778 #createAt:extent: 34 2 514 1 1 514 719 53 3984 1890 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 0 0 0 0 103 1 0 0 26 0 0 0] 8 #() 1952 nil 27 1970 2016 1 3552 -139 2048 1 2064 47 170 192 34 4 2912 8 'frameList' 3984 8 'processList' nil 1714 138 144 34 1 1778 #createAt:extent: 34 2 514 1 1 514 859 511 2800 1890 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 0 0 0 0 173 1 0 0 255 0 0 0] 34 3 3984 3600 2912 1952 nil 27 3 410 ##(Smalltalk.ContainerView) 34 15 nil 2672 34 2 8 1140850688 131073 4640 nil 466 496 nil 7 nil nil nil 4640 2146 170 176 34 4 410 ##(Smalltalk.ListView) 34 30 nil 4640 34 2 8 1140920397 1025 4768 2978 138 144 1872 nil 3040 466 496 nil 7 3074 nil true 34 1 3122 1 818 #browseObjectClass 8 '&Browse Object Class' 1 1 nil nil nil 8 '' nil 134217729 nil nil nil nil nil nil nil 4768 nil 8 4294906975 ##(Smalltalk.BasicListAbstract) nil 1049926 1 ##(Smalltalk.IconImageManager) nil nil nil nil nil nil 138 144 34 3 920646 5 ##(Smalltalk.ListViewColumn) 8 'Variable' 201 #left ##(Smalltalk.BasicListAbstract) ##(Smalltalk.SortedCollection) 4130 0 nil 4162 2 1 4128 8 'doIt' 8 '[:each | each key value]' 8 #[30 105 226 0 142 106] #key 5104 7 257 nil nil 4768 nil 1 nil nil 5058 8 'Value' 313 #left ##(Smalltalk.BasicListAbstract) ##(Smalltalk.SortedCollection) 4130 0 459302 ##(Smalltalk.Context) 1 1 nil nil 4162 0 9 ##(Smalltalk.UndefinedObject) 8 'doIt' 34 2 8 '[:each | each value]' 34 1 138 ##(Smalltalk.PoolDictionary) 1872 8 #[252 1 0 1 1 5 0 17 229 32 142 106 105] 17 257 nil nil 4768 nil 3 nil nil 5058 8 'OOP' 181 #right 459270 ##(Smalltalk.Message) #displayString 8 #() 5410 #<= 5440 4130 0 nil 4162 3 1 ##(Smalltalk.UndefinedObject) 8 'doIt' 8 '[:each | each key key asNumber]' 8 #[31 105 226 0 158 159 106] #key #asNumber 5472 7 257 nil nil 4768 nil 1 nil nil #report 1872 nil 131169 nil 34 4 nil nil 514 1 1 nil 1714 138 144 34 3 1778 #createAt:extent: 34 2 514 1 1 514 701 333 4768 1778 #contextMenu: 34 1 4880 4768 1778 #text: 34 1 8 'Variable' 4768 1890 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 0 0 0 0 94 1 0 0 166 0 0 0] 8 #() 1952 nil 27 5 410 ##(Smalltalk.JadeiteScintillaView) 34 50 nil 4640 34 2 8 1174475012 1025 5824 721990 2 ##(Smalltalk.ValueHolder) nil false 1310726 ##(Smalltalk.EqualitySearchPolicy) nil 466 8 4278190080 nil 7 nil nil nil 5824 nil 8 4294906983 852486 ##(Smalltalk.NullConverter) nil nil 9 nil 170 192 34 8 #callTip 1182790 1 ##(Smalltalk.ScintillaTextStyle) 77 786694 ##(Smalltalk.IndexedColor) 33554457 6098 33554471 1 nil nil nil nil #callTip nil nil nil #indentGuide 6066 75 nil nil 1 nil nil nil nil #indentGuide nil nil nil #lineNumber 6066 67 nil nil 1 nil nil nil nil #lineNumber nil nil nil #normal 6066 1 nil nil 1 nil nil nil nil #normal nil nil nil 34 256 6176 nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil 6160 nil nil nil 6144 6080 nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil 1245510 1 ##(Smalltalk.NullScintillaStyler) #normal 170 192 34 2 #default 1641542 1 ##(Smalltalk.ScintillaMarkerDefinition) nil nil nil nil 5824 #circle nil nil nil nil nil nil 138 ##(Smalltalk.IdentitySet) 1872 nil 170 176 1872 nil nil nil nil nil 6098 33554447 nil nil nil nil nil nil nil 1 170 192 1872 nil nil nil nil nil nil nil nil nil 170 192 34 6 #Notification 6066 1027 nil 196934 1 ##(Smalltalk.RGB) 31185883 1 nil nil nil nil #Notification nil nil nil #Warning 6066 1029 6418 60239 6418 31326207 1 nil nil nil nil #Warning nil nil nil #Error 6066 1031 6418 335 6418 31317503 1 nil nil nil nil #Error nil nil nil nil 1714 138 144 34 7 1778 #createAt:extent: 34 2 514 1 343 514 701 169 5824 1778 #modificationEventMask: 8 #(3912191) 5824 1778 #caretPeriod: 8 #(530) 5824 1778 #wordWrap: 8 #(true) 5824 1778 #margins: 34 1 34 5 985158 2 ##(Smalltalk.ScintillaMargin) 1 5824 1 3 nil nil nil nil 6802 3 5824 33 nil nil 67108863 nil nil 6802 5 5824 1 nil nil nil nil nil 6802 7 5824 1 nil nil nil nil nil 6802 9 5824 1 nil nil nil nil nil 5824 1778 #canHScroll: 8 #(false) 5824 1778 #maxCompletionListHeight: 8 #(9) 5824 1890 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 171 0 0 0 94 1 0 0 255 0 0 0] 8 #() 1952 nil 29 3 true 170 192 34 4 4768 8 'variableList' 5824 8 'variableData' nil 1714 138 144 34 1 1778 #createAt:extent: 34 2 514 869 1 514 701 511 4640 1890 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 178 1 0 0 0 0 0 0 16 3 0 0 255 0 0 0] 34 3 4768 410 ##(Smalltalk.Splitter) 34 12 nil 4640 34 2 8 1140850688 1 7232 nil 466 496 nil 519 nil nil nil 7232 1714 138 144 34 1 1778 #createAt:extent: 34 2 514 1 333 514 701 11 7232 1890 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 166 0 0 0 94 1 0 0 171 0 0 0] 8 #() 1952 nil 27 5824 1952 nil 27 524806 ##(Smalltalk.Fraction) 253 311 false 170 192 1872 nil 1714 138 144 34 1 1778 #createAt:extent: 34 2 514 1 1 514 1569 511 2672 1890 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 0 0 0 0 16 3 0 0 255 0 0 0] 34 3 2800 410 ##(Smalltalk.Splitter) 34 12 nil 2672 34 2 8 1140850688 1 7680 nil 466 496 nil 519 nil nil nil 7680 1714 138 144 34 1 1778 #createAt:extent: 34 2 514 859 1 514 11 511 7680 1890 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 173 1 0 0 0 0 0 0 178 1 0 0 255 0 0 0] 8 #() 1952 nil 27 4640 1952 nil 27 410 ##(Smalltalk.Splitter) 34 12 nil 2080 34 2 8 1140850688 1 7920 nil 466 496 nil 519 nil nil nil 7920 1714 138 144 34 1 1778 #createAt:extent: 34 2 514 1 511 514 1569 11 7920 1890 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 255 0 0 0 16 3 0 0 4 1 0 0] 8 #() 1952 nil 27 2224 1952 nil 27 1970 2016 1 3552 1 2048 51 3584 1 410 ##(Smalltalk.TextEdit) 34 16 nil 416 34 2 8 1140850816 1 8176 5890 nil false 5936 nil nil nil 7 nil nil nil 8176 nil 8 4294904509 6002 nil nil 3 1714 138 144 34 3 1778 #createAt:extent: 34 2 514 291 7 514 1275 39 8176 1778 #text: 34 1 8 'Static Text' 8176 1778 #setMarginWidths: 34 1 8 #(3 3) 8176 1890 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 145 0 0 0 3 0 0 0 14 3 0 0 22 0 0 0] 8 #() 1952 nil 27 1970 2016 291 3552 -3 2048 7 2064 39 170 192 34 4 608 8 'toolbar' 8176 8 'errorMessage' nil 461638 4 ##(Smalltalk.MenuBar) nil true 34 3 3074 nil true 34 1 3122 1 818 #saveMethod 8 '&Save' 9383 1 nil nil nil 8 '&File' nil 134217729 nil nil 16483 nil nil 3074 nil true 34 1 3122 1 818 #copyStack nil 1 1 nil nil nil 8 '&Edit' nil 134217729 nil nil 16487 nil nil 3074 nil true 34 6 3122 1 818 #jadeInspect 8 '&Inspect' 9379 1 nil nil nil 3122 1 818 #jadeDisplay 8 '&Display' 9353 1 nil nil nil 3122 1 818 #jadeExecute 8 '&Execute' 9355 1 nil nil nil 3122 1 818 #jadeDebug 8 'Debu&g' 9359 1 nil nil nil 983366 1 ##(Smalltalk.DividerMenuItem) 4097 3122 1 818 #implement 8 'Implement Method In ...' 1 1 nil nil nil 8 '&Debug' nil 134217729 nil nil 16499 nil nil 8 '' nil 134217729 nil nil nil nil nil nil nil nil 1 866 nil true 912 8 'icons\GS32.ico' nil 866 nil true 912 8 'icons\GS16.ico' nil nil nil 1 nil nil 1714 138 144 34 3 1778 #createAt:extent: 34 2 514 7679 21 514 1601 1201 416 1778 #text: 34 1 8 'Jade Debugger' 416 1778 #updateMenuBar 1872 416 1890 8 #[44 0 0 0 0 0 0 0 0 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 14 0 0 10 0 0 0 31 18 0 0 98 2 0 0] 34 3 8176 608 2080 1952 nil 27 )! !
!JadeDebugger class categoriesFor: #resource_Default_view!public!resources-views! !

!JadeErrorShell methodsFor!

doCopy
	| stream |
	Cursor wait showWhile: 
			[stream := WriteStream on: String new.
			JadeiteDebugger
				dumpStackFor: gsError gsProcess
				errorMessage: gsError messageText
				on: stream.
			stream contents copyToClipboard]!

onViewOpened
	| gsProcess message detail stack stream |
	gsError := self model value.
	super onViewOpened.
	Sound warningBeep.
	gsProcess := gsError gsProcess.
	message := gsError errorReport message.
	isResumable := gsError isResumableInGem.
	detail := message.
	message := message notEmpty ifTrue: [(message subStrings: Character lf) first] ifFalse: [''].
	message := message copyFrom: 1 to: (message size min: 100).
	self caption: message.
	messagePresenter value: detail replaceLfWithCrLf.
	stream := WriteStream on: String new.
	stack := gsProcess stack.
	stack do: 
			[:each |
			stream
				nextPutAll: each;
				cr].
	stackPresenter value: stream contents.
	self model: #terminate	"If window is closed without any buttons pressed!!"! !
!JadeErrorShell categoriesFor: #doCopy!public! !
!JadeErrorShell categoriesFor: #onViewOpened!public! !

!JadeFileIn methodsFor!

defineMethod: methodString inClassNamed: className inPackageNamed: aPackageName inCategory: categoryName 
 
	| string result |
	string := className , 
		' rwCompileMethod: ' , methodString printString , '
		category: ' , categoryName printString.
	[
		(result := gciSession executeString: string) isNil ifTrue: [^self].
	] on: GsCompileError do: [:ex | 
		(JadeWorkspace showOnSession: gciSession)
			caption: 'Jade Workspace - Compile Error';
			showError: ex list on: string.
		^self.
	].
	result := GsCompileError
		errorListFor: result
		inSession: gciSession.
	(JadeWorkspace showOnSession: gciSession)
		caption: 'Jade Workspace - Compile Error on ' , className;
		showError: result on: methodString.
! !
!JadeFileIn categoriesFor: #defineMethod:inClassNamed:inPackageNamed:inCategory:!public! !

!JadeImageStripper methodsFor!

closeLoginShells
	JadeLoginShell allInstances do: [:each | each view close].
	JadeiteLoginShell allInstances do: [:each | each view close]!

createVersionResource
"
	JadeImageStripper new createVersionResource.
"
	| versionString version |
	versionString := JadeSessionManager getVersion.
	version := (versionString subStrings: $-) first.
	self versionResource
		fileVersion: version;
		productVersion: version;
		stringTables: (LookupTable new
			at: '040904b0' 
			put: (LookupTable new
				at: 'CompanyName' 		put: 'GemTalk Systems LLC';
				at: 'FileDescription' 		put: 'IDE for GemStoneS/64 with Rowan Source Code Control';
				at: 'FileVersion' 			put: versionString;
				at: 'InternalName' 		put: 'Jadeite';
				at: 'LegalCopyright' 		put: 'Copyright  GemTalk Systems 2018';
				at: 'OriginalFilename' 	put: 'Jadeite.exe';
				at: 'ProductName' 		put: 'Jadeite';
				at: 'ProductVersion' 		put: versionString;
				yourself);
			yourself);
		yourself.
!

requiredClasses
	^(super requiredClasses)
		addAll: JadeServer withAllSubclasses;
		addAll: GciError withAllSubclasses;
		addAll: GsError withAllSubclasses;
		addAll: GciLibrary withAllSubclasses;
		addAll: GsHostProcess withAllSubclasses;
		addAll: GsShellCommand withAllSubclasses;
		addAll: GsWin32Service withAllSubclasses;
		add: NTLibrary;
		add: StParseNodeVisitor;
		addAll: StProgramNode withAllSubclasses;
		addAll: StToken withAllSubclasses;
		add: ScintillaIndicator;
		add: WaitOnGemStoneDialog;
		addAll: RowanService withAllSubclasses;
		addAll: RowanCommandResult withAllSubclasses;
		add: AdvancedFindDialog;
		add: JadeiteAdvancedFindDialog; 
		add: IRegExp2;
		yourself!

requiredPackageNames

	^super requiredPackageNames
		add: 'Development System'; 		"to get StKeywordToken>>#preComments"
		add: 'GemStone C Interface';
		add: 'GemStone Session';
		add: 'GemStone Objects';
		add: 'GemStone Services';
		add: 'Jade Inspector';
		add: 'Jade Login';
		add: 'Jade System Browser';
		add: 'Jade Transcript';
		add: 'Jade User Browser';
		add: 'JGF Dolphin';
		add: 'JGF Dolphin MVP Base';
		add: 'JGF Fading Dialog';
		add: 'Jade UI';
		add: 'Object Log Browser';
		add: 'Jade from Dolphin';
		add: 'Jade Process Browser';
		add: 'Rowan UI Base';
		add: 'Rowan STON';
		add: 'Dolphin Announcements';
		yourself! !
!JadeImageStripper categoriesFor: #closeLoginShells!public! !
!JadeImageStripper categoriesFor: #createVersionResource!public! !
!JadeImageStripper categoriesFor: #requiredClasses!public! !
!JadeImageStripper categoriesFor: #requiredPackageNames!public! !

!JadeInspector methodsFor!

displayError: ex
	| errorString instVarNames |
	errorString := 'Error inspecting object ' , model printString , '. Error text: ' , ex printString.
	instVarNames := OrderedCollection new.
	instVarNames add: 'self' -> errorString.
	(model isKindOf: ExternalInteger) ifTrue: [instVarNames add: '-.asOop' -> model value].
	instVarListPresenter
		list: instVarNames;
		selection: instVarNames first. !

displayInstVarError: ex instVar: anObject
	^'Error inspecting object ' , anObject printString , '. Error text: ' , ex printString!

displaySpecials
	| instVarNames |
	((model isKindOf: Character) and: [model asInteger > 255])
		ifTrue: [^self displayUndisplayableCharacter].
	className := model class name.
	documentPresenter value: model.
	instVarNames := OrderedCollection with: 'self' -> model printString.
	instVarNames add: '-.asOop' -> (gciSession executeString: model printString , ' asOop printString').
	instVarListPresenter
		list: instVarNames;
		selection: instVarNames first.
	^instVarNames!

displayUndisplayableCharacter
	| instVarNames |
	className := model class name.
	instVarNames := OrderedCollection with: 'self' -> 'Character not displayable'.
	instVarListPresenter
		list: instVarNames;
		selection: instVarNames first.
	^instVarNames!

onViewClosed
	self gciSession isValidSession
		ifTrue: [RowanBrowserService new releaseWindow: self view handle value session: self gciSession].
	BrowserUpdate current logComment: 'Closing Inspector {' , self identityHash printString , '}'.
	super onViewClosed!

onViewOpened
	super onViewOpened.
	self updateCaption.
	BrowserUpdate current logComment: 'Opening Inspector {' , self identityHash printString , '}'!

printInstVar
	| answeringService |
	^
	[answeringService := RowanAnsweringService new.
	answeringService
		command: #printStringOf:toMaxSize:;
		commandArgs: (Array with: instVarListPresenter selection value value with: self maxPrintStringSize).
	self issueCommand: (Array with: answeringService).
	answeringService answer]
			on: Error
			do: [:ex | self displayInstVarError: ex instVar: instVarListPresenter selection value]!

saveDocument
	self rowanFixMe. "this would be very handy"
	MessageBox notify: 'This feature not yet implemented'!

selectedInstVar
	| string |
	instVarListPresenter selection key = 'self'
		ifTrue: 
			[string := instVarListPresenter selection value.
			documentPresenter value: string.
			^self].
	instVarListPresenter selection key = '-.asOop'
		ifTrue: 
			[documentPresenter value: instVarListPresenter selection value.
			^self].
	string := [self printInstVar] on: GsRuntimeError
				do: 
					[:ex |
					ex errorReport number == 2106
						ifTrue: 
							["Forward reference error"
							ex return: 'an invalid or hidden object (perhaps a LargeObjectNode)'].
					ex pass].
	documentPresenter value: string!

setDocumentPresenterLabel
	(model isKindOf: String) ifTrue: [
		documentPresenter value: model.
		self view caption: 'String (' , model size printString , ' characters)'.
		^self.
	].
	(model isKindOf: ByteArray) ifTrue: [
		documentPresenter value: model printString.
		self view caption: model class name , ' (' , model size printString , ' bytes)'.
		^self.
	].
	(model isKindOf: Integer) ifTrue: [
		documentPresenter value: model printString.
		self view caption: 'Integer'.
		^self.
	].
	model isNil ifTrue: [
		documentPresenter value: model printString.
		self view caption: 'UndefinedObject'.
		^self.
	].
	(model isKindOf: Boolean) ifTrue: [
		documentPresenter value: model printString.
		self view caption: 'Boolean'.
		^self.
	]. 
	(model isKindOf: Character) ifTrue: [
		documentPresenter value: model printString.
		self view caption: 'Character'.
		^self.
	]. 
	(model isKindOf: Float) ifTrue: [
		documentPresenter value: model printString.
		self view caption: 'Float'.
		^self.
	].
	(model isKindOf: Fraction) ifTrue: [
		documentPresenter value: model printString.
		self view caption: 'Fraction'.
		^self.
	].
!

setLastGsShape: name
	codePane setDocumentPresenterWith: (self registry getClass: name)!

shellName
	| inspectionTarget |
	inspectionTarget := className ifNil: [model ifNil: [String new] ifNotNil: [model printString]].
	^'Inspector on ' , inspectionTarget , self shellNameExtraInfo!

shellNameExtraInfo
	(model isKindOf: String) ifTrue: [^' (' , model size printString , ' characters)'].
	(model isKindOf: ByteArray) ifTrue: [^' (' , model size printString , ' bytes)'].
	^String new!

updateCaption
	self caption: (gciSession titleBarFor: self shellName).! !
!JadeInspector categoriesFor: #displayError:!accessing!private! !
!JadeInspector categoriesFor: #displayInstVarError:instVar:!accessing!private! !
!JadeInspector categoriesFor: #displaySpecials!accessing!private! !
!JadeInspector categoriesFor: #displayUndisplayableCharacter!accessing!private! !
!JadeInspector categoriesFor: #onViewClosed!event handling!public! !
!JadeInspector categoriesFor: #onViewOpened!event handling!private! !
!JadeInspector categoriesFor: #printInstVar!accessing!private! !
!JadeInspector categoriesFor: #saveDocument!menu handlers!public! !
!JadeInspector categoriesFor: #selectedInstVar!accessing!private! !
!JadeInspector categoriesFor: #setDocumentPresenterLabel!displaying!private! !
!JadeInspector categoriesFor: #setLastGsShape:!accessing!private! !
!JadeInspector categoriesFor: #shellName!displaying!private! !
!JadeInspector categoriesFor: #shellNameExtraInfo!displaying!private! !
!JadeInspector categoriesFor: #updateCaption!displaying!private! !

!JadeInspector class methodsFor!

defaultInspectorClass
	^JadeiteInspector!

resource_Default_view
	"Answer the literal data from which the 'Default view' resource can be reconstituted.
	DO NOT EDIT OR RECATEGORIZE THIS METHOD.

	If you wish to modify this resource evaluate:
	ViewComposer openOn: (ResourceIdentifier class: self selector: #resource_Default_view)
	"

	^#(#'!!STL' 4 788558 10 ##(Smalltalk.STBViewProxy) ##(Smalltalk.ShellView) 34 27 nil nil 8 #(13565952 65536) 416 nil 524550 ##(Smalltalk.ColorRef) 8 4278190080 328198 ##(Smalltalk.Point) 1201 901 551 nil nil nil 416 788230 ##(Smalltalk.BorderLayout) 1 1 410 ##(Smalltalk.ContainerView) 34 15 nil 416 34 2 8 1140850688 131073 576 nil 721158 ##(Smalltalk.SystemColor) 31 nil 7 nil nil nil 576 1180166 ##(Smalltalk.ProportionalLayout) 170 176 8 #() false 170 192 720 nil 983302 ##(Smalltalk.MessageSequence) 138 144 34 1 721670 ##(Smalltalk.MessageSend) #createAt:extent: 34 2 514 1 1 514 1169 49 576 983302 ##(Smalltalk.WINDOWPLACEMENT) 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 0 0 0 0 72 2 0 0 24 0 0 0] 34 1 410 ##(Smalltalk.Toolbar) 34 25 nil 576 34 2 8 1409288972 131137 960 nil 466 8 4278190080 nil 519 nil 263174 ##(Smalltalk.Font) nil true 459014 ##(Smalltalk.LOGFONT) 8 #[243 255 255 255 0 0 0 0 0 0 0 0 0 0 0 0 144 1 0 0 0 0 0 0 3 2 1 34 65 114 105 97 108 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] 514 193 193 nil 960 466 1040 8 4294906585 170 192 720 170 192 34 2 13017 1115910 ##(Smalltalk.ToolbarIconButton) 13017 nil 960 1 1180998 4 ##(Smalltalk.CommandDescription) #openNavigationInspector 8 'Open Navigation Inspector' 1 1 263494 3 ##(Smalltalk.Icon) nil true 1572870 ##(Smalltalk.ImageRelativeFileLocator) 8 'BasicInspector.ico' 2032142 ##(Smalltalk.STBExternalResourceLibraryProxy) 8 'dolphindr7.dll' nil 395334 3 ##(Smalltalk.Bitmap) nil true nil nil nil nil 3 514 33 33 1 34 1 1248 170 176 34 2 1456 1 nil 1 nil 514 33 33 514 45 45 nil 656198 1 ##(Smalltalk.FlowLayout) 1 1 1 754 138 144 34 2 818 #createAt:extent: 34 2 514 1 1 514 1169 49 960 818 #updateSizePosted 720 960 898 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 0 0 0 0 72 2 0 0 24 0 0 0] 8 #() 514 193 193 nil 27 1776 nil 27 nil nil nil 410 ##(Smalltalk.ContainerView) 34 15 nil 416 34 2 8 1140850688 131073 1792 nil nil nil 7 nil nil nil 1792 674 170 176 720 false 170 192 34 4 410 ##(Smalltalk.ReferenceView) 34 14 nil 1792 34 2 8 1140850688 131073 1920 nil 466 8 4278190080 nil 7 nil nil nil 1920 1180166 ##(Smalltalk.ResourceIdentifier) ##(Smalltalk.CodeSourcePresenter) #resource_Default_view nil 754 138 144 34 1 818 #createAt:extent: 34 2 514 589 1 514 581 735 1920 898 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 38 1 0 0 0 0 0 0 72 2 0 0 111 1 0 0] 720 1776 nil 27 8 'codePane' 410 ##(Smalltalk.ListBox) 34 17 nil 1792 34 2 8 1144062209 1025 2208 590662 2 ##(Smalltalk.ListModel) 138 144 720 nil 1310726 ##(Smalltalk.IdentitySearchPolicy) 466 8 4278190080 nil 7 nil nil nil 2208 nil 8 4294906519 459270 ##(Smalltalk.Message) #key 8 #() 720 false 754 138 144 34 2 818 #createAt:extent: 34 2 514 1 1 514 579 735 2208 818 #horizontalExtent: 8 #(0) 2208 898 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 0 0 0 0 33 1 0 0 111 1 0 0] 8 #() 1776 nil 27 8 'instVarList' nil 754 138 144 34 1 818 #createAt:extent: 34 2 514 1 49 514 1169 735 1792 898 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 24 0 0 0 72 2 0 0 135 1 0 0] 34 3 2208 410 ##(Smalltalk.Splitter) 34 12 nil 1792 34 2 8 1140850688 1 2816 nil 466 8 4278190080 nil 519 nil nil nil 2816 754 138 144 34 1 818 #createAt:extent: 34 2 514 579 1 514 11 735 2816 898 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 33 1 0 0 0 0 0 0 38 1 0 0 111 1 0 0] 8 #() 1776 nil 27 1920 1776 nil 27 170 192 720 nil 461638 4 ##(Smalltalk.MenuBar) nil true 34 3 265030 4 ##(Smalltalk.Menu) nil true 34 1 984134 2 ##(Smalltalk.CommandMenuItem) 1 1266 #exit 8 'E&xit' 17639 1 nil nil nil 8 '&File' nil 1 nil nil 13061 nil nil 3138 nil true 34 15 3186 1 1266 #undo 8 '&Undo' 9397 1 nil nil nil 3186 1 1266 #redo 8 'R&edo' 9395 1 nil nil nil 983366 1 ##(Smalltalk.DividerMenuItem) 4097 3186 1 1266 #editCut 8 'Cu&t' 9393 1 nil nil nil 3186 1 1266 #editCopy 8 '&Copy' 9351 1 nil nil nil 3186 1 1266 #editPaste 8 '&Paste' 9389 1 nil nil nil 3186 1 1266 #editSelectAll 8 'Select &All' 9347 1 nil nil nil 3186 1 1266 #editDelete 8 '&Delete' 1629 1 nil nil nil 3394 4097 3186 1 1266 #editFind 8 '&Find...' 9357 1 nil nil nil 3186 1 1266 #editFindNext 8 'Find &Next' 9359 1 nil nil nil 3186 1 1266 #editReplace 8 '&Replace...' 9361 1 nil nil nil 3394 4097 3186 1 1266 #addQuotesToSelection 8 'Add &Quotes' 1 1 nil nil nil 3186 1 1266 #removeQuotesFromSelection 8 'Re&move Quotes' 1 1 nil nil nil 8 '&Edit' nil 1 nil nil 13087 nil nil 3138 nil true 34 9 3186 1 1266 #abortTransaction 8 '&Abort Transaction' 1 1 nil nil nil 3186 1 1266 #commitTransaction 8 '&Commit Transaction' 1 1 nil nil nil 3394 4097 3186 1 1266 #jadeInspect 8 '&Inspect' 9379 1 nil nil nil 3186 1 1266 #jadeDisplay 8 '&Display' 9353 1 nil nil nil 3186 1 1266 #jadeExecute 8 '&Execute' 9355 1 nil nil nil 3186 1 1266 #fileIn 8 'Fi&le In' 1 1 nil nil nil 3394 4097 3186 1 1266 #openDictionaryBrowser 8 '&Browse Classes' 9349 1 nil nil nil 8 '&Jadeite' nil 1 nil nil 13103 nil nil 8 '' nil 1 nil nil nil nil nil nil nil nil 1 nil nil nil nil 1 nil nil 754 138 144 34 3 818 #createAt:extent: 34 2 514 7679 21 514 1201 901 416 818 #text: 34 1 8 'Jade Object Inspector' 416 818 #updateMenuBar 720 416 898 8 #[44 0 0 0 0 0 0 0 0 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 14 0 0 10 0 0 0 87 17 0 0 204 1 0 0] 34 2 576 1792 1776 nil 27 )!

resource_Special_view
	"Answer the literal data from which the 'Special view' resource can be reconstituted.
	DO NOT EDIT OR RECATEGORIZE THIS METHOD.

	If you wish to modify this resource evaluate:
	ViewComposer openOn: (ResourceIdentifier class: self selector: #resource_Special_view)
	"

	^#(#'!!STL' 4 788558 10 ##(Smalltalk.STBViewProxy) ##(Smalltalk.ShellView) 34 27 nil nil 8 #(13565952 65536) 416 nil 524550 ##(Smalltalk.ColorRef) 8 4278190080 328198 ##(Smalltalk.Point) 1201 901 551 nil nil nil 416 1180166 ##(Smalltalk.ProportionalLayout) 170 176 8 #() false 170 192 34 2 410 ##(Smalltalk.MultilineTextEdit) 34 16 nil 416 34 2 8 1143017796 1025 640 nil 466 8 4278190080 nil 7 nil nil nil 640 nil 8 4294907415 852486 ##(Smalltalk.NullConverter) nil nil 11 983302 ##(Smalltalk.MessageSequence) 138 144 34 1 721670 ##(Smalltalk.MessageSend) #createAt:extent: 34 2 514 1 1 514 1169 783 640 983302 ##(Smalltalk.WINDOWPLACEMENT) 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 0 0 0 0 72 2 0 0 135 1 0 0] 8 #() 514 193 193 nil 27 8 'document' nil 461638 4 ##(Smalltalk.MenuBar) nil true 34 3 265030 4 ##(Smalltalk.Menu) nil true 34 1 984134 2 ##(Smalltalk.CommandMenuItem) 1 1180998 4 ##(Smalltalk.CommandDescription) #exit 8 'E&xit' 17639 1 nil nil nil 8 '&File' nil 1 nil nil 14955 nil nil 1074 nil true 34 15 1122 1 1154 #undo 8 '&Undo' 9397 1 nil nil nil 1122 1 1154 #redo 8 'R&edo' 9395 1 nil nil nil 983366 1 ##(Smalltalk.DividerMenuItem) 4097 1122 1 1154 #editCut 8 'Cu&t' 9393 1 nil nil nil 1122 1 1154 #editCopy 8 '&Copy' 9351 1 nil nil nil 1122 1 1154 #editPaste 8 '&Paste' 9389 1 nil nil nil 1122 1 1154 #editSelectAll 8 'Select &All' 9347 1 nil nil nil 1122 1 1154 #editDelete 8 '&Delete' 1629 1 nil nil nil 1346 4097 1122 1 1154 #editFind 8 '&Find...' 9357 1 nil nil nil 1122 1 1154 #editFindNext 8 'Find &Next' 9359 1 nil nil nil 1122 1 1154 #editReplace 8 '&Replace...' 9361 1 nil nil nil 1346 4097 1122 1 1154 #addQuotesToSelection 8 'Add &Quotes' 1 1 nil nil nil 1122 1 1154 #removeQuotesFromSelection 8 'Re&move Quotes' 1 1 nil nil nil 8 '&Edit' nil 1 nil nil 14981 nil nil 1074 nil true 34 9 1122 1 1154 #abortTransaction 8 '&Abort Transaction' 1 1 nil nil nil 1122 1 1154 #commitTransaction 8 '&Commit Transaction' 1 1 nil nil nil 1346 4097 1122 1 1154 #jadeInspect 8 '&Inspect' 9379 1 nil nil nil 1122 1 1154 #jadeDisplay 8 '&Display' 9353 1 nil nil nil 1122 1 1154 #jadeExecute 8 '&Execute' 9355 1 nil nil nil 1122 1 1154 #fileIn 8 'Fi&le In' 1 1 nil nil nil 1346 4097 1122 1 1154 #openDictionaryBrowser 8 '&Browse Classes' 9349 1 nil nil nil 8 '&Jadeite' nil 1 nil nil 14997 nil nil 8 '' nil 1 nil nil nil nil nil nil nil nil 1 nil nil nil nil 1 nil nil 786 138 144 34 3 850 #createAt:extent: 34 2 514 7679 21 514 1201 901 416 850 #text: 34 1 8 'Jade Object Inspector' 416 850 #updateMenuBar 592 416 930 8 #[44 0 0 0 0 0 0 0 0 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 14 0 0 10 0 0 0 87 17 0 0 204 1 0 0] 34 1 640 992 nil 27 )!

setNavigationInspector

	self setDefaultInspectorClass: JadeiteInspector!

showOn: anObject session: aGciSession
	^JadeiteInspector showOn: anObject session: aGciSession! !
!JadeInspector class categoriesFor: #defaultInspectorClass!public! !
!JadeInspector class categoriesFor: #resource_Default_view!public!resources-views! !
!JadeInspector class categoriesFor: #resource_Special_view!public!resources-views! !
!JadeInspector class categoriesFor: #setNavigationInspector!public! !
!JadeInspector class categoriesFor: #showOn:session:!public! !

!JadeiteSUnitAbstractPresenter methodsFor!

methodListPresenter
	^methodListPresenter!

methodListPresenter: anObject
	methodListPresenter := anObject! !
!JadeiteSUnitAbstractPresenter categoriesFor: #methodListPresenter!accessing!private! !
!JadeiteSUnitAbstractPresenter categoriesFor: #methodListPresenter:!accessing!private! !

!JadeiteSUnitInClassPresenter methodsFor!

registerPresentersForUpdates
	BrowserUpdate current register: methodListPresenter selector: #testResultUpdate:browser: browser: self.!

testClassService

	^testClassService!

testClassService: classService
	classService ifNil: [^self].
	testClassService := classService.
	textResultPresenter value: String new.
	methodListPresenter view invalidate.
	textResultPresenter view backcolor: Color face3d.
	classService updateListIn: methodListPresenter from: classService visibleTests! !
!JadeiteSUnitInClassPresenter categoriesFor: #registerPresentersForUpdates!public!register presenters! !
!JadeiteSUnitInClassPresenter categoriesFor: #testClassService!accessing!public! !
!JadeiteSUnitInClassPresenter categoriesFor: #testClassService:!accessing!public! !

!JadeiteSUnitPresenter methodsFor!

browseClass
	| shell selection |
	selection := classListPresenter selections isEmpty
				ifTrue: [^MessageBox notify: 'No class selected']
				ifFalse: [classListPresenter selections first].
	shell := JadeiteBrowser showOnSession: gciSession.
	shell currentCard updateAfterFindClass: selection.
	^shell!

browseMethods
	| browser |
	self updateServices: methodListPresenter selections. 
	(browser := JadeiteMethodListBrowser showOnSession: gciSession) primaryPresenter
		methods: methodListPresenter selections
		selecting: nil.
	^browser!

classListPresenter
	^classListPresenter!

methodListPresenter
	^methodListPresenter!

onViewClosed
	super onViewClosed.
	BrowserUpdate current logComment: 'Closing SUnit Browser {' , self identityHash printString , '}'.
	subPresenters do: [:presenter | BrowserUpdate current removeEventsTriggeredFor: presenter]!

onViewOpened
	BrowserUpdate current logComment: 'Opening SUnit Browser {' , self identityHash printString , '}'.
	testCounter := Array with: 0 with: OrderedCollection new.
	super onViewOpened.
	self registerPresentersForUpdates.
	status := ValueHolder new.
	(self view viewNamed: 'statusPackages') model: status.
	(self view viewNamed: 'statusTestsClasses') model: status.
	(self view viewNamed: 'statusTestCases') model: status.
	(self view viewNamed: 'statusTestCounter') model: status.
	self updatePackages. !

packageListPresenter
	^packageListPresenter!

queryCommand: commandQuery
	commandQuery isEnabled: true.
	(#(#browseMethods #debug #runSelected) includes: commandQuery command)
		ifTrue: 
			[methodListPresenter selections isEmpty ifTrue: [commandQuery isEnabled: false].
			^true].
	(#(#browseClass) includes: commandQuery command)
		ifTrue: 
			[classListPresenter selections isEmpty ifTrue: [commandQuery isEnabled: false].
			^true].
	^true!

refresh
	| packageSelections classSelections methodSelections |
	packageSelections := packageListPresenter selections.
	classSelections := classListPresenter selections.
	methodSelections := methodListPresenter selections.
	self updatePackages.
	packageListPresenter selections: (packageListPresenter list
				select: [:packageService | packageSelections includes: packageService]).
	classListPresenter selections: (classListPresenter list
				select: [:packageService | classSelections includes: packageService]).
	methodListPresenter selections: (methodListPresenter list
				select: [:packageService | methodSelections includes: packageService]).
	self reset!

registerPresentersForUpdates
	BrowserUpdate current register: packageListPresenter selector: #testPackages:.
	BrowserUpdate current register: classListPresenter 	selector: #testClasses:.
	BrowserUpdate current register: classListPresenter 	selector: #renamedClass:browser: browser: self.
	BrowserUpdate current register: methodListPresenter selector: #sunitMethodsUpdate:browser: browser: self.
	BrowserUpdate current register: methodListPresenter selector: #testResultUpdate:browser: browser: self.!

update: newMethods orRemove: removals
	| listModel |
	methodListPresenter model do: 
			[:existing |
			| new |
			new := newMethods detect: [:newService | newService = existing]
						ifNone: 
							[removals add: existing.
							nil].
			new
				ifNotNil: 
					[existing replicateFrom: new.
					new replicateFrom: existing.
					newMethods remove: new	"order matters so we get the right test result"]].
	listModel := ListModel withAll: ((methodListPresenter model union: newMethods)
						asSortedCollection: [:x :y | x selector < y selector]).
	listModel removeAll: removals. 
	methodListPresenter model: listModel.
	methodListPresenter view invalidate. !

updateClasses
	| packageServices |
	self initializeClassList.
	packageServices := packageListPresenter selections.
	packageServices do: [:packageService | packageService command: #testClasses].
	self issueCommand: packageServices!

updateMethods
	| classServices |
	classServices := classListPresenter selections.
	classServices do: 
			[:service |
			service
				updateAfterCommand: false;
				command: #fastRefresh].
	self issueCommand: classServices.
	classServices do: [:service | service updateAfterCommand: true].
	^self updateMethodsFrom: classServices!

updateMethodsFrom: classServices
	| newMethods selectedSelectors removals |
	classServices isEmpty ifTrue: [^methodListPresenter list: ListModel new].
	selectedSelectors := methodListPresenter selections
				collect: [:methodService | methodService selector].
	removals := OrderedCollection new.
	newMethods := Set new.
	classServices do: [:classService | newMethods addAll: classService visibleTests].
	self update: newMethods orRemove: removals.
	methodListPresenter selections: (methodListPresenter model
				select: [:methodService | selectedSelectors includes: methodService selector]).
	methodListPresenter view invalidate!

updatePackages
	| browserService |
	browserService := RowanBrowserService new.
	browserService command: #packagesWithTests.
	self issueCommand: (Array with: browserService).
	testCounter at: 1 put: browserService testCount. ! !
!JadeiteSUnitPresenter categoriesFor: #browseClass!event handlers!public! !
!JadeiteSUnitPresenter categoriesFor: #browseMethods!event handlers!public! !
!JadeiteSUnitPresenter categoriesFor: #classListPresenter!accessing!private! !
!JadeiteSUnitPresenter categoriesFor: #methodListPresenter!accessing!private! !
!JadeiteSUnitPresenter categoriesFor: #onViewClosed!event handlers!public! !
!JadeiteSUnitPresenter categoriesFor: #onViewOpened!event handlers!public! !
!JadeiteSUnitPresenter categoriesFor: #packageListPresenter!accessing!private! !
!JadeiteSUnitPresenter categoriesFor: #queryCommand:!event handlers!public! !
!JadeiteSUnitPresenter categoriesFor: #refresh!event handlers!public! !
!JadeiteSUnitPresenter categoriesFor: #registerPresentersForUpdates!public!register presenters! !
!JadeiteSUnitPresenter categoriesFor: #update:orRemove:!event handlers!private! !
!JadeiteSUnitPresenter categoriesFor: #updateClasses!event handlers!public! !
!JadeiteSUnitPresenter categoriesFor: #updateMethods!event handlers!public! !
!JadeiteSUnitPresenter categoriesFor: #updateMethodsFrom:!event handlers!public! !
!JadeiteSUnitPresenter categoriesFor: #updatePackages!event handlers!public! !

!JadeLoginShell methodsFor!

aboutJadeite
	"See also JadeTextDocument>>#'aboutJadeite'"

	self class aboutJadeite! !
!JadeLoginShell categoriesFor: #aboutJadeite!public! !

!JadeMethodListPresenter methodsFor!

newProjectsBrowser

	^JadeiteBrowser showOnSession: gciSession!

newWorkspace

	^(JadeWorkspace showOnSession: gciSession)!

searchForAnyTextMatching: aString

	| sourceView selectionRange textRange found |
	sourceView := methodSourcePresenter view viewNamed: 'document'.
	selectionRange := sourceView selectionRange.
	textRange := sourceView textRange.
	found := sourceView
		find: aString
		range: (selectionRange stop + 1 to: textRange stop)
		flags: 4. "SCFIND_MATCHCASE"
	0 < found stop ifTrue: [
		sourceView
			selectionStart: found start 
			end: found stop.
		sourceView ensureVisible: found stop.
	].
! !
!JadeMethodListPresenter categoriesFor: #newProjectsBrowser!menu handlers!public! !
!JadeMethodListPresenter categoriesFor: #newWorkspace!menu handlers!public! !
!JadeMethodListPresenter categoriesFor: #searchForAnyTextMatching:!public! !

!JadeNavigationInspector methodsFor!

browseClass
	| shell classService |
	classService := RowanClassService new name: className subStrings first.	"strip off 'class' if meta"
	BrowserUpdate current updateService: classService session: gciSession.
	shell := JadeiteBrowser showOnSession: gciSession.
	shell currentCard updateAfterFindClass: classService.
	^shell!

setNewInspectedObject
	self model: (self gciSession oopTypeWithOop: (oopsCollection at: objectIndex)).
	self displayObjectSelecting: nil.
	self updateCaption! !
!JadeNavigationInspector categoriesFor: #browseClass!menu handlers support!private! !
!JadeNavigationInspector categoriesFor: #setNewInspectedObject!public! !

!JadeNavigationInspector class methodsFor!

resource_Default_view
	"Answer the literal data from which the 'Default view' resource can be reconstituted.
	DO NOT EDIT OR RECATEGORIZE THIS METHOD.

	If you wish to modify this resource evaluate:
	ViewComposer openOn: (ResourceIdentifier class: self selector: #resource_Default_view)
	"

	^#(#'!!STL' 4 788558 10 ##(Smalltalk.STBViewProxy) ##(Smalltalk.ShellView) 34 27 nil nil 8 #(13565952 65536) 416 nil 524550 ##(Smalltalk.ColorRef) 8 4278190080 328198 ##(Smalltalk.Point) 1201 901 551 nil nil nil 416 788230 ##(Smalltalk.BorderLayout) 1 1 410 ##(Smalltalk.ContainerView) 34 15 nil 416 34 2 8 1140850688 131073 576 nil 721158 ##(Smalltalk.SystemColor) 31 nil 7 nil nil nil 576 1180166 ##(Smalltalk.ProportionalLayout) 170 176 8 #() false 170 192 720 nil 983302 ##(Smalltalk.MessageSequence) 138 144 34 1 721670 ##(Smalltalk.MessageSend) #createAt:extent: 34 2 514 1 1 514 1169 49 576 983302 ##(Smalltalk.WINDOWPLACEMENT) 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 0 0 0 0 72 2 0 0 24 0 0 0] 34 1 410 ##(Smalltalk.Toolbar) 34 25 nil 576 34 2 8 1409288972 131137 960 nil 466 8 4278190080 nil 519 nil 263174 ##(Smalltalk.Font) nil true 459014 ##(Smalltalk.LOGFONT) 8 #[243 255 255 255 0 0 0 0 0 0 0 0 0 0 0 0 144 1 0 0 0 0 0 0 3 2 1 34 65 114 105 97 108 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] 514 193 193 nil 960 466 1040 8 4294911349 170 192 720 170 192 34 8 10121 1115910 ##(Smalltalk.ToolbarIconButton) 10121 nil 960 1 1180998 4 ##(Smalltalk.CommandDescription) #getNextObject 8 'Next Object' 1 1 263494 3 ##(Smalltalk.Icon) nil true 1572870 ##(Smalltalk.ImageRelativeFileLocator) 8 'HistoryForward.ico' 2032142 ##(Smalltalk.STBExternalResourceLibraryProxy) 8 'dolphindr7.dll' nil 395334 3 ##(Smalltalk.Bitmap) nil true nil nil nil nil 3 514 33 33 1 10123 1234 10123 nil 960 1 1266 #removeObject 8 'Remove Object' 1 1 1314 nil true 1360 8 'False.ico' 1408 1442 nil true nil nil nil nil 3 514 33 33 1 10125 1234 10125 nil 960 1 1266 #openNavigationInspector 8 'Open Navigation Inspector' 1 1 1314 nil true 1360 8 'BasicInspector.ico' 1408 1442 nil true nil nil nil nil 3 514 33 33 1 10119 1234 10119 nil 960 1 1266 #getPreviousObject 8 'Previous Object' 1 1 1314 nil true 1360 8 'HistoryBack.ico' 1408 1442 nil true nil nil nil nil 3 514 33 33 1 34 6 1712 1248 1050118 ##(Smalltalk.ToolbarSeparator) nil nil 960 3 nil 1 1488 1842 nil nil 960 3 nil 1 1600 170 176 34 8 1456 3 1568 5 1680 7 1792 1 nil 1 nil 514 33 33 514 45 45 nil 656198 1 ##(Smalltalk.FlowLayout) 1 1 1 754 138 144 34 2 818 #createAt:extent: 34 2 514 1 1 514 1169 49 960 818 #updateSizePosted 720 960 898 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 0 0 0 0 72 2 0 0 24 0 0 0] 8 #() 514 193 193 nil 27 2160 nil 27 nil nil nil 410 ##(Smalltalk.ContainerView) 34 15 nil 416 34 2 8 1140850688 131073 2176 nil 642 31 nil 7 nil nil nil 2176 674 170 176 34 2 410 ##(Smalltalk.ReferenceView) 34 14 nil 2176 34 2 8 1140850688 131073 2304 nil 466 8 4278190080 nil 7 nil nil nil 2304 1180166 ##(Smalltalk.ResourceIdentifier) ##(Smalltalk.CodeSourcePresenter) #resource_Default_view nil 754 138 144 34 1 818 #createAt:extent: 34 2 514 397 1 514 773 735 2304 898 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 198 0 0 0 0 0 0 0 72 2 0 0 111 1 0 0] 720 2160 nil 27 5 false 170 192 34 4 2304 8 'codePane' 410 ##(Smalltalk.ListBox) 34 17 nil 2176 34 2 8 1144062209 1025 2624 590662 2 ##(Smalltalk.ListModel) 138 144 720 nil 1310726 ##(Smalltalk.IdentitySearchPolicy) 466 8 4278190080 nil 7 nil nil nil 2624 nil 8 4294912081 459270 ##(Smalltalk.Message) #key 8 #() 720 false 754 138 144 34 2 818 #createAt:extent: 34 2 514 1 1 514 387 735 2624 818 #horizontalExtent: 8 #(0) 2624 898 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 0 0 0 0 193 0 0 0 111 1 0 0] 8 #() 2160 nil 27 8 'instVarList' nil 754 138 144 34 1 818 #createAt:extent: 34 2 514 1 49 514 1169 735 2176 898 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 24 0 0 0 72 2 0 0 135 1 0 0] 34 3 2624 410 ##(Smalltalk.Splitter) 34 12 nil 2176 34 2 8 1140850688 1 3232 nil 466 8 4278190080 nil 519 nil nil nil 3232 754 138 144 34 1 818 #createAt:extent: 34 2 514 387 1 514 11 735 3232 898 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 193 0 0 0 0 0 0 0 198 0 0 0 111 1 0 0] 8 #() 2160 nil 27 2304 2160 nil 27 170 192 720 nil 461638 4 ##(Smalltalk.MenuBar) nil true 34 3 265030 4 ##(Smalltalk.Menu) nil true 34 1 984134 2 ##(Smalltalk.CommandMenuItem) 1 1266 #exit 8 'E&xit' 17639 1 nil nil nil 8 '&File' nil 1 nil nil 10075 nil nil 3554 nil true 34 15 3602 1 1266 #undo 8 '&Undo' 9397 1 nil nil nil 3602 1 1266 #redo 8 'R&edo' 9395 1 nil nil nil 983366 1 ##(Smalltalk.DividerMenuItem) 4097 3602 1 1266 #editCut 8 'Cu&t' 9393 1 nil nil nil 3602 1 1266 #editCopy 8 '&Copy' 9351 1 nil nil nil 3602 1 1266 #editPaste 8 '&Paste' 9389 1 nil nil nil 3602 1 1266 #editSelectAll 8 'Select &All' 9347 1 nil nil nil 3602 1 1266 #editDelete 8 '&Delete' 1629 1 nil nil nil 3810 4097 3602 1 1266 #editFind 8 '&Find...' 9357 1 nil nil nil 3602 1 1266 #editFindNext 8 'Find &Next' 9359 1 nil nil nil 3602 1 1266 #editReplace 8 '&Replace...' 9361 1 nil nil nil 3810 4097 3602 1 1266 #addQuotesToSelection 8 'Add &Quotes' 1 1 nil nil nil 3602 1 1266 #removeQuotesFromSelection 8 'Re&move Quotes' 1 1 nil nil nil 8 '&Edit' nil 1 nil nil 10101 nil nil 3554 nil true 34 9 3602 1 1266 #abortTransaction 8 '&Abort Transaction' 1 1 nil nil nil 3602 1 1266 #commitTransaction 8 '&Commit Transaction' 1 1 nil nil nil 3810 4097 3602 1 1266 #jadeInspect 8 '&Inspect' 9379 1 nil nil nil 3602 1 1266 #jadeDisplay 8 '&Display' 9353 1 nil nil nil 3602 1 1266 #jadeExecute 8 '&Execute' 9355 1 nil nil nil 3602 1 1266 #fileIn 8 'Fi&le In' 1 1 nil nil nil 3810 4097 3602 1 1266 #browseClass 8 '&Browse Class' 9377 1 nil nil nil 8 '&Jadeite' nil 1 nil nil 10117 nil nil 8 '' nil 1 nil nil nil nil nil nil nil nil 1 nil nil nil nil 1 nil nil 754 138 144 34 3 818 #createAt:extent: 34 2 514 7679 21 514 1201 901 416 818 #text: 34 1 8 'Jade Object Navigation Inspector' 416 818 #updateMenuBar 720 416 898 8 #[44 0 0 0 0 0 0 0 0 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 14 0 0 10 0 0 0 87 17 0 0 204 1 0 0] 34 2 576 2176 2160 nil 27 )! !
!JadeNavigationInspector class categoriesFor: #resource_Default_view!public!resources-views! !

!JadePresenter methodsFor!

abortTransaction
	"Even if it takes a windy path, try to make sure
	all aborts in Jadeite pass through here"

	| browserService services |
	services := BrowserUpdate current selectedServices asSet asArray.
	browserService := RowanBrowserService new
				command: #abortTransactionAndUpdateServices:;
				commandArgs: (Array with: services).
	self issueCommand: (Array with: browserService).
	Sound informationBeep!

autoCommitExecutionString
	^'RowanService autoCommit ifTrue:[System commitTransaction].'!

basicCloneProject: path root: root
	| service |
	service := RowanProjectService new.
	service
		command: #newGitProject:root:useSsh:;
		commandArgs: (Array
					with: path
					with: root
					with: true).
	self issueCommand: (Array with: service)!

browseBreakpoints
	^self class browseBreakpointsIn: self gciSession!

browseClassReferences: className
	^self class browseClassReferences: className session: self gciSession!

browseHierarchyImplementorsOf: string className: className
	^self class
		browseHierarchyImplementorsOf: string
		className: className
		session: self gciSession!

browseHierarchySendersOf: string className: className
	^self class 
		browseHierarchySendersOf: string
		className: className
		session: self gciSession!

browseImplementorsOf
	
	^JadePresenter browseImplementorsIn: self gciSession
!

browseImplementorsOf: string
	^self class browseImplementorsOf: string session: self gciSession!

browseLiteralReferences
	^self class browseLiteralReferences: self gciSession!

browseMethodsContaining
	^self class browseMethodsContaining: self gciSession!

browseSelectedClassIn: documentPresenter newTab: openNewTab
	| classService |
	classService := self serviceFromSelection: documentPresenter.
	classService ifNil: [^self].
	^self openBrowserInNewTab: openNewTab on: classService!

browseSendersOf
	
	^JadePresenter browseSendersIn: self gciSession
!

browseSendersOf: string
	^self class browseSendersOf: string session: self gciSession!

clearAllBreaks
	^self class clearAllBreaksIn: self gciSession!

clearMethodBreakpoints: methodServices
	^self class clearMethodBreakpoints: methodServices in: self gciSession!

compilationWarningFrom: methodServices
	methodServices do: 
			[:methodService |
			methodService compilationWarnings
				ifNotNil: 
					[:warningStream |
					| rs output |
					rs := ReadStream on: warningStream.
					output := 'WARNING: '.
					[rs atEnd] whileFalse: 
							[output := output , (rs upToAll: 'WARNING: ').
							output := output , (rs upTo: Character lf).
							output := output , '; '].
					^output]].
	^nil!

currentMethodSourceFrom: sourceString

	| source fromStream writeStream |
	sourceString isEmpty ifTrue:[^sourceString]. 
	fromStream := ReadStream on: sourceString.
	writeStream := WriteStream on: String new.
	[
		fromStream atEnd not.
	] whileTrue: [
		| char |
		(char := fromStream next) == Character cr ifTrue: [
			fromStream peek ~~ Character lf ifTrue: [
				writeStream nextPut: Character lf.
			].
		] ifFalse: [
			writeStream nextPut: char.
		].
	].
	source := writeStream contents.
	[
		source last codePoint <= 32.
	] whileTrue: [
		source := source copyFrom: 1 to: source size - 1.
	].
	^source.
!

currentSelectionOrLine
	^self subclassResponsibility!

displayNoMods: sourcePresenter
	sourcePresenter view
		backcolor: JadeiteTextStyles default colorForNoEdits;
		isModified: false;
		isReadOnly: false.
	self displayUncompilableSourceIn: sourcePresenter!

displayUncompilableSourceIn: sourcePresenter
	sourcePresenter value size < 34 ifTrue: [^self].
	((sourcePresenter value copyFrom: 2 to: 34) equals: 'METHOD SOURCE CANNOT BE DISPLAYED')
		ifTrue: [sourcePresenter view backcolor: JadeiteTextStyles default colorForUndisplayableSource]!

editSaveMethod: classService in: methodSourcePresenter category: category
	| methodSource1 firstVisibleLine caretPosition |
	caretPosition := methodSourcePresenter view caretPosition.
	firstVisibleLine := methodSourcePresenter view lineScroll.
	methodSource1 := self currentMethodSourceFrom: methodSourcePresenter value.
	classService
		command: #saveMethodSource:category:;
		commandArgs: (Array with: methodSource1 with: category).
	[self issueCommand: (Array with: classService)] on: GsCompileError
		do: 
			[:ex |
			self setCompileErrorColor.
			self reportCompileError: ex list in: methodSourcePresenter.
			^false].
	methodSourcePresenter view firstVisibleLine: firstVisibleLine.
	methodSourcePresenter view goto: caretPosition.
	methodSourcePresenter value: methodSource1.
	self setStatusBarDefault.
	self displayNoMods: methodSourcePresenter.
	(self compilationWarningFrom: classService selectedMethods)
		ifNil: [self statusBarText: String new]
		ifNotNil: 
			[:warning |
			self setCompileWarningColor.
			self statusBarText: warning].!

executeSelectionOrLine: contextObject
	| answeringService answer oop |
	oop := (contextObject isKindOf: ExternalInteger)
				ifTrue: [contextObject value]
				ifFalse: [contextObject].	"services wants a local special as a context"
	oop ifNil: [oop := 20].
	answeringService := RowanAnsweringService new.
	answeringService
		command: #exec:context:;
		commandArgs: (Array with: self currentSelectionOrLine with: oop).
	self issueCommand: (Array with: answeringService).
	answer := answeringService answer.
	answer key ifTrue: [answer value: (OopType64 fromInteger: answer value)].
	^answer!

flipAutoCommit
	| browserService |
	browserService := RowanAutoCommitService new.
	browserService command: #flipAutoCommit; commandArgs: Array new. 
	self issueCommand: (Array with: browserService). 
	!

insertCompileErrorText: string into: methodSourcePresenter
	methodSourcePresenter view topShell statusBarText: (string copyFrom: 1 to: string size - 2)!

issueCommand: service
	^self class issueCommands: service session: self gciSession!

openBrowserInNewTab: openNewTab on: classService
	| shell |
	shell := openNewTab
				ifTrue: [self addSystemBrowser]
				ifFalse: [JadeiteBrowser showOnSession: gciSession].
	^shell currentCard updateAfterFindClass: classService!

openProjectBrowserOn: classService selector: selector
	| projectBrowser |
	projectBrowser := JadeiteBrowser showOnSession: gciSession.
	classService ifNil: [^projectBrowser].
	projectBrowser currentCard updateAfterFindClass: classService.
	classService meta ifTrue: [projectBrowser currentCard selectClassTab].
	projectBrowser currentCard findMethod: selector.
	^projectBrowser!

raiseConsole
	| transcript |
	transcript := JadeiteTranscript allInstances
				detect: [:trans | trans gciSession = GciSession current]
				ifNone: [^self].
	transcript view setFocus!

refreshGlobalSelections
	"refresh selections in all browsers."

	| browserService |
	browserService := RowanBrowserService new
				command: #findRemovedServices:;
				commandArgs: (Array with: BrowserUpdate current activeServices asSet asArray).
	BrowserUpdate current issueCommands: (Array with: browserService) session: self gciSession.
	self updateServices: BrowserUpdate current selectedServices!

remoteAutoCommit
	| answeringService |
	answeringService := RowanAnsweringService new.
	answeringService
		command: #autoCommit;
		commandArgs: Array new.
	self issueCommand: (Array with: answeringService).
	^answeringService answer!

reportCompileError: anArrayOfArray in: methodSourcePresenter
	| source position stream string indicators |
	indicators := OrderedCollection new.
	methodSourcePresenter view clearContainerIndicators.
	source := (self currentMethodSourceFrom: methodSourcePresenter value) , Character lf asString.
	position := methodSourcePresenter view caretPosition.
	methodSourcePresenter value: source.
	methodSourcePresenter view caretPosition: position.
	stream := WriteStream on: String new.
	anArrayOfArray do: 
			[:eachArray |
			| range |
			range := self selectionRangeFrom: eachArray source: source.
			string := eachArray at: 3.
			stream nextPutAll: string , '; '.
			indicators add: (ScintillaIndicator
						styleName: #compileError
						range: range
						tag: string)].
	"to help visibility, select first compile failure range"
	methodSourcePresenter view
		selectionRange: (self selectionRangeFrom: anArrayOfArray first source: source).
	methodSourcePresenter view backcolor: JadeiteTextStyles default colorForCompileError.
	methodSourcePresenter view indicators: indicators.
	string := stream contents.
	self insertCompileErrorText: string into: methodSourcePresenter!

selectionRangeFrom: eachArray source: source
	| start |
	start := eachArray at: 2.
	source size - start >= 10 ifFalse: [start := source size - 10].
	^start to: (start + 10 min: source size)!

serviceFromSelection: sourcePresenter
	| range className classService |
	range := sourcePresenter view selectionRange.
	className := sourcePresenter value copyFrom: range start to: range stop.
	className := [gciSession executeString: className , ' class thisClass name'] on: Error
				do: 
					[:ex |
					MessageBox notify: className , ' is an invalid class to browse'.
					^nil].
	classService := RowanClassService named: className.
	self updateService: classService.
	^classService!

setCompileErrorColor
	(self topShell view viewNamed: 'statusBarField') backcolor: Color red faded!

setCompileWarningColor
	(self topShell view viewNamed: 'statusBarField') backcolor: Color yellow faded!

update: services afterStonReplication: stonResults
	^BrowserUpdate current update: services afterStonReplication: stonResults!

updateServices: services
	BrowserUpdate current updateServices: services asSet asArray session: gciSession! !
!JadePresenter categoriesFor: #abortTransaction!public!transaction management! !
!JadePresenter categoriesFor: #autoCommitExecutionString!menu handlers support!public! !
!JadePresenter categoriesFor: #basicCloneProject:root:!menu handlers!private! !
!JadePresenter categoriesFor: #browseBreakpoints!menu handlers!public! !
!JadePresenter categoriesFor: #browseClassReferences:!menu handlers!public! !
!JadePresenter categoriesFor: #browseHierarchyImplementorsOf:className:!browsing!public! !
!JadePresenter categoriesFor: #browseHierarchySendersOf:className:!browsing!public! !
!JadePresenter categoriesFor: #browseImplementorsOf!browsing!public! !
!JadePresenter categoriesFor: #browseImplementorsOf:!browsing!public! !
!JadePresenter categoriesFor: #browseLiteralReferences!browsing!public! !
!JadePresenter categoriesFor: #browseMethodsContaining!browsing!public! !
!JadePresenter categoriesFor: #browseSelectedClassIn:newTab:!Jade!public! !
!JadePresenter categoriesFor: #browseSendersOf!browsing!public! !
!JadePresenter categoriesFor: #browseSendersOf:!browsing!menu handlers!public! !
!JadePresenter categoriesFor: #clearAllBreaks!menu handlers!public! !
!JadePresenter categoriesFor: #clearMethodBreakpoints:!menu handlers!public! !
!JadePresenter categoriesFor: #compilationWarningFrom:!public! !
!JadePresenter categoriesFor: #currentMethodSourceFrom:!compile support!public! !
!JadePresenter categoriesFor: #currentSelectionOrLine!menu handlers support!public! !
!JadePresenter categoriesFor: #displayNoMods:!compile support!displaying!public! !
!JadePresenter categoriesFor: #displayUncompilableSourceIn:!event handlers!public!text tabs!updating! !
!JadePresenter categoriesFor: #editSaveMethod:in:category:!compile support!public! !
!JadePresenter categoriesFor: #executeSelectionOrLine:!menu handlers!private! !
!JadePresenter categoriesFor: #flipAutoCommit!menu handlers!public! !
!JadePresenter categoriesFor: #insertCompileErrorText:into:!compile support!public! !
!JadePresenter categoriesFor: #issueCommand:!browsing support!public! !
!JadePresenter categoriesFor: #openBrowserInNewTab:on:!Jade!public! !
!JadePresenter categoriesFor: #openProjectBrowserOn:selector:!browsing!public! !
!JadePresenter categoriesFor: #raiseConsole!menu handlers!public! !
!JadePresenter categoriesFor: #refreshGlobalSelections!menu handlers!public! !
!JadePresenter categoriesFor: #remoteAutoCommit!browsing support!public! !
!JadePresenter categoriesFor: #reportCompileError:in:!compile support!public! !
!JadePresenter categoriesFor: #selectionRangeFrom:source:!compile support!private! !
!JadePresenter categoriesFor: #serviceFromSelection:!menu handlers!menu handlers support!private! !
!JadePresenter categoriesFor: #setCompileErrorColor!compile support!public! !
!JadePresenter categoriesFor: #setCompileWarningColor!compile support!public! !
!JadePresenter categoriesFor: #update:afterStonReplication:!browsing support!public! !
!JadePresenter categoriesFor: #updateServices:!private!services! !

!JadePresenter class methodsFor!

allClassesIn: session
	| browserService |
	browserService := RowanBrowserService new.
	browserService command: #allClasses.
	self issueCommands: (Array with: browserService) session: session.
	^browserService allClasses ifNil: [Array new]!

basicBrowseClassReferences: className session: session
	| service |
	service := RowanQueryService command: #browseClassReferences: withArgs: (Array with: className).
	self issueCommands: (Array with: service) session: session.
	^service!

basicBrowseMethod: methodService presenter: browser
	methodService
		ifNotNil: 
			[(browser methodListPresenter list includes: methodService)
				ifFalse: [browser categoryListPresenter selection: methodService category].
			browser methodListPresenter selection: methodService]!

browseBreakpointsIn: session
	| service shell menuCommand methodMenu |
	service := RowanQueryService command: #breakPointMethods withArgs: Array new.
	self issueCommands: (Array with: service) session: session.
	shell := self
				openMethodListOn: service
				selectingAnyMatch: String new
				session: session.
	shell updateCaptionFromSearchString: 'Methods Containing BreakPoints'.
	menuCommand := MessageSend receiver: shell primaryPresenter selector: #clearAllBreakpoints.
	methodMenu := shell view menuBar items detect: [:menu | '*Methods*' match: menu text]
				ifNone: [^shell].
	methodMenu addSeparator.
	methodMenu addCommand: menuCommand description: 'Clear All Breakpoints'.
	^shell!

browseClassIn: session
	| classService browser |
	classService := JadeiteFindClassDialog showModal: 'DefaultView' on: (self allClassesIn: session).
	classService
		ifNotNil: 
			[browser := JadeiteBrowser showOnSession: session.
			browser currentCard updateAfterFindClass: classService.
			^browser]!

browseClassReferences: className session: session
	| service browser |
	service := self basicBrowseClassReferences: className session: session.
	browser := self
				openMethodListOn: service
				selecting: className
				session: session.
	browser updateCaption: 'Class References of ''' , className , ''''.
	^browser!

browseClassReferencesInSession: session
	| classService |
	classService := JadeiteFindClassDialog showModal: 'DefaultView' on: (self allClassesIn: session).
	classService
		ifNotNil: [Cursor wait showWhile: [^self browseClassReferences: classService name session: session]]!

browseHierarchyImplementorsOf: string className: className session: session
	| service shell |
	service := RowanQueryService command: #hierarchyImplementorsOf:inClass:
				withArgs: (Array with: string asSymbol with: className).
	self issueCommands: (Array with: service) session: session.
	shell := self
				openMethodListOn: service
				selecting: string
				session: session.
	shell updateCaptionFromSearchString: 'Hierarchy Implementors of ' , string asString printString.
	^shell!

browseHierarchySendersOf: string className: className session: session
	| service shell |
	service := RowanQueryService command: #hierarchySendersOf:inClass:
				withArgs: (Array with: string asSymbol with: className).
	self issueCommands: (Array with: service) session: session.
	shell := self
				openMethodListOn: service
				selecting: string
				session: session.
	shell updateCaptionFromSearchString: 'Hierarchy Senders of ' , string asString printString.
	^shell!

browseImplementorsIn: session
	^self
		promptForMatchingSymbolsIn: session
		actionBlock: [:selector | Cursor wait showWhile: [self browseImplementorsOf: selector session: session]]
		promptCaption: 'Browse Implementors Of ...'
		searchType: 'selector'!

browseImplementorsOf: string session: session
	| service shell |
	service := RowanQueryService command: #implementorsOf: withArgs: (Array with: string asSymbol).
	self issueCommands: (Array with: service) session: session.
	shell := self
				openMethodListOn: service
				selecting: string
				session: session.
	shell updateCaptionFromSearchString: 'Implementors of ' , string asString printString.
	^shell!

browseInstVarReaders: instVarName in: className session: session
	| service shell |
	instVarName ifNil: [^nil].
	service := RowanQueryService command: #instVarReaders:in:
				withArgs: (Array with: instVarName with: className).
	self issueCommands: (Array with: service) session: session.
	shell := self
				openMethodListOn: service
				selectingAnyMatch: instVarName
				session: session.
	shell
		updateCaptionFromSearchString: 'Instance Variable Readers For ' , instVarName asString printString.
	^shell!

browseInstVarWriters: instVarName in: className session: session
	| service shell |
	instVarName ifNil: [^nil].
	service := RowanQueryService command: #instVarWriters:in:
				withArgs: (Array with: instVarName with: className).
	self issueCommands: (Array with: service) session: session.
	shell := self
				openMethodListOn: service
				selectingAnyMatch: instVarName
				session: session.
	shell
		updateCaptionFromSearchString: 'Instance Variable Writers For ' , instVarName asString printString.
	^shell!

browseLiteralReferences: session
	^self browseLiteralReferences: session initialSuggestion: String new!

browseLiteralReferences: session initialSuggestion: initialString
	| string |
	string := Prompter
				on: initialString asValue
				prompt: 'Enter code to be compiled.
Example: To search for literal string add single quotes'
				caption: 'Browse Methods With Literal ...'.
	^Cursor wait showWhile: 
			[[self browseLiteralReferences: string session: session] on: GsCompileError
				do: 
					[:ex |
					MessageBox notify: 'Error compiling expression: ' , string.
					^self browseLiteralReferences: session initialSuggestion: string]]!

browseLiteralReferences: string session: session
	| service shell |
	(string isNil or: [string isEmpty]) ifTrue: [^nil].
	service := RowanQueryService command: #literalReferences: withArgs: (Array with: string).
	self issueCommands: (Array with: service) session: session.
	shell := self
				openMethodListOn: service
				selectingAnyMatch: string
				session: session.
	shell updateCaptionFromSearchString: 'Literal References To ' , string asString printString.
	^shell!

browseMethodsContaining: session
	| string |
	(string := Prompter prompt: 'Enter string:' caption: 'Browse Methods Containing ...') isNil
		ifTrue: [^self].
	^Cursor wait showWhile: [self browseMethodsContaining: string session: session]!

browseMethodsContaining: string session: session
	| service shell |
	service := RowanQueryService command: #methodsContaining: withArgs: (Array with: string).
	self issueCommands: (Array with: service) session: session.
	shell := self
				openMethodListOn: service
				selectingAnyMatch: string
				session: session.
	shell updateCaptionFromSearchString: 'Methods Containing ' , string asString printString.
	^shell!

browseSendersIn: session
	^self
		promptForMatchingSymbolsIn: session
		actionBlock: [:selector | Cursor wait showWhile: [self browseSendersOf: selector session: session]]
		promptCaption: 'Browse Senders Of ...'
		searchType: 'selector'!

browseSendersOf: string session: session
	| service shell |
	service := RowanQueryService command: #sendersOf: withArgs: (Array with: string asSymbol).
	self issueCommands: (Array with: service) session: session.
	shell := self
				openMethodListOn: service
				selecting: string
				session: session.
	shell updateCaptionFromSearchString: 'Senders of ' , string asString printString.
	^shell!

browseSymbolReferencesTo: string session: session
	"do a literal symbol search which will compile the string,
	then strip off the preceding octothorpe before selection"

	| queryService shell basicString |
	queryService := RowanQueryService new
				command: #literalReferences:;
				commandArgs: (Array with: string asSymbol).
	self issueCommands: (Array with: queryService) session: session.
	basicString := string copyWithout: $#.
	shell := self
				openMethodListOn: queryService
				selecting: basicString
				session: session.
	shell updateCaptionFromSearchString: 'References to ' , basicString.
	^shell!

clearAllBreaksIn: session
	| service |
	service := RowanAnsweringService command: #clearAllBreaks withArgs: Array new.
	self issueCommands: (Array with: service) session: session!

clearMethodBreakpoints: methodServices in: session
	| service |
	service := RowanAnsweringService command: #clearMethodBreaks: withArgs: (Array with: methodServices).
	self issueCommands: (Array with: service) session: session!

convertToPattern: wildcardString
	| list |
	list := (wildcardString subStrings: $*) asOrderedCollection.
	list size - 1 to: 1
		by: -1
		do: [:i | list add: $* afterIndex: i].
	wildcardString last = $* ifTrue: [list addLast: $*].
	^list asArray!

findMethodIn: session class: classService presenter: browser
	| methodService |
	methodService := JadeiteFindMethodDialog showModal: 'DefaultView' on: classService.
	^self basicBrowseMethod: methodService presenter: browser!

issueCommands: services session: session
	^BrowserUpdate current issueCommands: services session: session!

openGitHubJadeiteProject
	ShellLibrary default shellOpen: 'https://github.com/GemTalk/Jadeite' directory: ''!

openGitHubRowanProject
	ShellLibrary default shellOpen: 'https://github.com/GemTalk/Rowan' directory: ''!

openMethodListOn: service selecting: string session: session
	| selectionString |
	selectionString := (ReadStream on: string) upTo: $:.
	^JadeiteMethodListBrowser
		openOn: service
		selecting: selectionString
		session: session!

openMethodListOn: service selectingAnyMatch: string session: session
	^JadeiteMethodListBrowser
		openOn: service
		selectingAnyMatch: string
		session: session!

promptFor: aString withCaption: caption
	| string list stream |
	(string := Prompter prompt: 'Enter ' , aString , ':' caption: caption) isNil ifTrue: [^nil].
	((string includes: $:) and: [string includes: Character space])
		ifTrue: 
			[list := string subStrings: Character space.
			list := list select: [:each | each last = $:].
			stream := WriteStream on: String new.
			list do: [:each | stream nextPutAll: each].
			string := stream contents].
	string := string copyWithout: Character space.
	^string!

promptForMatchingSymbolsIn: session actionBlock: aBlock promptCaption: caption searchType: prompt
	| selector symbols |
	(selector := self promptFor: prompt withCaption: caption) isNil ifTrue: [^self].
	selector := selector copyWithout: Character space.
	(selector includes: $*) ifFalse: [^aBlock value: selector].
	symbols := JadeiteSearch
				selectorsFrom: selector
				session: session
				trailingWildcard: false.
	(selector := ChoicePrompter choices: symbols) isNil ifTrue: [^self].
	^aBlock value: selector!

runMethodTests: methodServices in: session
	| answeringService |
	answeringService := RowanAnsweringService new.
	answeringService
		command: #runMethodTests:;
		commandArgs: (Array with: methodServices).
	answeringService := (self issueCommands: (Array with: answeringService) session: session) first.
	^answeringService answer! !
!JadePresenter class categoriesFor: #allClassesIn:!browsing support!private! !
!JadePresenter class categoriesFor: #basicBrowseClassReferences:session:!browsing!browsing support!public! !
!JadePresenter class categoriesFor: #basicBrowseMethod:presenter:!browsing!public! !
!JadePresenter class categoriesFor: #browseBreakpointsIn:!browsing!public! !
!JadePresenter class categoriesFor: #browseClassIn:!browsing!public! !
!JadePresenter class categoriesFor: #browseClassReferences:session:!browsing!public! !
!JadePresenter class categoriesFor: #browseClassReferencesInSession:!browsing!public! !
!JadePresenter class categoriesFor: #browseHierarchyImplementorsOf:className:session:!browsing!public! !
!JadePresenter class categoriesFor: #browseHierarchySendersOf:className:session:!browsing!public! !
!JadePresenter class categoriesFor: #browseImplementorsIn:!browsing!public! !
!JadePresenter class categoriesFor: #browseImplementorsOf:session:!browsing!public! !
!JadePresenter class categoriesFor: #browseInstVarReaders:in:session:!browsing!public! !
!JadePresenter class categoriesFor: #browseInstVarWriters:in:session:!browsing!public! !
!JadePresenter class categoriesFor: #browseLiteralReferences:!browsing!public! !
!JadePresenter class categoriesFor: #browseLiteralReferences:initialSuggestion:!browsing!public! !
!JadePresenter class categoriesFor: #browseLiteralReferences:session:!browsing!public! !
!JadePresenter class categoriesFor: #browseMethodsContaining:!browsing!public! !
!JadePresenter class categoriesFor: #browseMethodsContaining:session:!browsing!public! !
!JadePresenter class categoriesFor: #browseSendersIn:!browsing!public! !
!JadePresenter class categoriesFor: #browseSendersOf:session:!browsing!public! !
!JadePresenter class categoriesFor: #browseSymbolReferencesTo:session:!browsing!public! !
!JadePresenter class categoriesFor: #clearAllBreaksIn:!browsing!public! !
!JadePresenter class categoriesFor: #clearMethodBreakpoints:in:!browsing!public! !
!JadePresenter class categoriesFor: #convertToPattern:!browsing support!private! !
!JadePresenter class categoriesFor: #findMethodIn:class:presenter:!browsing!public! !
!JadePresenter class categoriesFor: #issueCommands:session:!public! !
!JadePresenter class categoriesFor: #openGitHubJadeiteProject!browsing!public! !
!JadePresenter class categoriesFor: #openGitHubRowanProject!browsing!public! !
!JadePresenter class categoriesFor: #openMethodListOn:selecting:session:!public! !
!JadePresenter class categoriesFor: #openMethodListOn:selectingAnyMatch:session:!public! !
!JadePresenter class categoriesFor: #promptFor:withCaption:!browsing support!private! !
!JadePresenter class categoriesFor: #promptForMatchingSymbolsIn:actionBlock:promptCaption:searchType:!browsing support!private! !
!JadePresenter class categoriesFor: #runMethodTests:in:!public! !

!JadePresenterA methodsFor!

clearBreakPointAt: stepPoint in: browser
	| selection |
	selection := self methodListSelection.
	selection
		command: #clearBreakAt:;
		commandArgs: (Array with: stepPoint).
	self issueCommand: (Array with: selection).
	browser updateMethodSource. !

cloneProject
	"Does a clone and 'attach'"

	| filePath |
	filePath := RowanKeyValuePrompter
				on: 'file:$ROWAN_PROJECTS_HOME/Rowan/samples/RowanSample1.ston' -> '$ROWAN_PROJECTS_HOME'
				prompt: 'Please select location of the code repository to clone:'
				caption: 'Clone Git Repository'.
	filePath isNil ifTrue: [^false].
	self basicCloneProject: filePath key root: filePath value.!

confirmReloadProjects: selections
	| ws |
	ws := String new writeStream.
	selections do: 
			[:projectService |
			ws
				cr;
				print: projectService name].
	ws
		nextPut: $?;
		cr.
	(MessageBox
		confirm: 'Really load project(s) ' , ws contents , 'This will destroy any changes you may have.')
			ifFalse: [^false].
	^true!

isOkayToChangeSource: methodSourcePresenter
	methodSourcePresenter ensureVisible.
	gciSession isValidSession
		ifTrue: 
			[(MessageBox confirm: 'Stay on unsaved method?' caption: 'Method has unsaved changes!!')
				ifTrue: [^false]]
		ifFalse: 
			[(MessageBox confirm: 'Copy changes to Clipboard?' caption: 'Method has unsaved changes!!')
				ifTrue: 
					[methodSourcePresenter
						selectAll;
						copySelection]].
	methodSourcePresenter view isModified: false.
	^true!

loadProjectsFrom: browser
	| selections |
	selections := browser projectListPresenter selections.
	(self confirmReloadProjects: selections)
		ifTrue: 
			[RowanBrowserService new reloadProjects: selections presenter: self.
			BrowserUpdate current selectedServices do: [:service | service postReload]]!

methodListSelection
	
	^self parentPresenter methodListSelection!

openMethodListOn: service selecting: string
	^JadeiteMethodListBrowser
		openOn: service
		selecting: string
		session: self gciSession!

openMethodListOn: service selectingAnyMatch: string
	^JadeiteMethodListBrowser
		openOn: service
		selectingAnyMatch: string
		session: self gciSession!

queryCommand: query
	query commandSymbol = #flipAutoCommit
		ifTrue: 
			[query isChecked: GciSession current autoCommit == true.
			^true].
	^super queryCommand: query!

refreshBreakPointsIn: methodSourcePresenter
	| indicators selection breakPointSymbol |
	selection := self methodListSelection.
	selection ifNil: [^self].
	methodSourcePresenter view clearContainerIndicators.
	indicators := OrderedCollection new.
	breakPointSymbol := BrowserUpdate current breakpointsEnabled
				ifTrue: [#breakPoint]
				ifFalse: [#disabledBreakPoint].
	1 to: selection stepPoints size
		do: 
			[:stepPoint |
			| range string styleName |
			range := (selection stepPoints at: stepPoint) key.
			styleName := (selection breakPoints includes: stepPoint)
						ifTrue: [breakPointSymbol]
						ifFalse: [#stepPoint].
			string := ((selection breakPoints includes: stepPoint) ifTrue: ['Break at '] ifFalse: [''])
						, 'step point #' , stepPoint printString.
			indicators add: (ScintillaIndicator
						styleName: styleName
						range: range
						tag: string)].
	methodSourcePresenter view indicators: indicators.
	methodSourcePresenter view update!

removeSelectorsString: selections
	| stream answeringService |
	answeringService := RowanAnsweringService new
				command: #methodReferenceCounts:;
				commandArgs: (Array with: selections).
	BrowserUpdate current issueCommands: (Array with: answeringService) session: gciSession.
	stream := String new writeStream.
	1 to: answeringService answer size
		do: 
			[:index |
			| service referenceCount |
			service := selections at: index.
			referenceCount := answeringService answer at: index.
			stream nextPutAll: service selectorsDisplayString.
			referenceCount > 0
				ifTrue: 
					[stream
						nextPutAll: ' (referenced by ';
						nextPutAll: referenceCount printString;
						nextPutAll: ' methods)';
						cr]].
	^stream contents!

setBreakPointAt: stepPoint in: browser
	| selection |
	selection := self methodListSelection.
	selection
		command: #setBreakAt:;
		commandArgs: (Array with: stepPoint).
	self issueCommand: (Array with: selection).
	browser updateMethodSource. !

updateMethodReferences: services
	services do: [:service | service command: #allReferences].
	self issueCommand: services.
	^services! !
!JadePresenterA categoriesFor: #clearBreakPointAt:in:!Jadeite!public! !
!JadePresenterA categoriesFor: #cloneProject!Jadeite!public! !
!JadePresenterA categoriesFor: #confirmReloadProjects:!Jadeite!public! !
!JadePresenterA categoriesFor: #isOkayToChangeSource:!Jadeite!public! !
!JadePresenterA categoriesFor: #loadProjectsFrom:!Jadeite!public! !
!JadePresenterA categoriesFor: #methodListSelection!Jadeite!public! !
!JadePresenterA categoriesFor: #openMethodListOn:selecting:!menu handlers support!private!queries! !
!JadePresenterA categoriesFor: #openMethodListOn:selectingAnyMatch:!menu handlers support!private!queries! !
!JadePresenterA categoriesFor: #queryCommand:!public! !
!JadePresenterA categoriesFor: #refreshBreakPointsIn:!Jadeite!public! !
!JadePresenterA categoriesFor: #removeSelectorsString:!Jadeite!public! !
!JadePresenterA categoriesFor: #setBreakPointAt:in:!Jadeite!public! !
!JadePresenterA categoriesFor: #updateMethodReferences:!Jadeite!public! !

!JadeProcessBrowser methodsFor!

debugProcess
	| oop oopType |
	oop := (processesPresenter selection at: 2) asNumber.
	oopType := gciSession oopTypeWithOop: oop.
	JadeiteDebugger debuggerClass
		openOn: (GsProcess session: gciSession oopType: oopType)
		message: 'background process'
		terminateOnClose: false! !
!JadeProcessBrowser categoriesFor: #debugProcess!private! !

!JadeServer methodsFor!

_describeMethod: aMethod
	"Provide info needed to create a GsMethod in Jade client"
	"Nice to add packageName and mcTimestamp"

	| allSelectors class list oldGsMethod string methodUpdate |
	methodUpdate := RowanMethodUpdate new method: aMethod. 
	self environment: (self environmentForMethod: aMethod).
		
	methodUpdate 	"Line 1 for GsMethod (line 3 for JadeSystemBrowserPresenter)"
"1"		classOop: (class := aMethod inClass) asOop;
"2"		className: class printString;
"3"		methodOop: aMethod asOop;
"4"		selector: aMethod selector;
"5"		category: (self categoryOfMethod: aMethod);
"6"		isReadOnly: (self currentUserMayEditMethod: aMethod);
			source: aMethod sourceString.

	"unimplemented selectors"			"https://github.com/jgfoster/Jade/issues/117"
	((aMethod class includesSelector: #'_selectorPool') and: [aMethod class includesSelector: #'_sourceOffsetOfFirstSendOf:']) ifTrue: [
		allSelectors := self _allSelectors.
		(aMethod _selectorPool reject: [:each | allSelectors includes: each]) do: [:each | 
			methodUpdate firstSendOffsets at: (aMethod _sourceOffsetOfFirstSendOf: each) put: each.
		].
	].

	"Array of Associations (offset -> selector) indexed by step points"
	list := self sbUpdateMethodStepPointsFor: aMethod.
	list do:[:each | methodUpdate stepPoints at: each key printString put: each value].

	"breaks"
	methodUpdate breakPoints: (self sbUpdateMethodBreakPointsFor: aMethod).

	"original method"
	oldGsMethod := (aMethod inClass class canUnderstand: #'persistentMethodDictForEnv:')
		ifTrue: [(aMethod inClass persistentMethodDictForEnv: 0) at: aMethod selector ifAbsent: [aMethod]]
		ifFalse: [(aMethod inClass class canUnderstand: #'_rawMethodDict')
			ifTrue: [aMethod inClass _rawMethodDict at: aMethod selector ifAbsent: [aMethod]]
			ifFalse: [aMethod]].
	aMethod ~~ oldGsMethod ifTrue: [
		methodUpdate originalMethodSource: oldGsMethod sourceString.
	].

	"method compile warnings"
	string := selections isNil 
		ifTrue: ['']
		ifFalse: [selections at: #'methodWarnings' ifAbsent: ['']].
	string isNil ifTrue: [string := ''].
	methodUpdate compilationWarnings: string.
	methodUpdate writeMethodTo: writeStream.

 
!

sbAddPackage: anOrderedCollection
	| string service |
	string := anOrderedCollection removeFirst.
	selections at: #package put: string.
	service := Rowan packageServiceClass forPackageNamed: string.
	service createPackage.
	self systemBrowserUpdate!

sbChangesInPackage: anOrderedCollection
	"where anOrderedCollection is {packageName, projectName}"

	| patch string packageName url |
	packageName := anOrderedCollection removeFirst.
	url := anOrderedCollection removeFirst.
	patch := Rowan packageTools diff patchForPackageName: packageName.
	string := self
				_mcDescriptionOfPatch: patch
				baseName: 'closest ancestor'
				alternateName: nil.
	writeStream
		nextPutAll: 'changesInPackage';
		lf;
		nextPutAll: string;
		yourself
!

sbClassTemplate
	| def service classInfoUpdate |
	service := Rowan classServiceClass forClassNamed: 'Object'.
	def := service classCreationTemplate.
	classInfoUpdate := RowanClassInfoUpdate new.
	classInfoUpdate 
		oop: 0;
		template: def.
	classInfoUpdate writeInfoOn: writeStream
!

sbRemoveClasses
	| isPackages containers classNames |
	self nextLine = 'packageList'. "ignore this" 
	containers := self nextLineAsList.
	classNames := (self nextLineAsList reject: [:each | each isEmpty])
				collect: [:each | (each subStrings: Character space) first asSymbol].
	containers do: 
			[:packageName |
			classNames
				do: [:className | (Rowan packageServiceClass forPackageNamed: packageName) removeClassNamed: className]].
	^self systemBrowserUpdate!

sbRemoveMethods: anOrderedCollection
	| behavior classEntity  notRemoved|
	behavior := self sbClassFrom: anOrderedCollection.
	classEntity := ((System myUserProfile resolveSymbol: #UserGlobals) value at: #rowanCompile
				ifAbsent: [false])
					ifTrue: [Rowan classServiceClass forClassNamed: behavior name meta: behavior isMeta]
					ifFalse: [behavior].
	notRemoved := Array new. 
	anOrderedCollection do: [:each | classEntity removeSelector: each asSymbol ifAbsent: [notRemoved add: each]].
	self systemBrowserUpdate.
	notRemoved isEmpty ifFalse:[self error: 'The following selectors were not removed. Possibly in a superclass? ', notRemoved printString].!

sbUnloadPackage: anOrderedCollection
	| service |
	service := Rowan packageServiceClass forPackageNamed: anOrderedCollection removeFirst.
	service deletePackage.
	self systemBrowserUpdate!

sbUpdateClassCategories

	| categories selection override categoryUpdate |
	categoryUpdate := RowanClassCategoryUpdate new. 
	categories := Set new.
	classList do: [:each | categories add: each category].
	categoryUpdate categories addAll: categories asSortedCollection.
	categoryUpdate writeCategoriesTo: writeStream.
	selection := self nextLine.
	categoryUpdate selection: selection. 
	(override := selections at: #'category' ifAbsent: [nil]) notNil ifTrue: [selection := override , '-'].
	selection := 1 < selection size 
		ifTrue: [selection copyFrom: 1 to: selection size - 1]
		ifFalse: [''].
	selection notEmpty ifTrue: [
		categories := categories select: [:each | (each copyFrom: 1 to: (each size min: selection size)) = selection].
		categories isEmpty ifTrue: [selection := ''].
		categories notEmpty ifTrue: [
			classList := classList select: [:each | categories includes: each category].
		].
	].
	categoryUpdate writeSelectionTo: writeStream.

!

sbUpdateClassHierarchy

	| currentSelection currentClass  override classHierarchyUpdate |
	
	classHierarchyUpdate := RowanClassHierarchyUpdate new. 
	classList do: [:each | 
		classHierarchyUpdate addHierarchyFor: each
	].
	classHierarchyUpdate writeHierarchyTo: writeStream. 
	"now figure out which class to select"
	currentSelection := self nextLineAsList.
	(override := selections at: #'className' ifAbsent: [nil]) notNil ifTrue: [currentSelection := Array with: override].
	currentSelection isEmpty ifTrue: [
		selectedClass := nil.
	] ifFalse: [
		(currentClass := selections at: #'class' ifAbsent: [nil]) isNil ifTrue: [
			| className |
			className := (currentSelection last subStrings: Character space) first asSymbol.
			selectedClass := classHierarchyUpdate allClasses detect: [:each | each name = className] ifNone:[].
		] ifFalse: [
			selectedClass := nil.
			[
				selectedClass isNil and: [currentClass notNil].
			] whileTrue: [
				selectedClass := classHierarchyUpdate allClasses detect: [:each | each = currentClass] ifNone:[].
				currentClass := currentClass superclass.
			].
		].
	].
	classHierarchyUpdate addSelectionHierarchyFor: selectedClass.
	classHierarchyUpdate writeSelectionHierarchyTo: writeStream.
	classHierarchyUpdate writeTestCaseInfoTo: writeStream.


!

sbUpdateClassInfo
	| classComment classInfoUpdate |
	selectedClass isNil ifTrue: [^self sbClassTemplate].
	classInfoUpdate := RowanClassInfoUpdate new. 
	classInfoUpdate oop: (self oopOf: selectedClass).
	classInfoUpdate template: (Rowan classServiceClass forClassNamed: selectedClass name)
							classCreationTemplate.
	classInfoUpdate category: ((classInfoUpdate template includesString: 'category: ''')
					ifFalse: [' category: ' , selectedClass category printString]).
	(selectedClass class canUnderstand: #comment)
		ifTrue: [classComment := selectedClass comment]
		ifFalse: 
			[(selectedClass class canUnderstand: #description)
					ifTrue: 
						[| description |
						description := selectedClass description.
						description class name = #GsClassDocumentation
							ifTrue: [classComment := description detailsAboutClass]]].
	classComment isNil ifTrue: [classComment := ''].
	classInfoUpdate comment: classComment. 
	classInfoUpdate writeInfoOn: writeStream.
!

sbUpdateClassList

	| mySelections override classesUpdate |
	classesUpdate := RowanClassesUpdate new. 
	(classList asSortedCollection: [:a :b | a name <= b name]) do: [:eachClass | 
		classesUpdate classNames add: eachClass name. 
	].
	classesUpdate writeClassesTo: writeStream. 
	mySelections := self nextLineAsList collect: [:each | (each subStrings: Character space) first asSymbol].
	(override := selections at: #'className' ifAbsent: [nil]) notNil ifTrue: [mySelections := Array with: override].
	mySelections := classList select: [:eachClass | mySelections includes: eachClass name].
	mySelections do: [:eachClass | 
		classesUpdate selections add: eachClass asString].
	classesUpdate writeSelectionsTo: writeStream. 
	classesUpdate writeTestCaseInfoTo: writeStream. 
	selectedClass := mySelections size = 1
		ifTrue: [mySelections first]
		ifFalse: [nil].
!

sbUpdateDictionaries

	| override packagePolicy home symbolList oldSelections newSelections fullList globals dictionaryUpdate globalsUpdate |
	dictionaryUpdate := RowanDictionaryUpdate new. 
	oldSelections := self nextLineAsList.
	(override := selections at: #'dictionary' ifAbsent: [nil]) notNil ifTrue: [oldSelections := Array with: override].
	symbolList := self symbolList.
	(packagePolicy := self gsPackagePolicy) notNil  ifTrue: [
		home := packagePolicy homeSymbolDict.
	].
	fullList := symbolList collect: [:each | 
		| hvName | 
		hvName := (each == home ifTrue: ['H'] ifFalse: ['V']) , each name.
		dictionaryUpdate dictionaries add: hvName.
		hvName.
		].
	dictionaryUpdate writeDictionariesTo: writeStream.
	fullList := fullList collect: [:each | each copyFrom: 2 to: each size].
	newSelections := oldSelections select: [:each | fullList includes: each].
	globals := Dictionary new.
	newSelections do: [:eachName | 
		| symbolDictionary globalKeyPrefix |
		globalKeyPrefix := 1 < newSelections size ifTrue: [eachName , '.'] ifFalse: [''].
		dictionaryUpdate selections add: eachName asString.
		symbolDictionary := symbolList at: (fullList indexOf: eachName).
		symbolDictionary keys asSortedCollection do: [:eachKey |
			| eachGlobal |
			eachGlobal := symbolDictionary at: eachKey.
			(eachGlobal isBehavior and: [eachGlobal name == eachKey])
				ifTrue: [classList add: eachGlobal]
				ifFalse: [globals at: globalKeyPrefix , eachKey put: (symbolDictionary associationAt: eachKey)].
		].
	].
	dictionaryUpdate writeSelectionsTo: writeStream. 
	globalsUpdate := RowanGlobalsUpdate new. 
	globals keys asSortedCollection do: [:eachKey | 
		| eachAssociation eachValue string globalsArray |
		eachAssociation := globals at: eachKey.
		eachValue := eachAssociation value.
		string := self asString: eachValue.
		100 < string size ifTrue: [string := string copyFrom: 1 to: 100].
		string := string collect: [:char | (char asciiValue < 32 or: [127 < char asciiValue]) ifTrue: [$.] ifFalse: [char]].
		string := String withAll: string asArray.
		globalsArray := Array new. 
		globalsArray add: eachKey;
						add: eachValue _class name;
						add: string;
						add: (self oopOf: eachValue) printString;
						add: (self oopOf: eachAssociation) printString.
		globalsUpdate globals add: globalsArray. 
	].
	globalsUpdate writeGlobalsTo: writeStream.
	

!

sbUpdateMethodCategories

	| methodUpdate | 
	methodUpdate := RowanMethodsUpdate new.  
	methodUpdate classNamesFrom: classList. 
	methodUpdate updateMethodCategories; 
		writeMethodCategoriesTo: writeStream. 
	methodUpdate updateMethodSelections: self nextLineAsList 
			hasCategoryOverride: (selections at: #'methodCategory' ifAbsent: [nil]).
	methodFilters := methodUpdate methodFilters.
	methodUpdate writeSelectionsTo: writeStream. !

sbUpdateMethods

	| selectors methodUpdate |
	selectedClass isNil ifTrue: [^self].
	methodUpdate := RowanMethodsUpdate new selectedClass: selectedClass.
	methodFilterType = 'categoryList' ifTrue: [selectors := self sbUpdateMethodsByCategories] ifFalse: [
	methodFilterType = 'variableList' ifTrue: [selectors := self sbUpdateMethodsByVariables] ifFalse: [
	methodFilterType = 'pragmaList' ifTrue: [selectors := self sbUpdateMethodsByPragmas] ifFalse: [
		self error: 'Unrecognized methodFilterType: ' , methodFilterType printString]]].
	methodUpdate selectors: selectors asSortedCollection.
	methodUpdate updateMethodsInfo.
	methodUpdate writeMethodsTo: writeStream. 
	self sbUpdateMethodSelectionsIn: methodUpdate
!

sbUpdateMethodVariables

	| methodUpdate |
	methodUpdate := RowanMethodsUpdate new. 
	methodUpdate classNamesFrom: classList. 
	methodUpdate updateMethodVariables. 
	methodUpdate writeMethodFiltersTo: writeStream. 
	methodUpdate updateMethodSelections: self nextLineAsList 
		hasCategoryOverride: (selections at: #'methodCategory' ifAbsent: [nil]).
	methodFilters := methodUpdate methodFilters.
	methodUpdate writeSelectionsTo: writeStream. 

!

sbUpdatePackages
	| override modifiedList oldSelections newSelections fullList packagesUpdate |
	
	packagesUpdate := RowanPackageUpdate new. 
	oldSelections := self nextLineAsList.
	(override := selections at: #package ifAbsent: [nil]) notNil
		ifTrue: [oldSelections := Array with: override].
	fullList := Rowan serviceClass new rowanLoadedPackageNames subStrings: Character lf.
	fullList := fullList reject: [:each | each isEmpty].
	fullList := fullList asSortedCollection asArray.
	fullList := fullList collect: [:each | each subStrings: Character tab].
	fullList := fullList reject: [:each | each isEmpty].
	modifiedList := (fullList select: [:each | (each at: 2) = 'Y']) collect: [:each | each at: 3].
	fullList := fullList collect: [:each | each at: 3].
	packagesUpdate modifiedPackages addAll: modifiedList. 
	packagesUpdate packages addAll: fullList. 
	packagesUpdate writePackagesTo: writeStream. 
	packagesUpdate writeModifiedPackagesTo: writeStream. 
	newSelections := oldSelections select: [:each | fullList includes: each].
	(newSelections isEmpty and: [oldSelections size = 1])
		ifTrue: 
			[newSelections := fullList
						select: [:each | (oldSelections first copyFrom: 1 to: (oldSelections first size min: each size)) = each]].
	newSelections do: 
			[:each |
			| service |
			packagesUpdate selections add: each asString. 
			service := Rowan packageServiceClass forPackageNamed: each.
			classList addAll: service loadedClassHandles].
	packagesUpdate writeSelectionsTo: writeStream.
	newSelections size = 1 ifTrue: [self sbUpdatePackage: newSelections first]
!

sbUpdateSuperclass

	| class tabName selected index superclassUpdate |
	superclassUpdate := RowanSuperclassUpdate new.
	tabName := self nextLine. 
	(#('default' 'instanceTab' 'classTab') includes: tabName) ifFalse: [self error: 'Unexpected token!!'].
	tabName = 'default' ifTrue: [
		tabName := (selectedClass notNil and: [selectedClass selectors isEmpty and: [selectedClass class selectors notEmpty]]) 
			ifTrue: ['classTab']
			ifFalse: ['instanceTab'].
	].
	superclassUpdate tabName: tabName. 
	superclassUpdate writeTabNameTo: writeStream.
	selectedClass notNil ifTrue: [
		selectedClass := tabName = 'instanceTab'
			ifTrue: [selectedClass]
			ifFalse: [selectedClass class].
	].
	class := selectedClass.
	classList := OrderedCollection new.
	[
		class notNil.
	] whileTrue: [
		classList add: class.
		superclassUpdate classNames add: class name. 
		class := self environmentSuperClassFor: class.
	].
	superclassUpdate writeClassesTo: writeStream.
	classList := classList reverse.
	selected := self nextLine.
	index := classList findFirst: [:each | each name asString = selected].
	index = 0 ifTrue: [index := classList size].
	0 < index ifTrue: [classList := classList copyFrom: index to: classList size].
	classList notEmpty ifTrue: [
		selectedClass := classList first.
		superclassUpdate selections add: selectedClass asString.
	].
	superclassUpdate writeSelectionsTo: writeStream. 
!

systemBrowserSTONA: aString

	| time |
	time := self millisecondsElapsedTime: [
		selections := Dictionary new.
		readStream := ReadStream on: aString.
		writeStream := WriteStream on: String new.
		writeStream lf.
		self environment: (readStream upTo: Character space) asNumber.
		self systemBrowserCommand.
	].
	^STON toString: RowanCommandResult results
! !
!JadeServer categoriesFor: #_describeMethod:!Debugger!GsObject!public!System Browser! !
!JadeServer categoriesFor: #sbAddPackage:!public!System Browser! !
!JadeServer categoriesFor: #sbChangesInPackage:!public!System Browser! !
!JadeServer categoriesFor: #sbClassTemplate!public!System Browser! !
!JadeServer categoriesFor: #sbRemoveClasses!public!System Browser! !
!JadeServer categoriesFor: #sbRemoveMethods:!public!System Browser! !
!JadeServer categoriesFor: #sbUnloadPackage:!public!System Browser! !
!JadeServer categoriesFor: #sbUpdateClassCategories!public!System Browser! !
!JadeServer categoriesFor: #sbUpdateClassHierarchy!public!System Browser! !
!JadeServer categoriesFor: #sbUpdateClassInfo!public!System Browser! !
!JadeServer categoriesFor: #sbUpdateClassList!public!System Browser! !
!JadeServer categoriesFor: #sbUpdateDictionaries!public!System Browser! !
!JadeServer categoriesFor: #sbUpdateMethodCategories!public!System Browser! !
!JadeServer categoriesFor: #sbUpdateMethods!public!System Browser! !
!JadeServer categoriesFor: #sbUpdateMethodVariables!public!System Browser! !
!JadeServer categoriesFor: #sbUpdatePackages!public!System Browser! !
!JadeServer categoriesFor: #sbUpdateSuperclass!public!System Browser! !
!JadeServer categoriesFor: #systemBrowserSTONA:!public!System Browser! !

!JadeServer class methodsFor!

gsString
"
	JadeServer64bit3x gsString.
"
	| stream |
	SessionManager current isRuntime ifTrue: [^gsString].
	(stream := WriteStream on: String new)
		nextPutAll: '| class mcPlatformSupport methodClass readStream result server source symbolList writeStream |'; lf;
		nextPutAll: 'methodClass := ';
		nextPutAll: self gsMethodClassName;
		nextPut: $.; lf;
		nextPutAll: 'symbolList := System myUserProfile symbolList.'; lf;
		
		" These lines force OtherPassword setting to be enabled to run Jadeite. (OtherPassword is required to change another symbol list.
		nextPutAll: 'symbolList := (AllUsers userWithId: ''DataCurator'') symbolList.'; lf;
		nextPutAll: 'symbolList := symbolList class new add: (symbolList detect: [:each | each name == #UserGlobals]); add: (symbolList detect: [:each | each name == #Globals]); yourself.'; lf;"

		nextPutAll: '[class := symbolList objectNamed: #Object.'; lf;
		yourself.
	"(self withAllSuperclasses remove: Object; yourself) reverseDo: [:eachClass | self addGsStringForClass: eachClass to: stream]."
	stream 
		nextPutAll: '(mcPlatformSupport := symbolList objectNamed: #''MCPlatformSupport'') notNil ifTrue: ['; lf;
		nextPutAll: '	mcPlatformSupport autoCommit: false; autoMigrate: false].'; lf;
		nextPutAll: 'class := ((symbolList objectNamed: #System) myUserProfile symbolList objectNamed: #UserGlobals) at: #' , self name , ' ifAbsent: [class].'; lf;
		nextPutAll: 'server := class new initialize; yourself.'; lf;
		nextPutAll: self sessionStateCode; lf;
		nextPutAll: 'server] on: (symbolList objectNamed: #Error) do: [:ex | ex return: ''ERROR: '' , (GsProcess stackReportToLevel: 100)]';
		yourself.
	gsString := stream contents.
	^gsString.
! !
!JadeServer class categoriesFor: #gsString!public! !

!JadeServer64bit methodsFor!

recompile: aMethod withSource: aString
	| result behavior |
	behavior := aMethod inClass.
	((System myUserProfile resolveSymbol: #UserGlobals) value at: #rowanCompile ifAbsent: [false])
		ifTrue: 
			[behavior rwCompileMethod: aString
				category: (self _behavior: behavior categoryOfSelector: aMethod selector).
			Rowan serviceClass rowanFixMe.	"need to handle compile errors"
			^true]
		ifFalse: 
			[result := aMethod _recompileWithSource: aString.
			result isNil ifTrue: [^true].	"Bug 41195 returns nil if success so assume it is the same method"
			^result]!

systemBrowserSTON: aString

	[
		^super systemBrowserSTON: aString.
	] on: Error do: [:ex |
		readStream := nil.
		ex pass.
	].
! !
!JadeServer64bit categoriesFor: #recompile:withSource:!Debugger!public! !
!JadeServer64bit categoriesFor: #systemBrowserSTON:!public!System Browser! !

!JadeServer64bit32 class methodsFor!

gsClassDefinitionStringFor: aClass
	"Some class variables exist only in Dolphin and map to globals in GemStone; others exist only in GemStone and map to globals in Dolphin!!"

	^'class subclass: ''' , aClass name , '''
		instVarNames: ' , aClass instVarNames printString , '
		classVars: #(' , aClass classVarsForGemStone , ')
		classInstVars: #()
		poolDictionaries: (#() class withAll: symbolList)
		inDictionary: UserGlobals.'
! !
!JadeServer64bit32 class categoriesFor: #gsClassDefinitionStringFor:!public! !

!JadeServer64bit3x methodsFor!

compileMethod: methodString behavior: aBehavior symbolList: aSymbolList inCategory: categorySymbol
	"returns (nil -> anArrayOfErrors) or (aGsNMethod -> compilerWarnings) or (aGsNMethod -> nil)"

	| method warnings | 

	[[((System myUserProfile resolveSymbol: #UserGlobals) value at: #rowanCompile ifAbsent:[false]) ifTrue:[
			method := aBehavior rwCompileMethod: methodString category: categorySymbol]
		ifFalse:[
			method := aBehavior
			compileMethod: methodString
			dictionaries: aSymbolList
			category: categorySymbol
			environmentId: environment].
	] on: CompileError do: [:ex |
		^nil -> (ex gsArguments at: 1)
	]] on: CompileWarning do: [:ex |
		warnings := ex gsArguments at: 1.
		ex resume.
	].
	^[	
		(self compiledMethodAt: method key selector inClass: aBehavior) -> warnings.
	] on: Error do: [:ex | 
		ex return: method -> warnings.
	].
!

sbClassComment: anOrderedCollection

	(self sbClassFrom: anOrderedCollection) thisClass rwComment: self sbNextParagraph trimSeparators.
	self systemBrowserUpdate.
!

sbUpdateMethodPragmas

	| methodUpdate |
	methodUpdate := RowanMethodsUpdate new. 
	selectedClass notNil ifTrue:[
		methodUpdate selections add: selectedClass asString].
	methodUpdate updateMethodPragmas.
	methodUpdate writeMethodFiltersTo: writeStream. 
	methodUpdate updateMethodSelections: self nextLineAsList 
		hasCategoryOverride: (selections at: #'methodCategory' ifAbsent: [nil]).
	methodFilters := methodUpdate methodFilters.
	methodUpdate writeSelectionsTo: writeStream. 

! !
!JadeServer64bit3x categoriesFor: #compileMethod:behavior:symbolList:inCategory:!Methods!public!System Browser! !
!JadeServer64bit3x categoriesFor: #sbClassComment:!public!System Browser! !
!JadeServer64bit3x categoriesFor: #sbUpdateMethodPragmas!public!System Browser! !

!JadeSessionManager class methodsFor!

getUrl
	"no longer sent, but might be handy to have"

	| string |
	string := [SessionManager current class git: 'config --get remote.origin.url']
				on: ExternalProcessExecuteError
				do: [:ex | ^'???'].
	^(ReadStream on: string) nextLine!

mainShellClass
	^JadeiteLoginShell!

setVersion

	Version := self getVersion.! !
!JadeSessionManager class categoriesFor: #getUrl!public! !
!JadeSessionManager class categoriesFor: #mainShellClass!public! !
!JadeSessionManager class categoriesFor: #setVersion!public! !

!JadeShell methodsFor!

updateCaptionFromSearchString: searchString

	self caption: (gciSession titleBarFor: searchString).
! !
!JadeShell categoriesFor: #updateCaptionFromSearchString:!overrides!private! !

!JadeSystemBrowserPresenter methodsFor!

basicAddMethodCategory: string
	| stream |
	stream := (WriteStream on: String new)
				nextPutAll: 'addMethodCategory';
				tab;
				nextPutAll: self selectedClassNameWithoutVersion;
				tab;
				nextPutAll: selectedClassOop printString;
				tab;
				nextPutAll: instanceClassTabs currentCard name;
				tab;
				nextPutAll: string;
				tab;
				lf;
				yourself.
	self updateCommand: stream contents , self requestString
		onSuccessDo: [methodSourcePresenter ensureVisible]!

basicRemoveMethods
	| string |
	string := 'removeMethods' , Character tab asString , self methodsIdentifier , Character lf asString
				, self requestString.
	self updateCommand: string!

browseMethodsAndSelect: aString

	(JadeiteMethodListBrowser showOnSession: self gciSession) primaryPresenter
		browseMethodsFromString: readStream upToEnd methodName: aString;
		selecting: aString.
!

browseMethodsAndSelect: aString type: browseType

	(JadeiteMethodListBrowser showOnSession: self gciSession) primaryPresenter
		browseMethodsFromString: readStream upToEnd methodName: aString type: browseType;
		selecting: aString.
!

createSchematicWiring
	super createSchematicWiring.
	self
		getViews;
		createSchematicWiringForClassList;
		createSchematicWiringForClassHierarchy;
		createSchematicWiringForClassHierarchyTabs;
		createSchematicWiringForMethodList;
		createSchematicWiringForDictionaryList;
		createSchematicWiringForPackageList;
		createSchematicWiringForPackageDictionaryTabs;
		createSchematicWiringForPragmaList;
		createSchematicWiringForMethodSource;
		createSchematicWiringForClassDefinition;
		createSchematicWiringForMethodCategoryList;
		createSchematicWiringForVariableList;
		createSchematicWiringForClassCategoryList;
		createSchematicWiringForSuperClassList;
		createSchematicWiringForOverrideList;
		createSchematicWiringForInstanceClassTabs;
		yourself.
	textAreaTabs
		when: #currentCardChanged
		send: #textTabChanged
		to: self.
	methodFilterTabs
		when: #currentCardChanged
			send: #updateAndSelect:
			to: self
			with: classDefinitionPresenter.
	globalsPresenter
		when: #actionPerformed
		send: #inspectGlobal
		to: self!

createSchematicWiringForClassHierarchyTabs
	!

currentMethodSource
	^self currentMethodSourceFrom: methodSourcePresenter value!

editSaveClass
	| string stream flag |
	string := classDefinitionPresenter value
				collect: [:each | each codePoint < 32 ifTrue: [Character space] ifFalse: [each]].
	stream := (WriteStream on: String new)
				nextPutAll: 'class';
				tab;
				nextPutAll: string;
				lf;
				yourself.
	flag := false.
	
	[self updateCommand: stream contents , self requestString
		onSuccessDo: 
			[classDefinitionPresenter view isModified: false.
			flag := true]]
			on: GsCompileError
			do: 
				[:ex |
				string := self handleClassCompileError: ex.
				^self].
	flag ifTrue: [self editSaveClassA]!

findClass
"
	Array with: className with: dictionaryName with: catetory with: packageName.
"
	| find list |
	list := self findClassList.
	ignoreNextSetFocusEvent := true.
	find := JadeFindClassDialog showModal: 'ThreeColumnView' on: list.
	find ifNil: [^self].
	self 
		updateAfterFindClass: find value
		isMeta: nil 
		selector: ''.
!

handleClassCompileError: ex
	| offset string explanation |
	offset := ex list first at: 2.
	explanation := ex list first at: 3.
	string := classDefinitionPresenter value.
	string := (string copyFrom: 1 to: offset - 1) , ' ' , explanation , ' '
				, (string copyFrom: offset to: string size).
	classDefinitionPresenter
		value: string;
		selectionRange: (offset to: offset + explanation size + 1);
		yourself.
	^string!

instanceClassTabs
	^instanceClassTabs!

instanceClassTabs: anObject
	instanceClassTabs := anObject!

methodsMenuStrings

	false ifTrue: [	"This helps us find senders"
		self browseImplementors; browseImplementorsOf; browseSenders; browseSendersOf; browseMethodsContaining; browseMethodPragmas; removeMethods; runMethodTests; setEnvironment0; setEnvironment1; setEnvironment2; fileOutMethod.
	].
	^#(
		'&Methods'
		'Browse &Implementors//browseImplementors'
		'Browse Implementors of ...//browseImplementorsOf'
		'Browse &Senders//browseSenders'
		'Browse Senders of ...//browseSendersOf'
		'-'
		'Browse Methods &Containing ...//browseMethodsContaining'
		'&File out method ...//fileOutMethod'
		'-'
		'&Remove Method(s) ...//removeMethods'
		#('&Method Environment' '&0//setEnvironment0' '&1//setEnvironment1' '&2//setEnvironment2')
		'Run &Tests//runMethodTests'
	).
!

methodSourceEqual
	^methodSourcePresenter value = methodSource!

onViewOpened 
	super onViewOpened.
	categoryListPresenter view contextMenu: (Menu fromStrings: self categoriesMenuStrings).
	classCommentPresenter view isReadOnly: false.
	classHierarchyPresenter view contextMenu: (Menu fromStrings: self classesMenuStrings).
	classListPresenter view contextMenu: (Menu fromStrings: self classesMenuStrings).
	dictionaryListPresenter view contextMenu: (Menu fromStrings: self dictsMenuStrings).
	globalsPresenter view contextMenu: (Menu fromStrings: self globalsMenuStrings).
	methodListPresenter view contextMenu: (Menu fromStrings: self methodsMenuStrings).
	methodSourcePresenter view
		contextMenu: (Menu fromStrings: self editMenuStrings);
		isBackgroundDwellEnabled: true;
		isBraceHighlightingEnabled: true;
		yourself.
	variableListPresenter view contextMenu: (Menu fromStrings: self variablesMenuStrings).
	self setSearchPolicy.
	!

packageTabName

	^'Packages'!

postOkToChangeEvent
!

preRemoveMethods
	| stream |
	stream := WriteStream on: String new.
	methodListPresenter selections do: 
			[:each |
			stream
				nextPutAll: each first;
				cr].
	^stream contents!

queryCommand: aCommandQuery

	| command focusView isTextEdit |
	command := aCommandQuery command.
	focusView := View focus.
	isTextEdit := focusView isKindOf: TextEdit.
	(#(#'browseMethodPragmas') includes: command) ifTrue: [aCommandQuery isEnabled: gciSession gsHasPragmas. ^true].
	(#(#'editSave') includes: command) ifTrue: [aCommandQuery isEnabled: (isTextEdit and: [focusView isModified]). ^true].
	(#(#'editUndo') includes: aCommandQuery command) ifTrue: [aCommandQuery isEnabled: (isTextEdit and: [focusView canUndo]). ^true].
	(#(#'editRedo') includes: aCommandQuery command) ifTrue: [aCommandQuery isEnabled: (isTextEdit and: [focusView canRedo]). ^true].
	(#(#'editCut' #'editCopy' "#'editDelete'" ) includes: aCommandQuery command) ifTrue: [aCommandQuery isEnabled: (isTextEdit and: [focusView hasSelection]). ^true].
	(#(#'editPaste') includes: aCommandQuery command) ifTrue: [aCommandQuery isEnabled: (isTextEdit and: [Clipboard current isTextAvailable]). ^true].
	(#(#'addRepository') includes: command) ifTrue: [aCommandQuery isEnabled: packageListPresenter selections notEmpty. ^true].
	(#(#'showPackageChanges') includes: command) ifTrue: [
		aCommandQuery isEnabled: true . ^true].
	(#(#'savePackage') includes: command) ifTrue: [aCommandQuery isEnabled: packageListPresenter selections size = 1. ^true].
	(#(#'removeRepository') includes: command) ifTrue: [
		aCommandQuery isEnabled: (repositoryListPresenter hasSelection and: [packageListPresenter selections size = 1]). ^true].
	(#(#'compareAncestor') includes: command) ifTrue: [
		aCommandQuery isEnabled: (packageListPresenter selections size = 1 and: [ancestorListPresenter hasSelection]). ^true].
	(#(#'browseMethodHistory' #'browseImplementors' #'browseSenders' #'fileOutMethod') includes: command) ifTrue: [
		aCommandQuery isEnabled: methodListPresenter selections size = 1. ^true].
	(#(#'inspectGlobal' #'browseGlobalReferences') includes: command) ifTrue: [aCommandQuery isEnabled: globalsPresenter selections size = 1. ^true].
	(#(#'removeGlobals') includes: command) ifTrue: [aCommandQuery isEnabled: globalsPresenter selections notEmpty. ^true].
	(#(#'fileOutDictionary' ) includes: command) ifTrue: [aCommandQuery isEnabled: dictionaryListPresenter selections size = 1. ^true].
	(#(#'setHomeDictionary') includes: command) ifTrue: [aCommandQuery isEnabled: (dictionaryListPresenter selections size = 1 and: [dictionaryListPresenter selection value not]). ^true].
	"(#(#'runMethodTests') includes: command) ifTrue: [aCommandQuery isEnabled: (methodListPresenter selections notEmpty and: [methodListPresenter selections first isTestMethod]). ^true]."
	(#(#'loadLatestVersion') includes: command) ifTrue: [
		aCommandQuery isEnabled: (packageListPresenter selections notEmpty and: [packageListPresenter selections allSatisfy: [:each | each key beginsWith: 'ConfigurationOf']]). ^true].
	(#(#'browseClassReferences' #'fileOutClass' #'addSubclass' #'addMissingAccessors' #'removeClass' #'removePriorVersions') includes: command) ifTrue: [
		aCommandQuery isEnabled: self selectedClasses size == 1. ^true.
	].
	(#(#'runClassTests') includes: command) ifTrue: [aCommandQuery isEnabled: selectedClassesAreTestCases. ^true].
	(#(#'browseSelectedClass') includes: command) ifTrue: [aCommandQuery isEnabled: self isClassSelectedInEditor. ^true].

	(command == #historyBack) ifTrue: [aCommandQuery isEnabled: self hasCommandHistoryBack. ^true].
	(command == #historyForward) ifTrue: [aCommandQuery isEnabled: self hasCommandHistoryForward. ^true].

	(command == #'setEnvironment0' and: [environment == 0]) ifTrue: [aCommandQuery isChecked: true. ^true].
	(command == #'setEnvironment1' and: [environment == 1]) ifTrue: [aCommandQuery isChecked: true. ^true].
	(command == #'setEnvironment2' and: [environment == 2]) ifTrue: [aCommandQuery isChecked: true. ^true].

	^super queryCommand: aCommandQuery.
!

removeMethods
	| result confirmationString |
	confirmationString := self removeSelectorsString: self methodListPresenter selections.
	result := MessageBox confirm: confirmationString caption: 'Remove the following method(s)?'.
	result ifFalse: [^self].
	self basicRemoveMethods!

runClassTests
	| stream string list caption selection |
	stream := (WriteStream on: String new)
				nextPutAll: self behaviorIdentifier;
				yourself.
	string := self gciSession serverPerform: #sbRunClassTests: with: stream contents.
	string isNil
		ifTrue: 
			[self error: 'Test run did not return expected value!!'.
			^self].
	list := string subStrings: Character lf.
	list size = 1
		ifTrue: 
			[MessageBox notify: list first.
			^self].
	caption := list first.
	list := list copyFrom: 2 to: list size.
	list := list asSortedCollection.
	selection := SUnitResultDialog showModalOn: (Array
						with: self gciSession
						with: caption
						with: list).
	selection isNil ifTrue: [^self].
	[self gciSession executeString: selection] on: GsError
		do: [:ex | JadeiteDebugger debuggerClass openDebuggerOnException: ex]!

savePackage

	| package string array dict stream |
	self rowanFixMe. "Eventually, this would be nice to have." 
	true ifTrue:[^MessageBox notify: 'This functionality is not available. Commit your changes at the project level.'].
	package := packageListPresenter selections first.
	string := self updateCommand: 'uniqueVersionName' , Character tab asString , package key.
	string = 'uniqueVersionName' ifFalse: [self error: 'Unrecognized response'].
	string := readStream nextLine.
	array := ancestorListPresenter list.
	array := array isEmpty 
		ifTrue: [#('' '' '' '')]
		ifFalse: [array first].
	dict := Dictionary new
		at: #'httpPassword'		put: '';
		at: #'httpUser'			put: '';
		at: #'name' 			put: package key;
		at: #'isModified'			put: package value;
		at: #'nextVersionName'	put: string;
		at: #'priorVersionName'	put: (array at: 2);
		at: #'versionMessage'		put: (array at: 4);
		at: #'repositoryList'		put: repositoryListPresenter list;
		at: #'repository'			put: (repositoryListPresenter selectionIfNone: [repositoryListPresenter model last]);
		yourself.
	(RowanSavePackageDialog showModalOn: dict) isNil ifTrue: [^self].
	stream := (WriteStream on: String new)
		nextPutAll: 'savePackage'; tab;
		nextPutAll: package key; tab;
		nextPutAll: ((dict at: #'repository') at: 2); tab;
		nextPutAll: (dict at: #'versionName'); tab;
		nextPutAll: (dict at: #'httpUser'); tab;
		nextPutAll: (dict at: #'httpPassword'); lf;
		nextPutAll: ((dict at: #'versionMessage') reject: [:char | char = Character cr]); lf;
		nextPut: $%; lf;
		nextPutAll: self requestString;
		yourself.
	self updateCommand: stream contents.
!

selectorsString
	^(methodListPresenter selections collect: [:each | each first]) printString!

updateClassHierarchy
	| list paths treeModel x y currentSelection newSelection flags |
	list := readStream nextList.
	newSelection := readStream nextLineAsList reverse.
	flags := readStream nextLineAsList.
	classHierarchyPresenter ensureVisible.
	list := list collect: [:each | each reverse].
	paths := Set new.
	list do: 
			[:eachClass |
			| string |
			string := ''.
			eachClass do: 
					[:each |
					string := string , each.
					paths add: string.
					string := string , Character tab asString]].
	paths := paths asSortedCollection asArray.
	treeModel := TreeModel new
				searchPolicy: SearchPolicy equality;
				reset;
				yourself.
	paths do: 
			[:each |
			| path parent |
			path := each subStrings: Character tab.
			parent := path copyFrom: 1 to: path size - 1.
			parent isEmpty ifTrue: [parent := nil].
			treeModel add: path asChildOf: parent].
	x := (treeModel asBag collect: [:each | each printString]) asSortedCollection asArray.
	y := (classHierarchyPresenter model asBag collect: [:each | each printString]) asSortedCollection
				asArray.
	x = y
		ifFalse: 
			[classHierarchyPresenter
				model: treeModel;
				yourself].
	currentSelection := classHierarchyPresenter selectionIfNone: [#()].
	(currentSelection isEmpty and: [newSelection isEmpty and: [classListPresenter selections size = 1]])
		ifTrue: 
			[x := classListPresenter selection.
			newSelection := classHierarchyPresenter model asBag asArray detect: [:each | each last = x]
						ifNone: [nil]].
	(newSelection notEmpty and: [currentSelection ~= newSelection])
		ifTrue: 
			[classHierarchyPresenter
				selection: newSelection;
				expand: newSelection;
				yourself].
	self selectedClassName: (newSelection notEmpty ifTrue: [newSelection last] ifFalse: ['']).
	classListPresenter selectionOrNil: nil.
	selectedClassesAreTestCases := (flags at: 1) = 'true'.
	sunitPresenter testClassService: (selectedClassesAreTestCases
				ifTrue: 
					[| service |
					self updateService: (service := RowanClassService new name: selectedClassName).
					service]
				ifFalse: [nil])!

updateClassList
	| fullList newSelections flags |
	classListPresenter ensureVisible.
	fullList := readStream nextLineAsList.
	newSelections := readStream nextLineAsList.
	flags := readStream nextLineAsList.
	fullList = classListPresenter list ifFalse: [classListPresenter list: (ListModel withAll: fullList)].
	newSelections := classListPresenter list select: [:each | newSelections includes: each].
	newSelections = classListPresenter selections
		ifFalse: [classListPresenter selections: newSelections].
	self selectedClassName: (newSelections size = 1 ifTrue: [newSelections first] ifFalse: ['']).
	classHierarchyPresenter selectionOrNil: nil.
	newSelections notEmpty
		ifTrue: [classListPresenter view ensureSelectionVisible]
		ifFalse: [fullList notEmpty ifTrue: [classListPresenter view ensureVisible: 1]].
	selectedClassesAreTestCases := (flags at: 1) = 'true'.
	sunitPresenter testClassService: (selectedClassesAreTestCases
				ifTrue: 
					[selectedClassName isEmpty
						ifTrue: []
						ifFalse: 
							[| service |
							self updateService: (service := RowanClassService new name: selectedClassName).
							service]]
				ifFalse: [])!

updateMethod
	| gsMethod isReadOnly listModel methodSourceLabel newSource warnings x |
	methodSourcePresenter view cancelCallTip.
	gsMethod := GsMethod fromStream: readStream session: gciSession.
	isReadOnly := gsMethod isReadOnly.	"current user has write permission for the class"
	newSource := gsMethod source.
	methodSourcePresenter view isModified
		ifTrue: 
			[newSource = methodSource ifTrue: [^self].
			(MessageBox confirm: 'Copy changes to clipboard?' caption: 'Method has unsaved changes!!')
				ifTrue: [methodSourcePresenter value copyToClipboard]].
	methodSource := newSource.
	methodSourcePresenter value: methodSource.
	unimplementedSelectors := gsMethod unimplementedSelectors.
	stepPoints := gsMethod stepPoints.
	breakPoints := gsMethod breakPoints.
	self updateMethodStepPoints.
	methodSourcePresenter view
		backcolor: JadeiteTextStyles default colorForNoEdits;
		isModified: false;
		isReadOnly: isReadOnly;
		yourself.
	(overrideListPresenter list notEmpty
		and: [overrideListPresenter selectionOrNil ~= overrideListPresenter list last])
			ifTrue: 
				[methodSourcePresenter view
					backcolor: nil;
					isReadOnly: true;
					yourself].
	((methodCategory := gsMethod category) notEmpty and: [self isCategoryTabSelected])
		ifTrue: 
			[| fullList selections index newName |
			fullList := categoryListPresenter list.
			selections := categoryListPresenter selections.
			0 < (index := fullList indexOf: methodCategory)
				ifTrue: 
					[fullList at: index put: (newName := ' ' , methodCategory).
					categoryListPresenter list: fullList.
					0 < (index := selections indexOf: methodCategory)
						ifTrue: 
							[selections at: index put: newName.
							categoryListPresenter selections: selections].
					categoryListPresenter view invalidate]].
	listModel := (textAreaTabs subViews detect: [:each | each class == TabViewXP]) model.
	originalSourceLabel
		ifNil: [originalSourceLabel := listModel detect: [:each | each text = 'Original Source']].
	methodSourceLabel := listModel detect: [:each | each text = 'Method Source'].
	(x := gsMethod originalSource) isEmpty
		ifTrue: [listModel remove: originalSourceLabel ifAbsent: []]
		ifFalse: 
			[(listModel includes: originalSourceLabel)
				ifFalse: [listModel add: originalSourceLabel before: methodSourceLabel].
			originalSourcePresenter value: x].
	(warnings := gsMethod warnings) notEmpty
		ifTrue: [MessageBox warning: warnings caption: 'Jade Compile Warning']!

updateSelector
	| gsMethod isReadOnly listModel methodSourceLabel newSource warnings x |
	methodSourcePresenter view cancelCallTip.
	gsMethod := GsMethod fromStream: readStream session: gciSession.
	isReadOnly := gsMethod isReadOnly.	"current user has write permission for the class"
	newSource := gsMethod source.
	methodSourcePresenter view isModified
		ifTrue: 
			[newSource = methodSource ifTrue: [^self].
			(MessageBox confirm: 'Copy changes to clipboard?' caption: 'Method has unsaved changes!!')
				ifTrue: [methodSourcePresenter value copyToClipboard]].
	methodSource := newSource.
	methodSourcePresenter value: methodSource.
	unimplementedSelectors := gsMethod unimplementedSelectors.
	stepPoints := gsMethod stepPoints.
	breakPoints := gsMethod breakPoints.
	self updateMethodStepPoints.
	methodSourcePresenter view
		backcolor: JadeiteTextStyles default colorForNoEdits;
		isModified: false;
		isReadOnly: isReadOnly;
		yourself.
	(overrideListPresenter list notEmpty
		and: [overrideListPresenter selectionOrNil ~= overrideListPresenter list last])
			ifTrue: 
				[methodSourcePresenter view
					backcolor: nil;
					isReadOnly: true;
					yourself].
	((methodCategory := gsMethod category) notEmpty and: [self isCategoryTabSelected])
		ifTrue: 
			[| fullList selections index newName |
			fullList := categoryListPresenter list.
			selections := categoryListPresenter selections.
			0 < (index := fullList indexOf: methodCategory)
				ifTrue: 
					[fullList at: index put: (newName := ' ' , methodCategory).
					categoryListPresenter list: fullList.
					0 < (index := selections indexOf: methodCategory)
						ifTrue: 
							[selections at: index put: newName.
							categoryListPresenter selections: selections].
					categoryListPresenter view invalidate]].
	listModel := (textAreaTabs subViews detect: [:each | each class == TabViewXP]) model.
	originalSourceLabel
		ifNil: [originalSourceLabel := listModel detect: [:each | each text = 'Original Source']].
	methodSourceLabel := listModel detect: [:each | each text = 'Method Source'].
	(x := gsMethod originalSource) isEmpty
		ifTrue: [listModel remove: originalSourceLabel ifAbsent: []]
		ifFalse: 
			[(listModel includes: originalSourceLabel)
				ifFalse: [listModel add: originalSourceLabel before: methodSourceLabel].
			originalSourcePresenter value: x].
	(warnings := gsMethod warnings) notEmpty
		ifTrue: [MessageBox warning: warnings caption: 'Jade Compile Warning']!

verifyValidCategory: category
	| service packageName |
	category first = $* ifFalse: [^true].
	packageName := category copyWithout: $*.
	service := RowanAnsweringService new
				command: #loadedPackageExists:;
				commandArgs: (Array with: packageName).
	self issueCommand: (Array with: service).
	^service answer! !
!JadeSystemBrowserPresenter categoriesFor: #basicAddMethodCategory:!menu handlers!public! !
!JadeSystemBrowserPresenter categoriesFor: #basicRemoveMethods!menu handlers!public! !
!JadeSystemBrowserPresenter categoriesFor: #browseMethodsAndSelect:!menu handlers!public! !
!JadeSystemBrowserPresenter categoriesFor: #browseMethodsAndSelect:type:!menu handlers!public! !
!JadeSystemBrowserPresenter categoriesFor: #createSchematicWiring!create schemantic wiring!overrides!public! !
!JadeSystemBrowserPresenter categoriesFor: #createSchematicWiringForClassHierarchyTabs!create schemantic wiring!public! !
!JadeSystemBrowserPresenter categoriesFor: #currentMethodSource!menu handlers!public! !
!JadeSystemBrowserPresenter categoriesFor: #editSaveClass!menu handlers!public! !
!JadeSystemBrowserPresenter categoriesFor: #findClass!menu handlers!public! !
!JadeSystemBrowserPresenter categoriesFor: #handleClassCompileError:!compiling!public! !
!JadeSystemBrowserPresenter categoriesFor: #instanceClassTabs!accessing!private! !
!JadeSystemBrowserPresenter categoriesFor: #instanceClassTabs:!accessing!private! !
!JadeSystemBrowserPresenter categoriesFor: #methodsMenuStrings!menus!public! !
!JadeSystemBrowserPresenter categoriesFor: #methodSourceEqual!private!testing! !
!JadeSystemBrowserPresenter categoriesFor: #onViewOpened!menus!overrides!public! !
!JadeSystemBrowserPresenter categoriesFor: #packageTabName!menus!overrides!public! !
!JadeSystemBrowserPresenter categoriesFor: #postOkToChangeEvent!event handlers!private! !
!JadeSystemBrowserPresenter categoriesFor: #preRemoveMethods!menu handlers!public! !
!JadeSystemBrowserPresenter categoriesFor: #queryCommand:!event handlers!overrides!public! !
!JadeSystemBrowserPresenter categoriesFor: #removeMethods!menu handlers!public! !
!JadeSystemBrowserPresenter categoriesFor: #runClassTests!menu handlers!public! !
!JadeSystemBrowserPresenter categoriesFor: #savePackage!menu handlers!public! !
!JadeSystemBrowserPresenter categoriesFor: #selectorsString!menu handlers!private! !
!JadeSystemBrowserPresenter categoriesFor: #updateClassHierarchy!public!updating! !
!JadeSystemBrowserPresenter categoriesFor: #updateClassList!public!updating! !
!JadeSystemBrowserPresenter categoriesFor: #updateMethod!public!updating! !
!JadeSystemBrowserPresenter categoriesFor: #updateSelector!public!updating! !
!JadeSystemBrowserPresenter categoriesFor: #verifyValidCategory:!menu handlers support!private! !

!JadeTextDocument methodsFor!

aboutJadeite
	JadeLoginShell aboutJadeite!

executeSelectionOrLine: contextObject
	| answeringService answer oop |
	oop := (contextObject isKindOf: ExternalInteger)
				ifTrue: [contextObject value]
				ifFalse: [contextObject].	"services wants a local special as a context"
	oop ifNil: [oop := 20]. 
	answeringService := RowanAnsweringService new.
	answeringService
		command: #exec:context:;
		commandArgs: (Array with: self currentSelectionOrLine with: oop).
	self issueCommand: (Array with: answeringService).
	answer := answeringService answer.
	answer key ifTrue: [answer value: (OopType64 fromInteger: answer value)].
	^answer!

issueCommand: services
	^BrowserUpdate current issueCommands: services session: self gciSession!

jadeExecuteAndDisplay: showResult
	| result |
	BrowserUpdate current logComment: '#jadeExecuteAndDisplay:'.
	
	[result := self executeSelectionOrLine.
	[self jadeExecuteAndDisplay: showResult result: result] postToInputQueue]
			newProcess
		name: 'GciSession';
		resume.
	[result isNil] whileTrue: [(Delay forMilliseconds: 10) wait].
	^result!

onPromptToSaveChanges: aBooleanValue
	"we were calling #getDocumentData essentially to test for nil. 
	That uses #asString which some objects don't understand - like booleans."
	documentPresenter value ifNil: [self isModified: false].
	^super onPromptToSaveChanges: aBooleanValue!

openDictionaryBrowser
	gciSession hasServer ifTrue: [^JadeiteBrowser showOnSession: gciSession]!

openProjectsBrowser
	^JadeiteBrowser showOnSession: gciSession!

raiseConsole
	| transcript |
	transcript := JadeiteTranscript allInstances
				detect: [:trans | trans gciSession = GciSession current]
				ifNone: [^self].
	transcript view setFocus!

registerWindow: handle rootObject: oop
	^RowanBrowserService new
		registerWindow: handle value
		rootObject: oop value
		session: self gciSession!

update: services afterStonReplication: stonResults
	BrowserUpdate current update: services afterStonReplication: stonResults!

updateServices: services
	BrowserUpdate current updateServices: services asSet asArray session: gciSession! !
!JadeTextDocument categoriesFor: #aboutJadeite!private! !
!JadeTextDocument categoriesFor: #executeSelectionOrLine:!Jade!private! !
!JadeTextDocument categoriesFor: #issueCommand:!public!services! !
!JadeTextDocument categoriesFor: #jadeExecuteAndDisplay:!Jade!private! !
!JadeTextDocument categoriesFor: #onPromptToSaveChanges:!private! !
!JadeTextDocument categoriesFor: #openDictionaryBrowser!Jade!private! !
!JadeTextDocument categoriesFor: #openProjectsBrowser!Jade!private! !
!JadeTextDocument categoriesFor: #raiseConsole!public! !
!JadeTextDocument categoriesFor: #registerWindow:rootObject:!private! !
!JadeTextDocument categoriesFor: #update:afterStonReplication:!public!services! !
!JadeTextDocument categoriesFor: #updateServices:!public!services! !

!JadeToolsToolBarPresenter methodsFor!

browseClasses
	JadeiteBrowser showOnSession: gciSession!

jadePreferences

	JadeitePreferencesShell showOnSession: gciSession.
! !
!JadeToolsToolBarPresenter categoriesFor: #browseClasses!public! !
!JadeToolsToolBarPresenter categoriesFor: #jadePreferences!public! !

!JadeTranscript methodsFor!

methodsChanged24

| string result |
	
	result := gciSession executeString: '| result methods|
		result := MethodVersionHistory uniqueInstance methodsNewerThan: (DateTime now subtractDays: 1 ).
		methods := IdentitySet new.
		result do: [:e | e asCompiledMethod ifNotNil: [:m | methods add: m]].
		methods asArray'.
(JadeMethodListBrowser showOnSession: self gciSession) primaryPresenter
		browseMethods: result;
		yourself.
	"JadeInspector showOn: result session: gciSession."
!

methodsChangedDays

| string result |
	(string := Prompter prompt: 'Enter number of days:') isNil ifTrue: [^self].	
	result := gciSession executeString: '| result methods|
		result := MethodVersionHistory uniqueInstance methodsNewerThan: (DateTime now subtractDays: ' , string , ' ).
		methods := IdentitySet new.
		result do: [:e | e asCompiledMethod ifNotNil: [:m | methods add: m]].
		methods asArray'.
	(JadeMethodListBrowser showOnSession: self gciSession) primaryPresenter
		browseMethods: result;
		yourself.

!

openRowanProjectList
	^(JadeiteProjectListBrowser showOnSession: self gciSession) primaryPresenter
		refreshProjects;
		yourself!

updateCaption

	self caption: (gciSession titleBarFor: 'Console').
! !
!JadeTranscript categoriesFor: #methodsChanged24!event handling!public! !
!JadeTranscript categoriesFor: #methodsChangedDays!event handling!public! !
!JadeTranscript categoriesFor: #openRowanProjectList!public!rowan! !
!JadeTranscript categoriesFor: #updateCaption!public! !

!JadeTreeMethodListPresenter methodsFor!

browseMethodsFromString: aString
	| list |

	"self hasTreeListSelection ifFalse: [self addTreeListRoot]."

	list := RowanMethodDefinition
		listFromString: aString
		session: self gciSession.
	methodListPresenter list: list asSortedCollection.
	list notEmpty ifTrue: [
		"methodListPresenter selectFirstMethod."
	].!

browseMethodsFromString: aString methodName: methodName
	| list node |

	self hasTreeListSelection ifFalse: [node := self addTreeListRoot: methodName type: #references].

	list := RowanMethodDefinition
		listFromString: aString
		session: self gciSession.
	methodListPresenter list: list asSortedCollection.
	list notEmpty ifTrue: [
		methodListPresenter selectFirstMethod.
	].
	node isNil ifTrue: [^self].

	treeMethodsMap at: node put: list asSortedCollection.

	treeMethodsPresenter selection: node
!

browseMethodsFromString: aString methodName: methodName type: browseType
	| list  node |

	node := self hasTreeListSelection 
			ifFalse: [self addTreeListRoot: methodName type: browseType] 
			ifTrue: [treeMethodsPresenter model add: (self getLabelForMethod: methodName type: browseType) asChildOf: treeMethodsPresenter selection.].

	list := RowanMethodDefinition
		listFromString: aString
		session: self gciSession.
	methodListPresenter list: list asSortedCollection.
	list notEmpty ifTrue: [
		"methodListPresenter selectFirstMethod."
	].

	treeMethodsMap at: node put: list asSortedCollection.

	treeMethodsPresenter selection: node!

onDropMethodsTree: aDragDropSession

	(aDragDropSession operation = #move) ifFalse: [^self].

	(aDragDropSession suggestedSource class = GsMethod2) ifTrue: [^self dropGsMethod: aDragDropSession].

	^self dropNode: aDragDropSession
! !
!JadeTreeMethodListPresenter categoriesFor: #browseMethodsFromString:!public! !
!JadeTreeMethodListPresenter categoriesFor: #browseMethodsFromString:methodName:!public! !
!JadeTreeMethodListPresenter categoriesFor: #browseMethodsFromString:methodName:type:!public! !
!JadeTreeMethodListPresenter categoriesFor: #onDropMethodsTree:!public! !

!JadeWorkspace methodsFor!

onViewClosed
	super onViewClosed.
	BrowserUpdate current logComment: 'Closing Workspace {' , self identityHash printString , '}'

	"documentPresenter view styler: JadeExpressionStyler new."!

onViewOpened
	super onViewOpened.
	codePane setDocumentPresenterWith: (self registry getClass: 'Object').
	BrowserUpdate current
		logComment: 'Opening ' , self class name asString , ' {' , self identityHash printString , '}'

	"documentPresenter view styler: JadeExpressionStyler new."! !
!JadeWorkspace categoriesFor: #onViewClosed!private! !
!JadeWorkspace categoriesFor: #onViewOpened!private! !

!ListModel methodsFor!

removeAtIndexWithoutNotification: anInteger
	"Jadeite - Remove but don't trigger events"

	^self list removeAtIndex: anInteger! !
!ListModel categoriesFor: #removeAtIndexWithoutNotification:!public!removing! !

!ListPresenter methodsFor!

selectServiceStartingWith: aKeyPressEvent
	| nearestElement character index next |
	Transcript cr.
	character := Character codePoint: aKeyPressEvent code.
	self selection name first = character
		ifTrue: 
			[index := self list indexOf: self selection.
			next := self list at: (index + 1 min: self list size).
			next name first = character
				ifTrue: 
					[self selection: next.
					^self]].
	nearestElement := self list detect: [:service | service name first = character] ifNone: [].
	nearestElement ifNotNil: [self selection: nearestElement]! !
!ListPresenter categoriesFor: #selectServiceStartingWith:!Jadeite!public! !

!MCAddition methodsFor!

revert: session
	| classService methodService |
	classService := RowanClassService named: definition basicClassName.
	classService meta: definition classIsMeta.
	methodService := RowanMethodService new
				selector: definition selector asSymbol;
				className: definition basicClassName;
				meta: definition classIsMeta;
				yourself.
	classService
		command: #removeMethods:;
		commandArgs: (Array with: (Array with: methodService)).
	BrowserUpdate current issueCommands: (Array with: classService) session: self gciSession.
	definition selector: definition selector , ' (removed)'! !
!MCAddition categoriesFor: #revert:!public! !

!MCClassDefinition methodsFor!

initialize: aStream
	| i j |
	definition := (aStream upTo: Character lf) copyReplaceAll: Character cr asString
				with: Character cr asString , Character lf asString.
	className := (definition subStrings includes: 'rwSubclass:')
				ifTrue: [(definition subStrings fourth) copyWithoutAll: #($')]
				ifFalse: 
					[i := definition indexOf: $#.
					j := definition indexOf: Character cr.
					definition copyFrom: i + 1 to: j - 1]! !
!MCClassDefinition categoriesFor: #initialize:!public! !

!MCDefinition methodsFor!

isMethodAddition
	^false!

isMethodModification
	^false!

isMethodRemoval
	^false!

revert: session! !
!MCDefinition categoriesFor: #isMethodAddition!public!testing! !
!MCDefinition categoriesFor: #isMethodModification!public!testing! !
!MCDefinition categoriesFor: #isMethodRemoval!public!testing! !
!MCDefinition categoriesFor: #revert:!public! !

!MCMethodDefinition methodsFor!

basicClassName
	^className!

isMethodAddition
	^true!

isMethodModification
	^true!

isMethodRemoval
	^true!

revert: session
	| classService |
	classService := RowanClassService named: className asString.
	classService
		command: #saveMethodSource:category:;
		commandArgs: (Array with: source with: category).
	BrowserUpdate current issueCommands: (Array with: classService) session: session!

selector: anObject
	selector := anObject! !
!MCMethodDefinition categoriesFor: #basicClassName!accessing!public! !
!MCMethodDefinition categoriesFor: #isMethodAddition!public!testing! !
!MCMethodDefinition categoriesFor: #isMethodModification!public!testing! !
!MCMethodDefinition categoriesFor: #isMethodRemoval!public!testing! !
!MCMethodDefinition categoriesFor: #revert:!public! !
!MCMethodDefinition categoriesFor: #selector:!accessing!public! !

!MCModification methodsFor!

clearObsoletionMemo
	obsoletionMemo := nil!

isMethodModification
	^modification isMethodModification!

revert: session
	obsoletion revert: session.
	modification
		source: obsoletion source;
		category: obsoletion category! !
!MCModification categoriesFor: #clearObsoletionMemo!public! !
!MCModification categoriesFor: #isMethodModification!public!testing! !
!MCModification categoriesFor: #revert:!public! !

!MCPatchBrowser methodsFor!

browseChangedThing
	| selection shell classService |
	selection := operationListPresenter selectionOrNil.
	selection isNil ifTrue: [^MessageBox notify: 'Nothing to browse'].
	selection isRemoval ifTrue: [^MessageBox notify: 'Cannot browse a removed item'].
	
	[classService := RowanClassService named: selection className.
	shell := JadeiteBrowser showOnSession: gciSession.
	shell currentCard updateServices: (Array with: classService)]
			on: Error
			do: 
				[:ex |
				shell destroy.
				MessageBox notify: 'The change you have selected cannot be browsed'].
	shell currentCard
		updateAfterFindClass: classService;
		findMethod: selection selector asSymbol.
	^shell!

browseImplementors
	| selection shell methodListPresenter changedMethod |
	selection := operationListPresenter selectionOrNil.
	selection isNil ifTrue: [^MessageBox notify: 'Nothing to browse'].
	selection isRemoval ifTrue: [^MessageBox notify: 'Cannot browse a removed item'].
	
	[shell := JadePresenter browseImplementorsOf: selection selector session: self gciSession.
	methodListPresenter := shell primaryPresenter methodListPresenter methodListPresenter.
	changedMethod := methodListPresenter  list
				detect: [:methodService | methodService className = selection className]
				ifNone: [^self].
	methodListPresenter selection: changedMethod]
			on: Error
			do: 
				[:ex |
				shell destroy.
				MessageBox notify: 'The change you have selected cannot be browsed'].
	^shell!

browseSenders
	| selection shell |
	selection := operationListPresenter selectionOrNil.
	selection isNil ifTrue: [^MessageBox notify: 'Nothing to browse'].
	selection isRemoval ifTrue: [^MessageBox notify: 'Cannot browse a removed item'].
	[shell := JadePresenter browseSendersOf: selection selector session: self gciSession] on: Error
		do: 
			[:ex |
			shell destroy.
			MessageBox notify: 'The change you have selected cannot be browsed'].
	^shell!

operationSelected

	| operation |
	leftTextPresenter 		value: ''.
	leftMemoPresenter	value: ''.
	rightTextPresenter	value: ''.
	rightMemoPresenter	value: ''.
	operationListPresenter hasSelection ifFalse: [^self].
	operation := operationListPresenter selection.
	leftTextPresenter 		value: operation obsoletionText.
	leftMemoPresenter	value: operation obsoletionMemo.
	rightTextPresenter	value: operation modificationText.
	rightMemoPresenter	value: operation modificationMemo.
	operation obsoletionMemoMarkers do: [:each | 
		leftMemoPresenter view addMarkerType: each key at: each value.
	].
	operation modificationMemoMarkers do: [:each |
		rightMemoPresenter view addMarkerType: each key at: each value.
	].
! !
!MCPatchBrowser categoriesFor: #browseChangedThing!public! !
!MCPatchBrowser categoriesFor: #browseImplementors!public! !
!MCPatchBrowser categoriesFor: #browseSenders!public! !
!MCPatchBrowser categoriesFor: #operationSelected!public! !

!MCPatchOperation methodsFor!

canBeReverted
	^self isMethodAddition or: [self isMethodModification or: [self isMethodRemoval]]!

clearObsoletionMemo
	!

isMethodAddition
	^false!

isMethodModification
	^false!

isMethodRemoval
	^false!

revert: session! !
!MCPatchOperation categoriesFor: #canBeReverted!public!testing! !
!MCPatchOperation categoriesFor: #clearObsoletionMemo!public! !
!MCPatchOperation categoriesFor: #isMethodAddition!public!testing! !
!MCPatchOperation categoriesFor: #isMethodModification!public!testing! !
!MCPatchOperation categoriesFor: #isMethodRemoval!public!testing! !
!MCPatchOperation categoriesFor: #revert:!public! !

!MCRemoval methodsFor!

isMethodRemoval
	^definition isMethodRemoval!

revert: session
	definition revert: session.
	definition selector: definition selector , ' (restored)'! !
!MCRemoval categoriesFor: #isMethodRemoval!public!testing! !
!MCRemoval categoriesFor: #revert:!public! !

!MethodListPresenter methodsFor!

browseClass

	| selection browserClass |
	selection := methodListPresenter selection.
	browserClass := Smalltalk at: #JadeiteBrowser.		"Avoid circular dependencies on load order"
	(browserClass showOnSession: self gciSession)
		selectClass: selection gsClass name
		selector: selection name.
!

selectedMethodsAreTestCases
	| classServices |
	classServices := methodListPresenter selections
				collect: [:methodService | methodService classService command: #setIsTestCaseCommand].
	self issueCommand: classServices. 
	^classServices allSatisfy: [:classService | classService isTestCase]! !
!MethodListPresenter categoriesFor: #browseClass!public! !
!MethodListPresenter categoriesFor: #selectedMethodsAreTestCases!public!testing! !

!MethodSourcePresenter methodsFor!

editMenuStrings
	false ifTrue: [
		self editSaveMethod; undo; redo; cutSelection; copySelection; pasteClipboard; clearSelection; selectAll; editFind; editFindNext; editReplace; 
			jadeDisplay; jadeExecute; jadeInspect; browseSelectedClass.
	].
	^#(
		'&Edit'
		'&Save/Ctrl+S/editSaveMethod'
		'-'
		'&Undo/Ctrl+Z/undo'
		'&Redo/Ctrl+Y/redo'
		'-'
		'&Reformat Source/Ctrl+Shift+O/reformatSource'
		'-'
		'&Cu&t/Ctrl+X/cutSelection'
		'&Copy/Ctrl+C/copySelection'
		'&Paste/Ctrl+V/pasteClipboard'
		'&Delete/Delete/clearSelection'
		'-'
		'Select &All/Ctrl+A/selectAll'
		'-'
		'&Find/Ctrl+F/editFind'
		'Find &Next/F3/editFindNext'
		'&Replace/Ctrl+H/editReplace'
		'-'
		'Display/Ctrl+D/jadeDisplay'
		'Execute/Ctrl+E/jadeExecute'
		'Inspect/Ctrl+Q/jadeInspect'
		'Browse Class/Ctrl+B/browseSelectedClass'
	).
!

editSaveMethod
	"for older method source presenter"

	| classService newMethodService |
	(self parentPresenter isKindOf: JadeiteDebugger) ifTrue: [^self parentPresenter saveMethod].	"yuck, need to get Dolphin's menus sorted out"
	classService := RowanClassService named: gsMethod className.
	classService meta: gsMethod meta.
	self
		editSaveMethod: classService
		in: documentPresenter
		category: gsMethod category.
	newMethodService := classService selectedMethods first.
	gsMethod selector = newMethodService selector
		ifTrue: 
			[gsMethod replicateFrom: newMethodService.
			documentPresenter value: newMethodService source.
			self parentPresenter selectedFrame]!

fileSave
		"Answer whether the save succeeded (false means to stay on the window and cancel any attempt to leave)"

	| user theClass newSelector category string stream list warnings errors index a b c methodExists line newOop |

	(theClass := gsMethod behavior) isNil ifTrue: [^true].
	newSelector := self newSelector.
	currentSelector = newSelector ifFalse: [
		methodExists := gciSession
			serverPerform: #'class:includesSelector:'
			with: theClass
			with: newSelector.
		methodExists ifTrue: [
			(MessageBox confirm: 'Replace method?' caption: 'Method already exists!!') ifFalse: [^self].
		].
	].
	user := self trigger: #'needUser'.
	(category := gsMethod category) isNil ifTrue: [self error: 'We need a method category!!?'].

	string := gciSession
		serverPerform: #'compileMethod:behavior:user:inCategory:'
		with: documentPresenter value replaceCrLfWithLf
		with: theClass 
		with: user 
		with: category.

	stream := ReadStream on: string.
	(line := stream nextLine) notEmpty ifTrue: [
		| pieces |
		pieces := line subStrings: Character tab.
		newOop := (pieces at: 1) asNumber. 
		newSelector := pieces at: 2.
		documentPresenter isModified: false.
		self 
			trigger: #'savedMethod:inClass:' 
			with: newSelector
			with: theClass.
	].
	newOop isNil ifFalse:[
		parentPresenter updateSaveMethodOop: newOop].
	(list := stream upToEnd subStrings: Character lf) isEmpty ifTrue: [^true].
	warnings := list select: [:each | each beginsWith: 'WARNING:'].
	warnings := warnings collect: [:each | each copyFrom: 10 to: each size].
	warnings notEmpty ifTrue: [
		ChoicePrompter
			choices: warnings
			caption: 'Compile warnings'.
	].
	errors := list select: [:each | each beginsWith: 'ERROR:'].
	errors isEmpty ifTrue: [^true].
	list := errors first subStrings: Character tab.
	string := documentPresenter value replaceCrLfWithLf.
	index := (list at: 3) asNumber - 1.
	a := (string copyFrom: 1 to: index) "replaceLfWithCrLf".
	b := (list at: 4) "replaceLfWithCrLf".
	c := (string copyFrom: index + 1 to: string size) "replaceLfWithCrLf".
	index := a size + 1.
	string := a , b , c.
	documentPresenter value: string.
	documentPresenter view
		selectionStart: index 
		length: b size.
	^false.
!

isOkayToChange
	^documentPresenter view isModified
		ifTrue: [self isOkayToChangeSource: documentPresenter]
		ifFalse: [true]!

methodMenuBreak: aMenu
	| selection |
	documentPresenter view isModified ifTrue: [^self].
	selection := parentPresenter methodListSelection.
	selection ifNil: [^self].
	selection appendToSourceMenu: aMenu presenter: documentPresenter view !

updateMethodSource
	parentPresenter updateMethodSource!

updateMethodStepPoints
	| breakPoints indicators stepPoints unimplementedSelectors updatedRange breakPointSymbol |
	breakPoints := gsMethod breakPoints.
	stepPoints := gsMethod stepPoints.
	unimplementedSelectors := gsMethod unimplementedSelectors.
	documentPresenter view clearContainerIndicators.
	indicators := OrderedCollection new.
	breakPointSymbol := BrowserUpdate current breakpointsEnabled
				ifTrue: [#breakPoint]
				ifFalse: [#disabledBreakPoint].
	1 to: stepPoints size
		do: 
			[:stepPoint |
			| range string styleName |
			range := (stepPoints at: stepPoint) key.
			(unimplementedSelectors at: range start ifAbsent: [nil])
				ifNotNil: 
					[:value |
					styleName := 10.
					string := 'No implementors of #' , value printString , ' (found at step point #'
								, stepPoint printString , ')']
				ifNil: 
					[styleName := (breakPoints includes: stepPoint) ifTrue: [breakPointSymbol] ifFalse: [#stepPoint].
					string := ((breakPoints includes: stepPoint) ifTrue: ['Break at '] ifFalse: ['']) , 'step point #'
								, stepPoint printString].
			updatedRange := offsets isNil
						ifTrue: [range]
						ifFalse: [(self offsetAt: stepPoint) to: (self offsetAt: stepPoint) + range size].
			indicators add: (ScintillaIndicator
						styleName: styleName
						range: updatedRange
						tag: string)].
	documentPresenter view indicators: indicators! !
!MethodSourcePresenter categoriesFor: #editMenuStrings!Jade!private! !
!MethodSourcePresenter categoriesFor: #editSaveMethod!menu handlers!public! !
!MethodSourcePresenter categoriesFor: #fileSave!public! !
!MethodSourcePresenter categoriesFor: #isOkayToChange!Jade!public!testing! !
!MethodSourcePresenter categoriesFor: #methodMenuBreak:!Jade!public! !
!MethodSourcePresenter categoriesFor: #updateMethodSource!public! !
!MethodSourcePresenter categoriesFor: #updateMethodStepPoints!public! !

!MultipleSelectionListBox methodsFor!

wmRButtonDown: message wParam: wParam lParam: lParam
	"Handle a WM_RBUTTONDOWN. We select the item under the mouse before
	passing control on."

	"Overridden by Jadeite to avoid losing multiple selections" 

	| sel |
	sel := self selectionFromPoint: lParam lowPartSigned @ lParam highPartSigned.
	sel := (self selectionByIndex , sel) asSet asSortedCollection asArray.
	sel notNil ifTrue: [self selectionsByIndex: sel].
	^self interactor onRightButtonPressed: (MouseEvent
				window: self
				message: message
				wParam: wParam
				lParam: lParam)! !
!MultipleSelectionListBox categoriesFor: #wmRButtonDown:wParam:lParam:!event handlers!public! !

!Object methodsFor!

basicPrepareForReplication

	!

isClassService

	^false!

isMethodService

	^false!

isPackageService

	^false!

isProjectService

	^false!

isUpdatableService
	^false!

prepareForReplication

	!

rowanFixMe

	"do nothing. Used for marking to-do items 
	during Rowan Development"! !
!Object categoriesFor: #basicPrepareForReplication!Jadeite!public! !
!Object categoriesFor: #isClassService!public!testing! !
!Object categoriesFor: #isMethodService!public!testing! !
!Object categoriesFor: #isPackageService!public!testing! !
!Object categoriesFor: #isProjectService!public!testing! !
!Object categoriesFor: #isUpdatableService!public!testing! !
!Object categoriesFor: #prepareForReplication!Jadeite!public! !
!Object categoriesFor: #rowanFixMe!public!testing! !

!ObjectLogBrowser methodsFor!

debug: anArray
	| oopType |
	oopType := gciSession oopTypeWithOop: (anArray at: 9) asNumber.
	JadeiteDebugger debuggerClass
		openOn: (GsProcess session: gciSession oopType: oopType)
		message: (anArray at: 8)
		terminateOnClose: false! !
!ObjectLogBrowser categoriesFor: #debug:!public! !

!Presenter methodsFor!

redrawAllViews!

update: browserUpdate withSelector: selector
	browserUpdate updatesPerform: selector presenter: self. !

update: browserUpdate withSelector: selector browser: browser
	browserUpdate
		updatesPerform: selector
		presenter: self
		browser: browser.
	(browser class canUnderstand: #redrawAllViews) ifTrue: [browser redrawAllViews]!

updateReady: aBlock

	aBlock value

	!

updateSelectionsFor: browserUpdate

	browserUpdate updates do:[:update | self updateSelectionsForUpdate: update].

	!

updateSelectionsForUpdate: update

	"do nothing for most presenters"

	! !
!Presenter categoriesFor: #redrawAllViews!Jadeite!public! !
!Presenter categoriesFor: #update:withSelector:!Jadeite!public! !
!Presenter categoriesFor: #update:withSelector:browser:!Jadeite!public! !
!Presenter categoriesFor: #updateReady:!public!rowan! !
!Presenter categoriesFor: #updateSelectionsFor:!public!rowan! !
!Presenter categoriesFor: #updateSelectionsForUpdate:!public!rowan! !

!ProcessorScheduler methodsFor!

userBreak: interruptArg
	"Private - The user pressed the interrupt key combination (e.g. CTRL+BREAK) to interrupt the active process. Forward to the SessionManager as the response will depend on the application
requirements."

	"Jadeite override - interrupt the server process with a soft break every time" 
	GciSession current ifNotNil: [:session | session softBreak].
	self enableInterrupts.
	[SessionManager current onUserBreak]
		ensure: [[GciSession current ifNotNil: [:session | session executeString: '3+4']] fork]	"do something to trigger the softBreak handling"! !
!ProcessorScheduler categoriesFor: #userBreak:!private! !

!RowanCommandResult methodsFor!

autoCommitUpdate: browser
	!

basicPrepareForReplication!

classCategoryUpdate: presenter
	!

classCommentUpdate: presenter
	
	!

classDefinitionUpdate: presenter
	!

classesHierarchyUpdate: presenter
!

classesUpdate: presenter browser: anObject
	!

classHierarchyUpdate: presenter
	!

classHierarchyUpdate: presenter browser: browser
!

classMethodsUpdate: presenter browser: anObject
	!

classUpdate: presenter
	!

dictionaryListUpdate: presenter

	!

dictionaryUpdate: presenter
	!

filterUpdate: presenter browser: anObject
	!

globalsUpdate: presenter!

methodFilterUpdate: presenter
	!

methodSourceUpdate: presenter browser: anObject
	!

methodsUpdate: presenter
	!

methodUpdate: presenter
	!

packagesUpdate: presenter!

packageUpdate: presenter!

projectPackagesUpdate: presenter browser: anObject
	!

projectSelectionUpdate: aPresenter
!

projectsUpdate: aPresenter
!

projectsUpdate: presenter browser: browser!

removed: presenter
!

removedClass: aPresenter
!

removedProject: presenter
	!

superclassListUpdate: presenter
	!

testClasses: presenter!

testPackages: presenter!

updateClassCategorySelectionsFor: presenter!

updateClassHierarchySelectionFor: presenter!

updateClassSelectionFor: presenter!

updatedClass: aPresenter browser: anObject
	!

updatedClassDefinition: classDefinitionPresenter browser: browser

	
	!

updatedClassInHierarchy: aPresenter browser: projectBrowser
!

updateDictionarySelectionsFor: presenter
	!

updateMethodFilterSelectionFor: presenter!

updateMethodSelectionFor: presenter!

updatePackageSelectionsFor: presenter
	!

updateSelectorFor: presenter!

updateSuperclassSelectionFor: presenter!

updateType
	"old-style command results don't use updateType"

	^nil! !
!RowanCommandResult categoriesFor: #autoCommitUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #basicPrepareForReplication!public!replication! !
!RowanCommandResult categoriesFor: #classCategoryUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #classCommentUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #classDefinitionUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #classesHierarchyUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #classesUpdate:browser:!public!updating! !
!RowanCommandResult categoriesFor: #classHierarchyUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #classHierarchyUpdate:browser:!public!updating! !
!RowanCommandResult categoriesFor: #classMethodsUpdate:browser:!public!updating! !
!RowanCommandResult categoriesFor: #classUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #dictionaryListUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #dictionaryUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #filterUpdate:browser:!public!updating! !
!RowanCommandResult categoriesFor: #globalsUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #methodFilterUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #methodSourceUpdate:browser:!public!updating! !
!RowanCommandResult categoriesFor: #methodsUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #methodUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #packagesUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #packageUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #projectPackagesUpdate:browser:!public!updating! !
!RowanCommandResult categoriesFor: #projectSelectionUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #projectsUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #projectsUpdate:browser:!public!updating! !
!RowanCommandResult categoriesFor: #removed:!public!updating! !
!RowanCommandResult categoriesFor: #removedClass:!public!updating! !
!RowanCommandResult categoriesFor: #removedProject:!public!updating! !
!RowanCommandResult categoriesFor: #superclassListUpdate:!public!updating! !
!RowanCommandResult categoriesFor: #testClasses:!public!updating! !
!RowanCommandResult categoriesFor: #testPackages:!public!updating! !
!RowanCommandResult categoriesFor: #updateClassCategorySelectionsFor:!public!updating! !
!RowanCommandResult categoriesFor: #updateClassHierarchySelectionFor:!public!updating! !
!RowanCommandResult categoriesFor: #updateClassSelectionFor:!public!updating! !
!RowanCommandResult categoriesFor: #updatedClass:browser:!public!updating! !
!RowanCommandResult categoriesFor: #updatedClassDefinition:browser:!public!updating! !
!RowanCommandResult categoriesFor: #updatedClassInHierarchy:browser:!public!updating! !
!RowanCommandResult categoriesFor: #updateDictionarySelectionsFor:!public!updating! !
!RowanCommandResult categoriesFor: #updateMethodFilterSelectionFor:!public!updating! !
!RowanCommandResult categoriesFor: #updateMethodSelectionFor:!public!updating! !
!RowanCommandResult categoriesFor: #updatePackageSelectionsFor:!public!updating! !
!RowanCommandResult categoriesFor: #updateSelectorFor:!public!updating! !
!RowanCommandResult categoriesFor: #updateSuperclassSelectionFor:!public!updating! !
!RowanCommandResult categoriesFor: #updateType!accessing!public! !

!RowanGsMethod methodsFor!

printOn: aStream
	super printOn: aStream.
	aStream cr.
	self class allInstVarNames do: 
			[:instVarName |
			aStream
				nextPutAll: instVarName;
				nextPutAll: ' - ';
				nextPutAll: (self instVarNamed: instVarName) printString;
				cr]! !
!RowanGsMethod categoriesFor: #printOn:!printing!public! !

!RowanMethodDefinition methodsFor!

methodService
	^methodDefinitionService ifNil: [methodDefinitionService := RowanMethodService on: gciSession]! !
!RowanMethodDefinition categoriesFor: #methodService!public!services! !

!RowanPatch methodsFor!

operations: aCollection 

	operations := aCollection!

session: aCollection 

	gciSession := aCollection! !
!RowanPatch categoriesFor: #operations:!public! !
!RowanPatch categoriesFor: #session:!public! !

!SequencedGrowableCollection methodsFor!

removeAtIndexWithoutNotification: index

	self subclassResponsibility!

removeWithoutNotification: oldElement ifAbsent: exceptionHandler
	"Jadeite - remove without notification for ListModel only" 

	| index |
	^(index := self indexOf: oldElement) == 0
		ifTrue: [exceptionHandler value]
		ifFalse: [self removeAtIndexWithoutNotification: index]! !
!SequencedGrowableCollection categoriesFor: #removeAtIndexWithoutNotification:!public!removing! !
!SequencedGrowableCollection categoriesFor: #removeWithoutNotification:ifAbsent:!public!removing! !

!TranscriptPresenter methodsFor!

clearTranscript
	documentPresenter value: String new.
	documentPresenter view displayValue: String new. "force it now!!"! !
!TranscriptPresenter categoriesFor: #clearTranscript!public! !

!TranscriptPresenter class methodsFor!

resource_Default_view
	"Answer the literal data from which the 'Default view' resource can be reconstituted.
	DO NOT EDIT OR RECATEGORIZE THIS METHOD.

	If you wish to modify this resource evaluate:
	ViewComposer openOn: (ResourceIdentifier class: self selector: #resource_Default_view)
	"

	^#(#'!!STL' 4 788558 10 ##(Smalltalk.STBViewProxy) ##(Smalltalk.ContainerView) 34 15 nil nil 34 2 8 1409286144 131073 416 nil nil nil 5 nil nil nil 416 852230 ##(Smalltalk.FramingLayout) 170 176 34 4 410 ##(Smalltalk.Toolbar) 34 25 nil 416 34 2 8 1140851500 131137 544 nil 524550 ##(Smalltalk.ColorRef) 8 4278190080 nil 517 nil 263174 ##(Smalltalk.Font) nil true 459014 ##(Smalltalk.LOGFONT) 8 #[243 255 255 255 0 0 0 0 0 0 0 0 0 0 0 0 144 1 0 0 0 0 0 0 3 2 1 34 65 114 105 97 108 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] 328198 ##(Smalltalk.Point) 193 193 nil 544 610 640 8 4294904337 170 192 8 #() 170 192 34 24 31005 1246982 ##(Smalltalk.ToolbarSystemButton) 31005 nil 544 1 1180998 4 ##(Smalltalk.CommandDescription) #editDelete 8 'Delete' 1 1 nil 1 11 31007 866 31007 nil 544 1 898 #undo 8 'Undo' 1 1 nil 1 7 31009 866 31009 nil 544 1 898 #redo 8 'Redo' 1 1 nil 1 9 31011 866 31011 nil 544 1 898 #editFind 8 'Find' 1 1 nil 1 25 31013 866 31013 nil 544 1 898 #editReplace 8 'Replace' 1 1 nil 1 27 30991 853766 ##(Smalltalk.ToolbarButton) 30991 nil 544 1 898 #jadeDisplay 8 'Print Result of Selection or Line' 1 1 nil 395334 3 ##(Smalltalk.Bitmap) nil true 1572870 ##(Smalltalk.ImageRelativeFileLocator) 8 'Tools.bmp' 2032142 ##(Smalltalk.STBExternalResourceLibraryProxy) 8 'dolphindr7.dll' nil nil 7 738 1857 33 55 30993 1138 30993 nil 544 1 898 #jadeExecute 8 'Evaluate Selection or Line' 1 1 nil 1216 57 30995 1138 30995 nil 544 1 898 #jadeInspect 8 'Inspect Selection or Line' 1 1 nil 1216 59 30997 866 30997 nil 544 1 898 #fileSave 8 'Save' 1 1 nil 1 17 30999 866 30999 nil 544 1 898 #editCut 8 'Cut' 1 1 nil 1 1 31001 866 31001 nil 544 1 898 #copySelection 8 'Copy' 1 1 nil 1 3 31003 866 31003 nil 544 1 898 #editPaste 8 'Paste' 1 1 nil 1 5 34 15 1152 1344 1392 1050118 ##(Smalltalk.ToolbarSeparator) nil nil 544 3 nil 1 1440 1650 nil nil 544 3 nil 1 1488 1536 1584 880 944 992 1650 nil nil 544 3 nil 1 1040 1088 170 176 34 4 1 117 1216 1 nil 1 nil 738 33 33 738 45 45 nil nil 983302 ##(Smalltalk.MessageSequence) 138 144 34 2 721670 ##(Smalltalk.MessageSend) #createAt:extent: 34 2 738 1 1 738 1001 51 544 1842 #updateSizePosted 816 544 983302 ##(Smalltalk.WINDOWPLACEMENT) 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 0 0 0 0 244 1 0 0 25 0 0 0] 8 #() 738 193 193 nil 27 1181766 2 ##(Smalltalk.FramingConstraints) 1180678 ##(Smalltalk.FramingCalculation) #fixedParentLeft 1 2050 #fixedParentRight 1 2050 #fixedParentTop 1 2050 #fixedViewTop 51 410 ##(Smalltalk.JadeiteScintillaView) 34 50 nil 416 34 2 8 1445007428 1025 2128 721990 2 ##(Smalltalk.ValueHolder) nil false 1310726 ##(Smalltalk.EqualitySearchPolicy) nil 610 8 4278190080 nil 5 265030 4 ##(Smalltalk.Menu) nil true 34 29 984134 2 ##(Smalltalk.CommandMenuItem) 1 898 #fileSave 8 '&Save' 9383 1 nil nil nil 983366 1 ##(Smalltalk.DividerMenuItem) 4097 2338 1 898 #undo 8 '&Undo' 9397 1 nil nil nil 2338 1 898 #redo 8 'R&edo' 9395 1 nil nil nil 2402 4097 2338 1 898 #editCut 8 'Cu&t' 9393 1 nil nil nil 2338 1 898 #editCopy 8 '&Copy' 9351 1 nil nil nil 2338 1 898 #editPaste 8 '&Paste' 9389 1 nil nil nil 2338 1 898 #editDelete 8 'De&lete' 1629 1 nil nil nil 2338 1 898 #editSelectAll 8 'Select &All' 9347 1 nil nil nil 2402 4097 2338 1 898 #editFind 8 '&Find...' 9357 1 nil nil nil 2338 1 898 #editFindNext 8 'Find &Next' 9359 1 nil nil nil 2338 1 898 #editReplace 8 '&Replace...' 9361 1 nil nil nil 2402 4097 2338 1 898 #jadeInspect 8 '&Inspect' 9379 1 nil nil nil 2338 1 898 #jadeDisplay 8 '&Display' 9353 1 nil nil nil 2338 1 898 #jadeExecute 8 'Execute' 9355 1 nil nil nil 2338 1 898 #jadeDebug 8 'De&bug' 9349 1 nil nil nil 2402 4097 2338 1 898 #addQuotesToSelection 8 'Add &Quotes' 1 1 nil nil nil 2338 1 898 #removeQuotesFromSelection 8 'Re&move Quotes' 1 1 nil nil nil 2402 4097 2338 1 898 #browseSelectedClass 8 'Browse Class' 1 1 nil nil nil 2338 1 898 #browseImplementors 8 'Browse Implementors' 1 1 nil nil nil 2338 1 898 #browseSenders 8 'Browse Senders' 1 1 nil nil nil 2402 4097 2338 1 898 #fileIn 8 'File In' 1 1 nil nil nil 2338 1 898 #clearTranscript 8 'Clear' 1 1 nil nil nil 8 '' nil 1 nil nil nil nil nil 658 nil true 690 8 #[243 255 255 255 0 0 0 0 0 0 0 0 0 0 0 0 144 1 0 0 0 0 0 0 3 2 1 34 86 101 114 100 97 110 97 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] 738 193 193 nil 2128 nil 8 4294902891 852486 ##(Smalltalk.NullConverter) nil nil 9 nil 170 192 34 4 #callTip 1182790 1 ##(Smalltalk.ScintillaTextStyle) 77 786694 ##(Smalltalk.IndexedColor) 33554457 3730 33554471 1 nil nil nil nil #callTip nil nil nil #normal 3698 1 nil nil 1 nil nil nil nil #normal nil nil nil 34 256 3776 nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil 3712 nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil 1639686 ##(Smalltalk.SmalltalkExpressionStyler) 1 nil nil false 138 144 816 170 192 34 2 #default 1641542 1 ##(Smalltalk.ScintillaMarkerDefinition) 1 nil nil nil 2128 #circle nil nil nil nil nil nil 138 ##(Smalltalk.IdentitySet) 816 nil 170 176 816 9215 nil nil nil nil 3730 33554447 nil nil 65 nil nil 170 192 34 6 #literalBytes 8 '[]' #specialCharacter 8 '()[]<>' #literalArray 8 '()' 8 '' 3 170 192 34 2 #container 170 192 34 4 #callTip 3712 #normal 3776 nil nil nil nil 1 nil 170 192 34 12 1 1510470 2 ##(Smalltalk.ScintillaIndicatorStyle) 1 2128 65025 3 false 1 nil nil nil nil nil nil 3 4162 3 2128 33423361 5 false 3 nil nil nil nil nil nil 5 4162 5 2128 511 1 false 5 nil nil nil nil nil nil 8 'indicator9' 4162 19 2128 33554459 13 nil nil nil nil nil nil nil nil 8 'indicator10' 4162 21 2128 33554459 3 nil nil nil nil nil nil nil nil 8 'indicator8' 4162 17 2128 33554447 1 nil nil nil nil nil nil nil nil nil nil 170 192 34 6 #Notification 3698 1029 nil 196934 1 ##(Smalltalk.RGB) 31185883 1 nil nil nil nil #Notification nil nil nil #Warning 3698 1027 4370 60239 4370 31326207 1 nil nil nil nil #Warning nil nil nil #Error 3698 1031 4370 335 4370 31317503 1 nil nil nil nil #Error nil nil nil nil 1778 138 144 34 8 1842 #createAt:extent: 34 2 738 1 51 738 1001 551 2128 1842 #contextMenu: 34 1 2304 2128 1842 #modificationEventMask: 8 #(4607) 2128 1842 #hoverTime: 8 #(200) 2128 1842 #caretPeriod: 8 #(530) 2128 1842 #margins: 34 1 34 3 985158 2 ##(Smalltalk.ScintillaMargin) 1 2128 61 3 nil nil nil nil 4786 3 2128 1 nil 3 67108863 nil nil 4786 5 2128 1 nil 3 -67108863 nil nil 2128 1842 #tabWidth: 8 #(4) 2128 1842 #maxCompletionListHeight: 8 #(9) 2128 1938 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 0 0 0 0 25 0 0 0 244 1 0 0 44 1 0 0] 8 #() 2000 nil 29 2018 2064 1 2080 1 2050 #fixedPreviousBottom 1 2050 #fixedParentBottom 1 170 192 34 2 2128 8 'document' nil 1778 138 144 34 1 1842 #createAt:extent: 34 2 738 7679 21 738 1001 601 416 1938 8 #[44 0 0 0 0 0 0 0 1 0 0 0 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 14 0 0 10 0 0 0 243 16 0 0 54 1 0 0] 34 2 544 2128 2000 nil 27 )! !
!TranscriptPresenter class categoriesFor: #resource_Default_view!public!resources-views! !

!TreeModel methodsFor!

removeWithoutNotification: anObject ifAbsent: aNiladicValuable
	"Jadeite - remove but don't trigger events to avoid trips to the server"

	| node parentNode |
	node := self getNodeFor: anObject ifAbsent: [].
	node isNil ifTrue: [^aNiladicValuable value].
	parentNode := node parent.
	parentNode removeChildNode: node.
	self forgetNode: node.
	^anObject! !
!TreeModel categoriesFor: #removeWithoutNotification:ifAbsent:!public!removing! !

"End of package definition"!

